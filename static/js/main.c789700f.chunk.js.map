{"version":3,"sources":["components/VisualizerNavbar.tsx","components/VisualizerDialog.tsx","components/canvas/VisualizerNode.tsx","components/canvas/VisualizerLine.tsx","components/canvas/VisualizerMenu.tsx","components/canvas/VisualizerCanvas.tsx","components/VisualizerTree.tsx","components/VisualizerDirectoryStyle.tsx","components/VisualizerStage.tsx","components/VisualizerLetDrawer.tsx","App.tsx","redux/reducer.ts","redux/store.ts","reportWebVitals.ts","index.tsx"],"names":["VisualizerNavbar","setDialogIsOpen","setDialogContent","setDrawerIsOpen","downloadProof","runCommands","canvasRef","proof","useSelector","state","proofReducer","darkTheme","darkThemeReducer","windowSize","useState","width","height","setWindowSize","useEffect","handleResize","window","innerWidth","innerHeight","addEventListener","removeEventListener","useWindowSize","command","setCommand","dispatch","useDispatch","setStyle","style","type","payload","current","exportProof","nodes","hidden","dot","styleMenu","icon","text","onClick","e","preventDefault","viewsMenu","view","setTimeout","changeView","exampleMenu","label","href","encodeURIComponent","download","replaceAll","link","document","createElement","getElementsByClassName","children","toDataURL","click","Group","align","Alignment","LEFT","Heading","Divider","content","className","RIGHT","id","placeholder","value","onChange","target","marginLeft","undefined","placement","disabled","checked","readUploadedFileAsText","inputFile","temporaryFileReader","FileReader","Promise","resolve","reject","onerror","abort","DOMException","onload","result","readAsText","VisualizerDialog","dialogIsOpen","dialogContent","addErrorToast","dialogProps","title","dialogBody","succesButton","_id","options","problem","setProof","processingProof","setProcessingProof","proofProcessed","setProofProcessed","fileName","changeFileName","file","changeFile","ext","changeExt","large","textAlign","paddingTop","intent","Intent","SUCCESS","iconSize","size","hasSelection","onInputChange","a","files","File","name","split","slice","fileContents","message","fill","json","JSON","parse","isOpen","onClose","usePortal","Classes","DIALOG_BODY","DIALOG_FOOTER","DIALOG_FOOTER_ACTIONS","textColorFromBg","bgColor","parseInt","substring","sixDigitColor","charAt","length","map","c","join","Node","this","props","rule","conclusion","args","x","y","selected","nHided","nDescendants","topHidedNodes","color","setNodeOnFocus","updateNodeState","toggleNodeSelection","openDrawer","tree","tagProps","stroke","strokeWidth","textProps","fontSize","padding","nHidedStr","node","nDescendantsStr","draggable","toString","onDragMove","attrs","evt","button","shiftKey","menuNode","getElementById","top","clientY","left","clientX","display","trim","React","Component","Line","key","points","Menu","unfold","foldSelectedNodes","foldAllDescendants","changeNodeColor","currentColor","setColor","foldSelected","stopPropagation","vertical","match","handleWheel","stage","getStage","oldScale","scaleX","pointerPosition","getPointerPosition","mousePointTo","newScale","deltaY","stageScale","stageX","stageY","Canvas","applyView","proofNodes","nodesToHide","filter","views","indexOf","forEach","hided","unhideNode","hideNode","nodesSelected","showingNodes","removeNodes","sort","b","nodeId","updatePosition","addNodes","setState","nodeOnFocus","hidedNodes","unfoldOnClick","nodeProps","descendants","push","LineProps","from","to","child","addNode","parent","showingEdges","recursivelyGetChildren","removeNode","Object","keys","edgeKey","edges","edge","ancestors","ancestorsId","currentId","piId","parentId","hidedIn","hideMyChildNode","nH","nD","reduce","accumulator","NaN","replace","positionCache","rank","hiddenNodesTree","childNodes","list","i","roots","some","g","dagre","graphlib","Graph","setGraph","rankdir","ranker","setDefaultEdgeLabel","setNode","setEdge","childNode","layout","xOffset","yOffset","v","console","log","concat","currentValue","proofName","stringify","hiddenNodeId","canvasSize","importedData","includes","onWheel","scaleY","onContextMenu","render","VisualizerTree","handleNodeClick","nodeData","_nodePath","setNodeInfo","originalNodeInfo","originallySelected","isSelected","forEachNode","n","handleNodeCollapse","isExpanded","handleNodeExpand","prevProps","backgroundColor","contents","onNodeClick","onNodeCollapse","onNodeExpand","ELEVATION_0","callback","VisualizerDirectoryStyle","proofTree","ruleHelper","indent","translate","ruleHelperOpen","setRuleHelperOpen","argsTranslatorOpen","setArgsTranslatorOpen","conclusionTranslatorOpen","setConclusionTranslatorOpen","nodeInfo","offsetHeight","float","clear","borderRight","overflow","removeEscapedCharacters","s","newS","pCounter","repeat","VisualizerStage","styleReducer","importedDataReducer","comment","lastIndexOf","line","search","attributes","commentJSON","subProofQty","processDot","letMap","createTree","Array","drawerIsOpen","nodeInfoCopy","setNodeInfoCopy","setTree","l","ref","autoFocus","canEscapeKeyClose","canOutsideClickClose","enforceFocus","hasBackdrop","position","Position","BOTTOM","DRAWER_BODY","maxHeight","nSpaces","j","VisualizerLetDrawer","letMapReducer","letMapS","setLetMapS","whiteSpace","newLetMap","flexDirection","App","toaster","useRef","refHandlers","TOP","err","show","DANGER","initialStateProofReducer","initialStateDarkThemeReducer","initialStateStyleReducer","initialStateLetMapReducer","initialStateImportedDataReducer","combineReducers","action","store","createStore","reducer","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","StrictMode"],"mappings":"gWAmCA,IA0OeA,EA1O2C,SAAC,GAO7B,IAN1BC,EAMyB,EANzBA,gBACAC,EAKyB,EALzBA,iBACAC,EAIyB,EAJzBA,gBACAC,EAGyB,EAHzBA,cACAC,EAEyB,EAFzBA,YACAC,EACyB,EADzBA,UAMMC,EAAQC,aAAmC,SAACC,GAAD,OAA2BA,EAAMC,aAAaH,SACzFI,EAAYH,aAAqC,SAACC,GAAD,OAA2BA,EAAMG,iBAAiBD,aACnGE,EAxCV,WAGI,MAAoCC,mBAAS,CACzCC,MAAO,EACPC,OAAQ,IAFZ,mBAAOH,EAAP,KAAmBI,EAAnB,KAoBA,OAhBAC,qBAAU,WAEN,SAASC,IAELF,EAAc,CACVF,MAAOK,OAAOC,WACdL,OAAQI,OAAOE,cAQvB,OAJAF,OAAOG,iBAAiB,SAAUJ,GAElCA,IAEO,kBAAMC,OAAOI,oBAAoB,SAAUL,MACnD,IACIN,EAiBYY,GACnB,EAA8BX,mBAAS,IAAvC,mBAAOY,EAAP,KAAgBC,EAAhB,KAEMC,EAAWC,cAMXC,EAAW,SAACC,GAEVH,EADU,SAAVG,EACS,CACLC,KAAM,oBACNC,QAAS3B,EAAU4B,QAAU5B,EAAU4B,QAAQC,cAAgB,CAAEC,MAAO,GAAIC,OAAQ,KAG/E,CAAEL,KAAM,qBAAsBC,QAAS1B,EAAM+B,MAG1DV,EAAS,CAAEI,KAAM,YAAaC,QAASF,KAyBrCQ,EACF,eAAC,IAAD,WACI,cAAC,IAAD,CACIC,KAAK,eACLC,KAAK,OACLC,QAAS,SAACC,GACNA,EAAEC,iBACFd,EAAS,WAGjB,cAAC,IAAD,CACIU,KAAK,cACLC,KAAK,YACLC,QAAS,SAACC,GACNA,EAAEC,iBACFd,EAAS,mBAMnBe,EACF,eAAC,IAAD,WACI,cAAC,IAAD,CACIJ,KAAK,QACLC,QAAS,SAACC,GACNA,EAAEC,iBACFvC,EAAY,mBAGpB,cAAC,IAAD,CACIoC,KAAK,gBACLC,QAAS,SAACC,GACNA,EAAEC,iBACFvC,EAAY,2BAGpB,cAAC,IAAD,CACIoC,KAAK,OACLC,QAAS,SAACC,GACNA,EAAEC,iBACFvC,EAAY,kBAGpB,cAAC,IAAD,IACA,cAAC,IAAD,CACIoC,KAAK,WACLC,QAAS,SAACC,GACNA,EAAEC,iBAtEC,SAACE,GAChB,OAAQA,GACJ,IAAK,QACDlB,EAAS,CAAEI,KAAM,aAAcC,QAAS1B,EAAM+B,MAC9C,MACJ,IAAK,gBACDV,EAAS,CAAEI,KAAM,qBAAsBC,QAAS1B,EAAM+B,MACtD,MACJ,IAAK,OACDV,EAAS,CAAEI,KAAM,YAAaC,QAAS1B,EAAM+B,MAC7C,MACJ,IAAK,gBACDV,EAAS,CAAEI,KAAM,qBAAsBC,QAAS1B,EAAM+B,MAI9DV,EAAS,CAAEI,KAAM,UAAWC,QAAS,KACrCc,YAAW,WACPnB,EAAS,CAAEI,KAAM,UAAWC,QAAS1B,EAAM+B,QAC5C,IAoDSU,CAAW,uBAKrBC,EACF,eAAC,IAAD,WACI,cAAC,IAAD,CACIT,KAAK,SACLC,KAAK,OACLC,QAAS,kBAAMtC,EAAcG,EAAM+B,IAAM/B,EAAM+B,IAAM,GAAI/B,EAAM2C,MAAQ3C,EAAM2C,MAAQ,OAEzF,cAAC,IAAD,CACIV,KAAK,QACLC,KAAK,MACLU,KAAI,+BAA0BC,mBAAmB7C,EAAM+B,IAAM/B,EAAM+B,IAAM,KACzEe,SAAU9C,EAAM2C,MAAN,UAAiB3C,EAAM2C,MAAMI,WAAW,IAAK,KAA7C,QAA0D,KAExE,cAAC,IAAD,CACId,KAAK,SACLC,KAAK,MACLC,QAAS,SAACC,GACNA,EAAEC,iBACF,IAAMW,EAAOC,SAASC,cAAc,KACpCF,EAAKF,SAAW9C,EAAM2C,MAAN,UAAiB3C,EAAM2C,MAAMI,WAAW,IAAK,KAA7C,QAA0D,GAC1EC,EAAKJ,KACDK,SAASE,uBAAuB,mBAAmB,GAAGC,SAAS,GACjEC,UAAU,aACZL,EAAKM,cAKrB,OACI,eAAC,IAAD,WACI,eAAC,IAAOC,MAAR,CAAcC,MAAOC,IAAUC,KAA/B,UACI,cAAC,IAAOC,QAAR,UACI,4BAAIrD,EAAWE,OAAS,IAAM,mBAAqB,SAEvD,cAAC,IAAOoD,QAAR,IACA,cAAC,IAAD,CACIzB,QAAS,SAACC,GA5IP,IAACyB,EA6IAzB,EAAEC,iBA7IFwB,EA8IW,eA7I3BnE,GAAgB,GAChBC,EAAiBkE,IA8ILC,UAAU,cACV7B,KAAK,SACLC,KAAM5B,EAAWE,OAAS,IAAM,eAAiB,QAIzD,eAAC,IAAO+C,MAAR,CAAcC,MAAOC,IAAUM,MAA/B,UACK/D,EAAM2C,MACH,qCACI,cAAC,IAAOgB,QAAR,UAAiB3D,EAAM2C,QACvB,cAAC,IAAOiB,QAAR,IACA,cAAC,IAAD,CACII,GAAG,UACHC,YAAY,YACZC,MAAO/C,EACPgD,SAAU,SAAC/B,GAAD,OAAOhB,EAAWgB,EAAEgC,OAAOF,UAEzC,cAAC,IAAD,CACI1C,MAAO,CAAE6C,WAAY,OACrBpC,KAAK,OACLE,QAAS,WACLrC,EAAYqB,GACZC,EAAW,OAGnB,cAAC,IAAOwC,QAAR,IACA,cAAC,IAAD,CACIC,QAAS7D,EAAM2C,MAAQX,OAAYsC,EACnCC,UAAU,aACVC,UAAUxE,EAAM2C,MAHpB,SAKI,cAAC,IAAD,CACIV,KAAK,eACL6B,UAAU,cACV5B,KAAM5B,EAAWE,OAAS,IAAM,QAAU,GAC1CgE,UAAUxE,EAAM2C,UAGxB,cAAC,IAAD,CACIkB,QAAS7D,EAAM2C,MAAQL,OAAYgC,EACnCC,UAAU,aACVC,UAAUxE,EAAM2C,MAHpB,SAKI,cAAC,IAAD,CACImB,UAAU,cACV7B,KAAK,eACLC,KAAM5B,EAAWE,OAAS,IAAM,OAAS,GACzCgE,UAAUxE,EAAM2C,UAGxB,cAAC,IAAD,CACImB,UAAU,cACV7B,KAAK,YACLC,KAAM5B,EAAWE,OAAS,IAAM,UAAY,GAC5CgE,UAAUxE,EAAM2C,MAChBR,QAAS,kBAAMvC,GAAgB,MAEnC,cAAC,IAAD,CACIiE,QAAS7D,EAAM2C,MAAQD,OAAc4B,EACrCC,UAAU,aACVC,UAAUxE,EAAM2C,MAHpB,SAKI,cAAC,IAAD,CACImB,UAAU,cACV7B,KAAK,WACLC,KAAM5B,EAAWE,OAAS,IAAM,WAAa,GAC7CgE,UAAUxE,EAAM2C,UAGxB,cAAC,IAAOiB,QAAR,OAEJ,KAEJ,uBAAMI,GAAG,2BAAT,UACI,cAAC,IAAD,CAAQS,QAASrE,EAAW+D,SAAU,WA9MlD9C,EAAS,CAAEI,KAAM,oBAAqBC,QAAS,QA+MnC,cAAC,IAAD,CAAMO,KAAM7B,EAAY,OAAS,oB,iDC7P/CsE,G,OAAyB,SAACC,GAC5B,IAAMC,EAAsB,IAAIC,WAEhC,OAAO,IAAIC,SAAQ,SAACC,EAASC,GACzBJ,EAAoBK,QAAU,WAC1BL,EAAoBM,QACpBF,EAAO,IAAIG,aAAa,iCAG5BP,EAAoBQ,OAAS,WACzBL,EAAQH,EAAoBS,SAEhCT,EAAoBU,WAAWX,QAmKxBY,EA/J2C,SAAC,GAM7B,IAL1BC,EAKyB,EALzBA,aACAC,EAIyB,EAJzBA,cACA9F,EAGyB,EAHzBA,iBACAD,EAEyB,EAFzBA,gBACAgG,EACyB,EADzBA,cAEMtF,EAAYH,aAAqC,SAACC,GAAD,OAA2BA,EAAMG,iBAAiBD,aAErGuF,EAA2B,CAAE1D,KAAM,QAAS2D,MAAO,SACnDC,EAAa,+FACbC,EAAe,6BAEnB,EAA0BvF,mBAAgB,CAAEwF,SAAKzB,EAAW3B,MAAO,GAAIqD,QAAS,GAAIC,QAAS,KAA7F,mBAAOjG,EAAP,KAAckG,EAAd,KACA,EAA8C3F,oBAAS,GAAvD,mBAAO4F,EAAP,KAAwBC,EAAxB,KACA,EAA4C7F,oBAAS,GAArD,mBAAO8F,EAAP,KAAuBC,EAAvB,KACA,EAAmC/F,mBAAS,kBAA5C,mBAAOgG,EAAP,KAAiBC,EAAjB,KACA,EAA2BjG,mBAAS,IAApC,mBAAOkG,EAAP,KAAaC,EAAb,KACA,EAAyBnG,mBAAS,IAAlC,mBAAOoG,EAAP,KAAYC,EAAZ,KACMvF,EAAWC,cAEjB,OAAQmE,GACJ,IAAK,UACDE,EAAc,CAAE1D,KAAM,QAAS2D,MAAO,WACtCC,EACI,sBAAK/B,UAAU,eAAf,UACI,6DACA,2EACA,cAAC,IAAD,CACItC,MAAO,CAAEhB,MAAO,SAChByB,KAAK,SACL4E,OAAK,EACL3E,KAAK,eACLC,QAAS,kBAAMxC,EAAiB,sBAI5C,MACJ,IAAK,eACDgG,EAAc,CAAE1D,KAAM,SAAU2D,MAAO,gBACvCC,EAAaQ,EACT,sBAAK7E,MAAO,CAAEsF,UAAW,SAAUrG,OAAQ,QAASsG,WAAY,IAAhE,UACI,cAAC,IAAD,CAAM9E,KAAK,OAAO+E,OAAQC,IAAOC,QAASC,SAAU,KACpD,uBACA,uBACA,yEAEJhB,EACA,sBAAK3E,MAAO,CAAEsF,UAAW,SAAUrG,OAAQ,QAASsG,WAAY,IAAhE,UACI,yDACA,cAAC,IAAD,CAASK,KAAM,QAGnB,cAAC,IAAD,CACIlF,KAAMqE,EACNc,aAA2B,mBAAbd,EACde,cAAa,uCAAE,WAAOlF,GAAP,mBAAAmF,EAAA,yDACLnD,EAAShC,EAAEgC,OACXqC,EAAOrC,EAAOoD,MAAQpD,EAAOoD,MAAM,GAAK,IAAIC,KAAK,CAAC,IAAK,YAC7Db,EAAUxC,EAAOoD,OAASpD,EAAOoD,MAAM,GAAKpD,EAAOoD,MAAM,GAAGE,KAAKC,MAAM,KAAKC,OAAO,GAAG,GAAK,KAEvFxD,EAAOoD,QACPpD,EAAOoD,MAAM,IACoC,QAAjDpD,EAAOoD,MAAM,GAAGE,KAAKC,MAAM,KAAKC,OAAO,GAAG,IACO,SAAjDxD,EAAOoD,MAAM,GAAGE,KAAKC,MAAM,KAAKC,OAAO,GAAG,GARnC,uBAUPlC,EAAc,mDAVP,mDAcoBhB,EAAuB+B,GAd3C,OAcDoB,EAdC,OAePnB,EAAWmB,GACX3B,EAAS,CACLH,SAAKzB,EACL3B,MAAO8D,EAAKiB,KAAKC,MAAM,KAAK,GAC5B3B,QAAS,GACTC,QAAS,KAEbO,EAAeC,EAAKiB,MAtBb,kDAwBPhC,EAAc,KAAGoC,SAxBV,0DAAF,sDA2BbC,MAAM,IAGdjC,EAAgBO,EA2BZ,6BA1BA,cAAC,IAAD,CACIlE,QAAS,WACL,GAAY,QAARwE,EACAtF,EAAS,CAAEI,KAAM,YAAaC,QAAS1B,IACvCoG,GAAmB,GACnB/E,EAAS,CAAEI,KAAM,UAAWC,QAAS+E,IACrCH,GAAkB,QACf,GAAY,SAARK,EAAgB,CACvB,IAAMqB,EAAOC,KAAKC,MAAMzB,GACxBpF,EAAS,CAAEI,KAAM,YAAaC,QAAS1B,IACvCoG,GAAmB,GACnB/E,EAAS,CAAEI,KAAM,UAAWC,QAASsG,EAAKjG,MAC1CV,EAAS,CAAEI,KAAM,qBAAsBC,QAASsG,EAAKjG,MACrDV,EAAS,CACLI,KAAM,oBACNC,QAAS,CAAEG,MAAOmG,EAAKnG,MAAOC,OAAQkG,EAAKlG,UAE/CwE,GAAkB,KAG1BU,OAAQC,IAAOC,QACf1C,SAAuB,mBAAb+B,EArBd,0BA+BZ,OACI,mCACI,eAAC,IAAD,yBACIzC,UAAW1D,EAAY,YAAc,GACrC+H,OAAQ3C,EACR4C,QAAS,WACLlC,EAAS,CAAEvD,MAAO,GAAIqD,QAAS,GAAIC,QAAS,KAC5CG,GAAmB,GACnBE,GAAkB,GAClB5G,GAAgB,GAChB8G,EAAe,kBACfE,EAAW,KAEf2B,WAAW,GACP1C,GAZR,cAcI,qBAAK7B,UAAWwE,IAAQC,YAAc,eAAtC,SAAuD1C,IACvD,qBAAK/B,UAAWwE,IAAQE,cAAxB,SACI,sBAAK1E,UAAWwE,IAAQG,sBAAxB,UACI,cAAC,IAAD,CACItG,QAAS,SAACC,GACNA,EAAEC,iBACF3C,GAAgB,GAChBwG,EAAS,CAAEvD,MAAO,GAAIqD,QAAS,GAAIC,QAAS,KAC5CG,GAAmB,GACnBE,GAAkB,GAClB5G,GAAgB,GAChB8G,EAAe,kBACfE,EAAW,KATnB,mBAcCZ,c,kEC3KzB,SAAS4C,EAAgBC,GAIrB,MAAW,KAHDC,SAASD,EAAQE,UAAU,EAAG,GAAI,IAGrB,KAFbD,SAASD,EAAQE,UAAU,EAAG,GAAI,IAET,KADzBD,SAASD,EAAQE,UAAU,EAAG,GAAI,IACD,IAAM,UAAY,UAGjE,SAASC,EAAcH,GACnB,GAA0B,MAAtBA,EAAQI,OAAO,GAAY,CAC3B,GAAsB,GAAlBJ,EAAQK,OACR,OAAOL,EACFE,UAAU,EAAG,GACblB,MAAM,IACNsB,KAAI,SAACC,GAAD,OAAOA,EAAIA,KACfC,KAAK,IACP,GAAsB,GAAlBR,EAAQK,OACf,OAAOL,EAAQE,UAAU,EAAG,OAE7B,CACH,GAAsB,GAAlBF,EAAQK,OACR,OAAOL,EACFhB,MAAM,IACNsB,KAAI,SAACC,GAAD,OAAOA,EAAIA,KACfC,KAAK,IACP,GAAsB,GAAlBR,EAAQK,OACf,OAAOL,EAGf,MAAO,S,IAGUS,E,4JACjB,WACI,MAiBIC,KAAKC,MAhBLC,EADJ,EACIA,KACAC,EAFJ,EAEIA,WACAC,EAHJ,EAGIA,KACAzF,EAJJ,EAIIA,GACA0F,EALJ,EAKIA,EACAC,EANJ,EAMIA,EACAC,EAPJ,EAOIA,SACAC,EARJ,EAQIA,OACAC,EATJ,EASIA,aACAC,EAVJ,EAUIA,cACAC,EAXJ,EAWIA,MACAC,EAZJ,EAYIA,eACAC,EAbJ,EAaIA,gBACAC,EAdJ,EAcIA,oBACAC,EAfJ,EAeIA,WACAC,EAhBJ,EAgBIA,KAKEC,EAAW,CACbvC,KAHYiC,EAIZO,OAAQX,EAAW,MAAQ,QAC3BY,YAAaZ,EAAW,EAAI,GAE1Ba,EAAY,CACdjH,MAAO,SACPuE,KAAMW,EAAgBI,EATVkB,IAUZU,SAAU,GACVjK,OAAQ,GACRkK,QAAS,GACTnK,MAAO,KAELoK,EAAYf,EACZ,cAAqBE,EAAgBA,EAAcd,KAAI,SAAC4B,GAAD,OAAUA,EAAK,MAAI1B,KAAK,MAAQ,IAAM,IAC7F,GACA2B,EACF,mBACU,WAATvB,EACKO,EACA,KAAOC,EAAgBA,EAAcd,KAAI,SAAC4B,GAAD,OAAUA,EAAK,MAAI1B,KAAK,MAAQ,IAAM,KACzF,OACI,eAAC,IAAD,CACI4B,WAAS,EACT/G,GAAIA,EAAGgH,WAEPC,WAAY,SAAC7I,GACT8H,EAAgBlG,EAAI5B,EAAEgC,OAAO8G,MAAMxB,EAAGtH,EAAEgC,OAAO8G,MAAMvB,IAEzDD,EAAGA,EACHC,EAAGA,EACHxH,QAAS,SAACC,GACN,GAAqB,IAAjBA,EAAE+I,IAAIC,OACFhJ,EAAE+I,IAAIE,SACNlB,EAAoBnG,GAEpBoG,EACI,CACIb,KAAMA,EACNE,KAAMA,EACND,WAAYA,EACZK,OAAQA,EACRC,aAAcA,GAAyB,WAATP,EAAeM,EAAS,GACtDE,cAAeA,GAEnBM,QAGL,GAAqB,IAAjBjI,EAAE+I,IAAIC,OAAc,CAC3BnB,EAAejG,GACf,IAAMsH,EAAWrI,SAASsI,eAAe,QACrCD,IACAA,EAAS9J,MAAMgK,IAAf,UAAwBpJ,EAAE+I,IAAIM,QAA9B,MACAH,EAAS9J,MAAMkK,KAAf,UAAyBtJ,EAAE+I,IAAIQ,QAA/B,MACAL,EAAS9J,MAAMoK,QAAU,UACzB/K,OAAOG,iBAAiB,SAAS,WAC7BsK,EAAS9J,MAAMoK,QAAU,aAlC7C,UAwCI,eAAC,IAAD,CAAOlC,EAAG,EAAGC,EAAG,EAAhB,UACI,cAAC,IAAD,eAASW,IACT,cAAC,IAAD,2BACQG,GADR,IAEIvI,KACIsH,GACgB,WAAfA,GAAsBO,EACjB,IAAMA,EAAcd,KAAI,SAAC7G,GAAD,OAAOA,EAAE,GAAGyJ,UAAQ1C,KAAK,KAAO,IACxD,UAIlB,eAAC,IAAD,CAAOO,EAAG,EAAGC,EAAG,GAAhB,UACI,cAAC,IAAD,eAASW,IACT,cAAC,IAAD,2BACQG,GADR,IAEIvI,KACIqH,GACU,WAATA,GAAgBQ,EACX,IAAMA,EAAcd,KAAI,SAAC7G,GAAD,OAAOA,EAAE,GAAGyJ,UAAQ1C,KAAK,KAAO,IACxD,UAIlB,eAAC,IAAD,CAAOO,EAAG,EAAGC,EAAG,GAAhB,UACI,cAAC,IAAD,eAASW,IACT,cAAC,IAAD,2BAAUG,GAAV,IAAqBvI,KAAM0I,EAAYE,UA/DtC9G,O,GAhDa8H,IAAMC,WC3BzBC,EAJF,SAAC,GAA6C,IAA3CC,EAA0C,EAA1CA,IAAKC,EAAqC,EAArCA,OACjB,OAAO,cAAC,IAAD,CAAiB1B,YAAa,EAAGD,OAAO,QAAQxC,KAAK,QAAQmE,OAAM,YAAMA,IAA7DD,ICiGRE,EApGF,SAAC,GAcM,IAbhBC,EAae,EAbfA,OACAC,EAYe,EAZfA,kBACAC,EAWe,EAXfA,mBACAC,EAUe,EAVfA,gBACAC,EASe,EATfA,aACAxG,EAQe,EARfA,QASA,EAA0BzF,mBAASiM,GAAnC,mBAAOxC,EAAP,KAAcyC,EAAd,KAMA,OAJA9L,qBAAU,WACN8L,EAASD,KACV,CAACA,IAGA,qBAAK1I,UAAU,uBAAf,SACI,qBAAIE,GAAG,OAAOF,UAAU,WAAxB,UACKkC,EAAQoG,OACL,oBAAItI,UAAU,GAAd,SACI,mBAAGA,UAAU,gBAAgB3B,QAAS,kBAAMiK,KAA5C,SACI,qBAAKtI,UAAU,wDAAf,SACI,iDAIZ,KACHkC,EAAQ0G,aACL,oBAAI5I,UAAU,GAAd,SACI,mBAAGA,UAAU,gBAAgB3B,QAAS,kBAAMkK,KAA5C,SACI,qBAAKvI,UAAU,uDAAf,SACI,8DAIZ,KACHkC,EAAQsG,mBACL,oBAAIxI,UAAU,GAAd,SACI,mBAAGA,UAAU,gBAAgB3B,QAAS,kBAAMmK,KAA5C,SACI,qBAAKxI,UAAU,uDAAf,SACI,+DAIZ,KACJ,oBAAIA,UAAU,GAAd,SACI,mBAAGA,UAAU,gBAAb,SACI,qBAAKA,UAAU,sCAAf,SACI,iCACI,sBAAM3B,QAAS,kBAAMoK,EAAgB,YAArC,2BACA,sBAAMpK,QAAS,kBAAMoK,EAAgB,YAArC,2BACA,sBAAMpK,QAAS,kBAAMoK,EAAgB,YAArC,2BACA,sBAAMpK,QAAS,kBAAMoK,EAAgB,YAArC,2BACA,sBAAMpK,QAAS,kBAAMoK,EAAgB,YAArC,2BACA,sBAAMpK,QAAS,kBAAMoK,EAAgB,YAArC,2BACA,sBAAMpK,QAAS,kBAAMoK,EAAgB,YAArC,2BACA,sBAAMpK,QAAS,kBAAMoK,EAAgB,YAArC,qBACA,sBAAMpK,QAAS,kBAAMoK,EAAgB,YAArC,8BAKhB,oBAAIzI,UAAU,GAAd,SACI,mBAAGA,UAAU,gBAAb,SACI,qBAAKA,UAAU,sCAAf,SACI,eAAC,IAAD,CACI3B,QAAS,SAACC,GACNA,EAAEuK,mBAEN5E,MAAM,EACN6E,UAAU,EALd,UAOI,cAAC,IAAD,CACI3I,YAAauI,EACbtI,MAAO8F,EACP7F,SAAU,SAAC/B,GAAD,OAAOqK,EAASrK,EAAEgC,OAAOF,UAEvC,cAAC,IAAD,CACIjC,KAAK,QACLE,QAAS,WACLoK,EAAgBvC,GAChByC,EAAS,KAEbjI,SAA8D,OAApDwF,EAAM6C,MAAM,qD,OC9E1D,SAASC,EAAY1K,GACjBA,EAAE+I,IAAI9I,iBAEN,IACM0K,EAAQ3K,EAAEgC,OAAO4I,WACvB,GAAID,EAAO,CACP,IAEIrD,EAAGC,EAFDsD,EAAWF,EAAMG,SACjBC,EAAkBJ,EAAMK,qBAG9B,GAAID,EAAiB,CAAC,IAAD,EACR,CAACA,EAAgBzD,EAAGyD,EAAgBxD,GAA5CD,EADgB,KACbC,EADa,UAGhBD,EAAS,EAANC,EAAS,EAGjB,IAAM0D,EAAe,CACjB3D,EAAGA,EAAIuD,EAAWF,EAAMrD,IAAMuD,EAC9BtD,EAAGA,EAAIsD,EAAWF,EAAMpD,IAAMsD,GAG5BK,EAAWlL,EAAE+I,IAAIoC,OAAS,EAlBpB,KAkBwBN,EAAqBA,EAlB7C,KAoBZ,MAAO,CACHO,WAAYF,EACZG,SAAUJ,EAAa3D,EAAIA,EAAI4D,GAAYA,EAC3CI,SAAUL,EAAa1D,EAAIA,EAAI2D,GAAYA,GAGnD,MAAO,CACHE,WAAY,EACZC,OAAQ,EACRC,OAAQ,G,IAIKC,E,kDACjB,WAAYrE,GAAqB,IAAD,uBAC5B,cAAMA,IA2FVsE,UAAY,SAACrL,GACT,IAAQsL,EAAe,EAAK3N,MAApB2N,WACFC,EAAcD,EAAWE,QAAO,SAAClD,GACnC,OAAQtI,GACJ,IAAK,QACD,OAAwC,IAAjCsI,EAAKmD,MAAMC,QAAQ,SAC9B,IAAK,gBACD,OAAwC,IAAjCpD,EAAKmD,MAAMC,QAAQ,WAA4D,IAAzCpD,EAAKmD,MAAMC,QAAQ,iBACpE,QACI,OAAO,MAGnBJ,EAAWK,SAAQ,SAACrD,GACZgD,EAAWhD,EAAK7G,KAAsC,WAA7B6J,EAAWhD,EAAK7G,IAAIuF,MAA4B,IAAZsB,EAAK7G,IAAa6G,EAAKsD,OACpF,EAAKC,WAAWvD,EAAK7G,OAG7B8J,EAAYI,SAAQ,SAACrD,GACbgD,EAAWhD,EAAK7G,KAAsC,WAA7B6J,EAAWhD,EAAK7G,IAAIuF,MAA4B,IAAZsB,EAAK7G,IAClE,EAAKqK,SAASxD,EAAK7G,QA/GC,EAoHhCqI,kBAAoB,WAChB,MAAoD,EAAKnM,MAAjD2N,EAAR,EAAQA,WAAYS,EAApB,EAAoBA,cAAeC,EAAnC,EAAmCA,aACnC,EAAKC,YAAY,GACjBF,EACKG,MAAK,SAAClH,EAAGmH,GAAJ,OAAUnH,EAAImH,KACnBR,SAAQ,SAACS,GAC4B,WAA5Bd,EAAWc,GAAQpF,MAA2B,IAAXoF,GACrC,EAAKN,SAASM,MAG1B,EAAKC,eAAe,GACpBL,EAAa,GAAK,IAAInF,EAAJ,2BAAcmF,EAAa,GAAGjF,OAA9B,IAAqCM,UAAU,KACjE,EAAKiF,SAAS,GACd,EAAKC,SAAS,CAAER,cAAe,MAjIH,EAoIhClC,OAAS,WACL,MAAoC,EAAKlM,MAAjC2N,EAAR,EAAQA,WAAYkB,EAApB,EAAoBA,YACpB,EAAKP,YAAY,GACE,YAAOX,EAAWkB,GAAaC,YACpCd,SAAQ,SAACS,GAAD,OAAY,EAAKP,WAAWO,MAClD,EAAKC,eAAe,GACpB,EAAKC,SAAS,GACd,EAAK5E,eAAe,GACpB,EAAK6E,SAAS,CAAER,cAAe,MA5IH,EA+IhCW,cAAgB,SAACjL,GACb,EAAKiG,eAAejG,GACpBxB,YAAW,kBAAM,EAAK4J,WAAU,KAjJJ,EAoJhC8C,UAAY,SAACrE,GACT,IAAQT,EAAe,EAAKd,MAApBc,WACR,MAAO,CACHpG,GAAI6G,EAAK7G,GACTuF,KAAMsB,EAAKtB,KACXC,WAAYqB,EAAKrB,WACjBC,KAAMoB,EAAKpB,KACXS,gBAAiB,EAAKA,gBACtBD,eAAgB,EAAKA,eACrBE,oBAAqB,EAAKA,oBAC1B8E,cAAe,EAAKA,cACpB7E,WAAYA,EACZJ,MAAOa,EAAKb,MACZN,EAAGmB,EAAKnB,EACRC,EAAGkB,EAAKlB,EACRC,UAAU,EACVC,OAAQgB,EAAKmE,WAAWhG,OACxBc,aAAce,EAAKsE,YACnBpF,cAAec,EAAKd,cAAgBc,EAAKd,mBAAgBzF,EACzD+F,KAAMQ,EAAKR,KAAOQ,EAAKR,UAAO/F,IAvKN,EA2KhC6F,oBAAsB,SAACnG,GACnB,IAAQuK,EAAiB,EAAKrO,MAAtBqO,aACFD,EAAkB,EAAKpO,MAAvBoO,cACFC,EAAavK,GAAIsF,MAAMM,UACvB2E,EAAavK,GAAM,IAAIoF,EAAJ,2BAAcmF,EAAavK,GAAIsF,OAA/B,IAAsCM,UAAU,KACnE0E,EAAgBA,EAAcP,QAAO,SAACY,GAAD,OAAYA,IAAW3K,OAE5DuK,EAAavK,GAAM,IAAIoF,EAAJ,2BAAcmF,EAAavK,GAAIsF,OAA/B,IAAsCM,UAAU,KACnE0E,EAAcc,KAAKpL,IAEvB,EAAK8K,SAAS,CAAEP,eAAcD,mBArLF,EAwLhCrE,eAAiB,SAACjG,GACd,EAAK8K,SAAS,CAAEC,YAAa/K,KAzLD,EA4LhCqL,UAAY,SAACpD,EAAaqD,EAAiBC,GAA/B,MAA6D,CACrEtD,MACAC,OAAQ,CAACoD,EAAK5F,EAAI,IAAK4F,EAAK3F,EAAG4F,EAAG7F,EAAI,IAAK6F,EAAG5F,EAAI,OA9LtB,EAiMhCkF,SAAW,SAAC7K,GACR,MAAqC,EAAK9D,MAAlC2N,EAAR,EAAQA,WAAYU,EAApB,EAAoBA,aACpBV,EAAW7J,GAAIZ,SAAS8K,SAAQ,SAACsB,GAC7B,EAAKC,QAAQ5B,EAAW2B,GAAQ3B,EAAW7J,IAC3C,EAAK6K,SAASW,MAElB,EAAKV,SAAS,CAAEjB,aAAYU,kBAvMA,EA0MhCkB,QAAU,SAAC5E,EAAqB6E,GAC5B,MAAuC,EAAKxP,MAApCqO,EAAR,EAAQA,aAAcoB,EAAtB,EAAsBA,aAEtBpB,EAAa1D,EAAK7G,IAAM,IAAIoF,EAAK,EAAK8F,UAAUrE,IAChD8E,EAAa,GAAD,OAAI9E,EAAK7G,GAAT,aAAgB0L,EAAO1L,KAAQgI,EACvC,EAAKqD,UAAL,UAAkBxE,EAAK7G,GAAvB,aAA8B0L,EAAO1L,IAAMuK,EAAa1D,EAAK7G,IAAIsF,MAAOiF,EAAamB,EAAO1L,IAAIsF,SA/MxE,EAmNhCkF,YAAc,SAACxK,GACX,MAAqC,EAAK9D,MAAlC2N,EAAR,EAAQA,WAAYU,EAApB,EAAoBA,aACpB,EAAKqB,uBAAuB5L,GAAIkK,SAAQ,SAACrD,GACrC,EAAKgF,WAAWhF,MAEpB,EAAKiE,SAAS,CAAEP,eAAcV,gBAxNF,EA2NhCgC,WAAa,SAAC7L,GACV,MAAuC,EAAK9D,MAApCqO,EAAR,EAAQA,aAAcoB,EAAtB,EAAsBA,aACtBG,OAAOC,KAAKJ,GACP5B,QAAO,SAACiC,GACL,IAAMC,EAAQD,EAAQrI,MAAM,MAC5B,OAAO3D,IAAO4E,SAASqH,EAAM,KAAOjM,IAAO4E,SAASqH,EAAM,OAE7D/B,SAAQ,SAACgC,UACCP,EAAaO,aAGrB3B,EAAavK,GACpB,EAAK8K,SAAS,CAAEP,eAAcoB,kBAvOF,EA0OhCQ,UAAY,SAACnM,GAIT,IAHA,IAAQ6J,EAAe,EAAK3N,MAApB2N,WACFuC,EAA6B,GAC/BC,EAAYrM,EACTqM,GACHA,EAAYxC,EAAWwC,GAAWX,OAClCU,EAAYhB,KAAKiB,GAErB,OAAOD,GAlPqB,EAqPhC/B,SAAW,SAACrK,GACR,IAEIsM,EACwC,EAKJ,EARxC,EAAoC,EAAKpQ,MAAjC2N,EAAR,EAAQA,WAAYkB,EAApB,EAAoBA,YACdwB,EAAW1C,EAAW7J,GAAI0L,OAEhC,GAAIa,GAAY1C,EAAW0C,GAAUpC,MAEjCmC,EAAOzC,EAAW0C,GAAUC,SAC5B,EAAA3C,EAAWyC,GAAMlN,UAASgM,KAA1B,oBAAkCvB,EAAW7J,GAAIZ,WACjDyK,EAAWyC,GAAMlN,SAAWyK,EAAWyC,GAAMlN,SAAS2K,QAAO,SAACY,GAAD,OAAYA,IAAW3K,KAChF6J,EAAWyC,GAAMvG,gBACjB8D,EAAWyC,GAAMvG,cAAjB,UAAiC8D,EAAWyC,GAAMvG,qBAAlD,aAAiC,EAAgCd,KAAI,SAAC4B,GAClE,OAA6C,IAAzC,EAAKsF,UAAUnM,GAAIiK,QAAQpD,EAAK,IACzB,CAACA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAK,GACnDA,WAGZ,GAAI0F,GAAY1C,EAAW0C,GAAUE,gBAAiB,CAAC,IAAD,IAEzDH,EAAOzC,EAAW0C,GAAUE,gBAC5B,IAEiG,MAF7FC,EAAyB,EACzBC,EAAyB,EAC7B,GAAuC,IAAnC9C,EAAW7J,GAAIZ,SAAS4F,QAAgE,WAAhD6E,EAAWA,EAAW7J,GAAIZ,SAAS,IAAImG,KAC/EsE,EAAWA,EAAW7J,GAAIZ,SAAS,IAAI4L,WAAWd,SAC9C,SAACsB,GAAD,OAAY3B,EAAW2B,GAAOgB,QAAUF,MAE5C,EAAAzC,EAAWyC,GAAMtB,YAAWI,KAA5B,oBAAoCvB,EAAWA,EAAW7J,GAAIZ,SAAS,IAAI4L,aAC3E2B,EAAE,UAAG9C,EAAWA,EAAW7J,GAAIZ,SAAS,IAAI2G,qBAA1C,aAAG,EAAsD6G,QACvD,SAACC,EAAahG,GAAd,OAAuBgG,EAAchG,EAAK,KAC1C,GAEJ6F,EAAE,UAAG7C,EAAWA,EAAW7J,GAAIZ,SAAS,IAAI2G,qBAA1C,aAAG,EAAsD6G,QACvD,SAACC,EAAahG,GAAd,OAAuBgG,EAAchG,EAAK,KAC1C,UAEGgD,EAAWA,EAAW7J,GAAIZ,SAAS,IAC1CyK,EAAW7J,GAAIZ,SAAW,GAC1ByK,EAAW7J,GAAIyM,gBAAkBK,KAErC,EAAAjD,EAAWyC,GAAMlN,UAASgM,KAA1B,oBAAkCvB,EAAW7J,GAAIZ,WACjD,UAAAyK,EAAWyC,GAAMvG,qBAAjB,SAAgCqF,KAAK,CACjCpL,EACA6J,EAAW7J,GAAIuF,KACfsE,EAAW7J,GAAIwF,WACfmH,GAAU,EACVD,GAAU,IAEd7C,EAAWyC,GAAMnB,YAAcwB,GAAU,EACzC9C,EAAWyC,GAAME,QAAUE,GAAU,OAClC,GAAuC,IAAnC7C,EAAW7J,GAAIZ,SAAS4F,QAAgE,WAAhD6E,EAAWA,EAAW7J,GAAIZ,SAAS,IAAImG,KAAc,CAAC,IAAD,IACpG+G,EAAOzC,EAAW7J,GAAIZ,SAAS,GAC/ByK,EAAW7J,GAAIZ,SAAW,GAC1ByK,EAAW0C,GAAUnN,SAASgM,KAAKkB,GACnCzC,EAAW0C,GAAUE,gBAAkBH,EACvCzC,EAAWyC,GAAMZ,OAASa,EAC1B1C,EAAWyC,GAAMS,QAAU/M,EAC3B6J,EAAWyC,GAAMnB,YAActB,EAAW7J,GAAImL,YAC9C,IAAMwB,EAAE,UAAG9C,EAAWyC,GAAMvG,qBAApB,aAAG,EAAgC6G,QAAO,SAACC,EAAahG,GAAd,OAAuBgG,EAAchG,EAAK,KAAI,GAC1F6F,EAAE,UAAG7C,EAAWyC,GAAMvG,qBAApB,aAAG,EAAgC6G,QAAO,SAACC,EAAahG,GAAd,OAAuBgG,EAAchG,EAAK,KAAI,GAChGgD,EAAWyC,GAAMvG,cAAgB,CAC7B,CAAC/F,EAAI6J,EAAW7J,GAAIuF,KAAMsE,EAAW7J,GAAIwF,WAAYmH,GAAU,EAAGD,EAAKA,EAAK,EAAI,SAGpFJ,EAAOzC,EAAW7E,OAClB6E,EAAWyC,GAAQ,CACftM,GAAIsM,EACJ9G,WAAY,SACZD,KAAM,SACNE,KAAM,GACNrG,SAAS,YAAKyK,EAAW7J,GAAIZ,UAC7BsG,EAAGoH,IACHnH,EAAGmH,IACHpB,OAAQa,EACRpC,OAAO,EACPa,WAAY,GACZhB,MAAO,GACPyC,gBAAiBK,IACjBN,QAASM,IACTE,eAAe,EACfD,QAAS/M,EACTmL,YAAa,EACbpF,cAAe,CAAC,CAAC/F,EAAI6J,EAAW7J,GAAIuF,KAAMsE,EAAW7J,GAAIwF,WAAYqE,EAAW7J,GAAImL,YAAa,IACjG8B,KAAMpD,EAAW0C,GAAUU,KAAO,EAClCjH,MAAO6D,EAAWkB,GAAelB,EAAWkB,GAAa/E,MAAQ,WAErE6D,EAAW0C,GAAUE,gBAAkBH,EACvCzC,EAAW0C,GAAUnN,SAASgM,KAAKkB,GACnCzC,EAAWyC,GAAMnB,YAActB,EAAW7J,GAAImL,YAElDtB,EAAWyC,GAAMtB,WAAWI,KAAKpL,GACjC6J,EAAW7J,GAAImK,OAAQ,EACvBN,EAAW7J,GAAIwM,QAAUF,EACzBzC,EAAW0C,GAAUnN,SAAWyK,EAAW0C,GAAUnN,SAAS2K,QAAO,SAACY,GAAD,OAAYA,IAAW3K,KAC5F6J,EAAW7J,GAAIyM,gBAAkBK,IACjC,IAAMzG,EAAO,EAAK6G,gBACdrD,EAAWyC,GAAMtB,WACZP,MAAK,SAAClH,EAAGmH,GAAJ,OAAUnH,EAAImH,KACnBzF,KAAI,SAAC0F,GACF,MAAO,CACH3K,GAAI2K,EACJ1M,KAAM,QACNsO,SAAU1C,EAAWc,GAAQe,OAC7B/M,MAAOkL,EAAWc,GAAQpF,KAAO,OAASsE,EAAWc,GAAQnF,WAC7D2F,YAAatB,EAAWc,GAAQQ,YAChCgC,WAAY,GACZ5H,KAAMsE,EAAWc,GAAQpF,KACzBC,WAAYqE,EAAWc,GAAQnF,WAC/BC,KAAMoE,EAAWc,GAAQlF,UAIzCoE,EAAWyC,GAAMjG,KAAOA,EACxB,EAAKyE,SAAS,CAAEjB,gBApWY,EAuWhCqD,gBAAkB,SAACE,GACf,IAEIvG,EAAMwG,EAFJpI,EAA+B,GACjCqI,EAAyB,GAG7B,IAAKD,EAAI,EAAGA,EAAID,EAAKpI,OAAQqI,GAAK,EAC9BpI,EAAImI,EAAKC,GAAGrN,IAAMqN,EAClBD,EAAKC,GAAGF,WAAa,GAGzB,IAAKE,EAAI,EAAGA,EAAID,EAAKpI,OAAQqI,GAAK,EAERP,OADtBjG,EAAOuG,EAAKC,IACHd,UAAoBa,EAAKnI,EAAI4B,EAAK0F,WACvCa,EAAKnI,EAAI4B,EAAK0F,WAAWY,WAAW/B,KAAKvE,GAEzCyG,EAAMlC,KAAKvE,GAGnB,OAAOyG,GAzXqB,EA4XhClD,WAAa,SAACpK,GACV,IAAQ6J,EAAe,EAAK3N,MAApB2N,WACF0C,EAAW1C,EAAW7J,GAAI0L,OAC1BY,EAAOzC,EAAW7J,GAAIwM,QAC5B3C,EAAW7J,GAAImK,OAAQ,EACvBN,EAAW0C,GAAUnN,SAASgM,KAAKpL,GACnC6J,EAAWyC,GAAMtB,WAAanB,EAAWyC,GAAMtB,WAAWjB,QAAO,SAACY,GAAD,OAAYA,IAAW3K,KACxF6J,EAAWyC,GAAMlN,SAAWyK,EAAWyC,GAAMlN,SAAS2K,QAClD,SAACY,GAAD,OAAad,EAAW7J,GAAIZ,SAASmO,MAAK,SAAC/B,GAAD,OAAWA,IAAUb,QAExB,IAAvCd,EAAWyC,GAAMtB,WAAWhG,SAC5B6E,EAAWA,EAAWyC,GAAMZ,QAAQtM,SAAWyK,EAAWA,EAAWyC,GAAMZ,QAAQtM,SAAS2K,QACxF,SAACY,GAAD,OAAYA,IAAW2B,KAE3BzC,EAAWA,EAAWyC,GAAMZ,QAAQe,gBAAkBK,WAC/CjD,EAAWyC,KA3YM,EA+YhC1B,eAAiB,SAAC5K,GACd,IAAQ6J,EAAe,EAAK3N,MAApB2N,WACF2D,EAAI,IAAIC,IAAMC,SAASC,MAC7BH,EAAEI,SAAS,CAAEC,QAAS,KAAMC,OAAQ,eACpCN,EAAEO,qBAAoB,WAClB,MAAO,MAEXlE,EAAWK,SAAQ,SAACrD,GACXA,EAAKsD,QACY,WAAdtD,EAAKtB,MACLiI,EAAEQ,QAAQnH,EAAK7G,GAAGgH,WAAY,CAAExK,MAAO,IAAKC,OAAQ,MACpDoN,EAAWhD,EAAK7G,IAAIZ,SAASqL,OAAOP,SAAQ,SAACsB,GACzC,GAA+B,WAA3B3B,EAAW2B,GAAOjG,KAAciI,EAAES,QAAQzC,EAAMxE,WAAYH,EAAK7G,GAAGgH,gBACnE,CACD,IAAMkH,EAAYrE,EAAW2B,GAC7BgC,EAAES,SACGC,EAAUnB,QAAUmB,EAAUnB,QAAUmB,EAAUlO,IAAIgH,WACvDH,EAAK7G,GAAGgH,kBAKpBwG,EAAEQ,SAASnH,EAAKkG,QAAUlG,EAAKkG,QAAUlG,EAAK7G,IAAIgH,WAAY,CAAExK,MAAO,IAAKC,OAAQ,MACpFoN,EAAWhD,EAAK7G,IAAIZ,SAAS8K,SAAQ,SAACsB,GAClCgC,EAAES,QAAQzC,EAAMxE,YAAaH,EAAKkG,QAAUlG,EAAKkG,QAAUlG,EAAK7G,IAAIgH,oBAKpFyG,IAAMU,OAAOX,GACb,IAAMY,EAAUZ,EAAE3G,KAAK7G,EAAGgH,YAAYtB,GAAKmE,EAAW7J,GAAI0F,EAAImE,EAAW7J,GAAI0F,EAAI,GAC3E2I,EAAUb,EAAE3G,KAAK7G,EAAGgH,YAAYrB,GAAKkE,EAAW7J,GAAI2F,EAAIkE,EAAW7J,GAAI2F,EAAI,GACjF6H,EAAE3P,QAAQqM,SAAQ,SAAUoE,GACxB,IACI,MAAiBd,EAAE3G,KAAKyH,GAAhB5I,EAAR,EAAQA,EAAGC,EAAX,EAAWA,EACNkE,EAAWjF,SAAS0J,IAAInE,OAIzBN,EAAWA,EAAWjF,SAAS0J,IAAI9B,SAAS9G,EAAIA,EAAI0I,EACpDvE,EAAWA,EAAWjF,SAAS0J,IAAI9B,SAAS7G,EAAIA,EAAI0I,IAJpDxE,EAAWjF,SAAS0J,IAAI5I,EAAIA,EAAI0I,EAChCvE,EAAWjF,SAAS0J,IAAI3I,EAAIA,EAAI0I,GAKtC,MAAOjQ,GACLmQ,QAAQC,IAAIpQ,OAGpB,EAAK0M,SAAS,CAAEjB,gBA7bY,EAgchC3D,gBAAkB,SAAC+B,EAAavC,EAAWC,GACvC,MAAmD,EAAKzJ,MAAhDqO,EAAR,EAAQA,aAAcoB,EAAtB,EAAsBA,aAAc9B,EAApC,EAAoCA,WACpCU,EAAatC,GAAO,IAAI7C,EAAJ,2BAAcmF,EAAatC,GAAK3C,OAAhC,IAAuCI,IAAGC,OAE9DkE,EAAW5B,GAAK+E,eAAgB,EAChCnD,EAAW5B,GAAX,2BAAuB4B,EAAW5B,IAAlC,IAAwCvC,IAAGC,MAE3CmG,OAAOC,KAAKJ,GACP5B,QAAO,SAACiC,GAAD,OAAkD,IAArCA,EAAQ/B,QAAQhC,EAAIjB,eACxCkD,SAAQ,SAACgC,GACN,MAAmBA,EAAKvI,MAAM,MAAMsB,KAAI,SAACS,GAAD,OAAOd,SAASc,MAAxD,mBAAO4F,EAAP,KAAaC,EAAb,KACAI,EAAaO,GAAQlE,EAAK,EAAKqD,UAAUa,EAAM3B,EAAae,GAAMhG,MAAOiF,EAAagB,GAAIjG,WAElG,EAAKwF,SAAS,CAAEP,eAAcoB,kBA7cF,EAgdhCC,uBAAyB,SAACjB,GACtB,IAAQd,EAAe,EAAK3N,MAApB2N,WACJhM,EAAuB,GAK3B,OAJAgM,EAAWc,GAAQvL,SAAS8K,SAAQ,SAACrD,GAEjChJ,GADAA,EAAQA,EAAM4Q,OAAO,CAAC5H,KACR4H,OAAO,EAAK7C,uBAAuB/E,OAE9ChJ,GAvdqB,EA0dhCyK,mBAAqB,WAAa,IAAD,EAC7B,EAAuC,EAAKpM,MAApC6O,EAAR,EAAQA,YAAaT,EAArB,EAAqBA,cACfzM,GAAS,EACXyM,EACMA,EAAcsC,QACV,SAACC,EAAa6B,GAAd,OAA+B7B,EAAY4B,OAAO,EAAK7C,uBAAuB8C,MAC9E,IAEJ,IACRD,OAPY,SAOD1D,GAPC,mBAOe,EAAKa,uBAAuBb,MACzD,EAAKD,SAAS,CAAER,cAAezM,IAAS,kBAAM,EAAKwK,wBApevB,EAuehCE,gBAAkB,SAACvC,GACf,MAAiE,EAAK9J,MAA9D2N,EAAR,EAAQA,WAAYU,EAApB,EAAoBA,aAAcD,EAAlC,EAAkCA,cAAeS,EAAjD,EAAiDA,YACjDT,EAAcJ,SAAQ,SAACS,GACnBJ,EAAaI,GAAU,IAAIvF,EAAJ,2BAAcmF,EAAaI,GAAQrF,OAAnC,IAA0CM,UAAU,EAAOI,MAAOA,KACzF6D,EAAWc,GAAQ3E,MAAQA,KAE3BuE,EAAaQ,KACbR,EAAaQ,GAAe,IAAI3F,EAAJ,2BAAcmF,EAAaQ,GAAazF,OAAxC,IAA+CU,MAAOA,KAClF6D,EAAWkB,GAAa/E,MAAQA,GAEpC,EAAK8E,SAAS,CAAEP,eAAcD,cAAe,MAjfjB,EAofhCzO,cAAgB,SAACkC,EAAa4Q,GAC1B,IAAM3P,EAAOC,SAASC,cAAc,KACpCF,EAAKF,SAAW6P,EAAY,QAC5B3P,EAAKJ,KAAL,+BAAoCC,mBAAmBoF,KAAK2K,UAAU,EAAKhR,YAAYG,MACvFiB,EAAKM,SAxfuB,EA2fhC1B,YAAc,WAE8F,IADxGG,EACuG,uDADjG,GAEN,EAAqC,EAAK7B,MAAlCqO,EAAR,EAAQA,aAAcV,EAAtB,EAAsBA,WACtB,MAAO,CACH9L,IAAKA,EACLF,MAAOiO,OAAOC,KAAKxB,GAActF,KAAI,SAAC4B,GAClC,MAAO,CACH7G,GAAI4E,SAASiC,GACbb,MAAOuE,EAAa3F,SAASiC,IAAOvB,MAAMU,MAC1CN,EAAG6E,EAAa3F,SAASiC,IAAOvB,MAAMI,EACtCC,EAAG4E,EAAa3F,SAASiC,IAAOvB,MAAMK,EACtC7H,OAAQ+L,EAAWjF,SAASiC,IAAOmE,WAAWjB,QAAO,SAACY,GAAD,OAAYd,EAAWc,GAAQR,eAvgBpE,EA6gBhCrO,YAAc,SAACqB,GACX,MAAqC,EAAKjB,MAAlCqO,EAAR,EAAQA,aAAcV,EAAtB,EAAsBA,WAClBhM,EAAuB,GAsB3B,OArB6B,YAAzBV,EAAQwG,MAAM,KAAK,IAA6C,WAAzBxG,EAAQwG,MAAM,KAAK,KAEtD9F,EADyB,KAAzBV,EAAQwG,MAAM,KAAK,GACXmI,OAAOC,KAAKxB,GAActF,KAAI,SAAC0F,GAAD,OAAY/F,SAAS+F,MAEnDmB,OAAOC,KAAKxB,GACftF,KAAI,SAAC0F,GAAD,OAAY/F,SAAS+F,MACzBZ,QAAO,SAACY,GACL,QACyE,IAApEJ,EAAaI,GAAQrF,MAAMC,KAAK0E,QAAQ9M,EAAQwG,MAAM,KAAK,MACkB,IAA1E4G,EAAaI,GAAQrF,MAAME,WAAWyE,QAAQ9M,EAAQwG,MAAM,KAAK,KACjEkG,EAAWc,GAAQK,WAAWuC,MAAK,SAACsB,GAChC,OACsE,IAAlEhF,EAAWgF,GAActJ,KAAK0E,QAAQ9M,EAAQwG,MAAM,KAAK,MACe,IAAxEkG,EAAWgF,GAAcrJ,WAAWyE,QAAQ9M,EAAQwG,MAAM,KAAK,SAG3E4G,EAAaI,OAKzBxN,EAAQwG,MAAM,KAAK,IACvB,IAAK,WACD9F,EAAMqM,SAAQ,SAACS,GACXJ,EAAaI,GAAU,IAAIvF,EAAJ,2BAAcmF,EAAaI,GAAQrF,OAAnC,IAA0CM,UAAU,QAE/E,EAAKkF,SAAS,CAAEP,eAAcD,cAAezM,IAC7C,MACJ,IAAK,UACD,IAAMmI,EAAQ7I,EAAQwG,MAAM,KAAK,GACjC9F,EAAMqM,SAAQ,SAACS,GACXJ,EAAaI,GAAU,IAAIvF,EAAJ,2BAAcmF,EAAaI,GAAQrF,OAAnC,IAA0CU,MAAOA,KACxE6D,EAAWc,GAAQ3E,MAAQA,KAE/B,EAAK8E,SAAS,CAAEP,iBAChB,MACJ,IAAK,SACD,EAAKC,YAAY,GACjB,EAAKZ,UAAUzM,EAAQwG,MAAM,KAAK,IAElC,EAAK/F,cAAcC,MAAMqM,SAAQ,SAACrD,GAC1B0D,EAAa1D,EAAK7G,MAClBuK,EAAa1D,EAAK7G,IAAM,IAAIoF,EAAJ,2BACjBmF,EAAa1D,EAAK7G,IAAIsF,OADL,IAEpBU,MAAOa,EAAKb,aAIxB,EAAK4E,eAAe,GACpB,EAAKC,SAAS,KA9jBtB,IAAQhB,EAAe,EAAKvE,MAApBuE,WAHoB,OAI5B,EAAK3N,MAAQ,CACT4S,WAAY,CACRtS,MAAO,IACPC,OAAQ,KAEZsM,MAAO,CACHS,WAAY,EACZC,OAAQ,EACRC,OAAQ,GAEZG,aACAU,aAAc,GACdoB,aAAc,GACdZ,YAAa+B,IACbxC,cAAe,IAlBS,E,qDAsBhC,WAA2B,IAAD,OACtB,EAAqCjF,KAAKnJ,MAAlCqO,EAAR,EAAQA,aAAcV,EAAtB,EAAsBA,WACtB,EAA+BxE,KAAKC,MAA5B/G,EAAR,EAAQA,KAAMwQ,EAAd,EAAcA,aAEd,GAAa,kBAATxQ,EAA0B,CAC1B8G,KAAKuE,UAAUrL,GAEf8G,KAAKuF,eAAe,GACpBL,EAAa,GAAK,IAAInF,EAAKC,KAAK6F,UAAUrB,EAAW,KACrDxE,KAAKwF,SAAS,GAEd,MAAwB,CAAChO,OAAOC,WAAYD,OAAOE,YAAc,IAA1DP,EAAP,KAAcC,EAAd,KAEA4I,KAAKyF,SAAS,CACVP,eACAuE,WAAY,CACRtS,QACAC,UAEJsM,MAAO,CACHS,WAAY,EACZC,OAAQjN,EAAQ,GAAK+N,EAAa,GAAGjF,MAAMI,EAAI,KAC/CgE,OAAQjN,EAAS,IAAM8N,EAAa,GAAGjF,MAAMK,EAAI,WAGtD,CACHoJ,EAAalR,MAAMqM,SAAQ,SAACrD,GACpBA,EAAK/I,OAAOkH,QACZ6B,EAAK/I,OAAOoM,SAAQ,SAACS,GACjB,EAAKN,SAASM,SAK1BtF,KAAKuF,eAAe,GACpBL,EAAa,GAAK,IAAInF,EAAKC,KAAK6F,UAAUrB,EAAW,KACrDxE,KAAKwF,SAAS,GAEd,MAAwB,CAAChO,OAAOC,WAAYD,OAAOE,YAAc,IAA1DP,EAAP,KAAcC,EAAd,KAEAsS,EAAalR,MAAMqM,SAAQ,SAACrD,GACpB0D,EAAa1D,EAAK7G,MAClBuK,EAAa1D,EAAK7G,IAAM,IAAIoF,EAAJ,2BACjBmF,EAAa1D,EAAK7G,IAAIsF,OADL,IAEpBU,MAAOa,EAAKb,aAKxBX,KAAKyF,SAAS,CACVP,eACAuE,WAAY,CACRtS,QACAC,UAEJsM,MAAO,CACHS,WAAY,EACZC,OAAQjN,EAAQ,GAAK+N,EAAa,GAAGjF,MAAMI,EAAI,KAC/CgE,OAAQjN,EAAS,IAAM8N,EAAa,GAAGjF,MAAMK,EAAI,OAIzDoJ,EAAalR,MAAMqM,SAAQ,SAACrD,GACpB0D,EAAa1D,EAAK7G,KAClB,EAAKkG,gBAAgBW,EAAK7G,GAAI6G,EAAKnB,EAAGmB,EAAKlB,S,oBA+e3D,WAAuB,IAAD,OAClB,EAAkGN,KAAKnJ,MAA/F4S,EAAR,EAAQA,WAAY/F,EAApB,EAAoBA,MAAOwB,EAA3B,EAA2BA,aAAcoB,EAAzC,EAAyCA,aAAcrB,EAAvD,EAAuDA,cAAeS,EAAtE,EAAsEA,YAAalB,EAAnF,EAAmFA,WAC7E7D,EAAQuE,EAAaQ,GAAeR,EAAaQ,GAAazF,MAAMU,MAAQ,GAElF,OACI,qCACI,cAAC,EAAD,CACIoC,OAAQ/C,KAAK+C,OACbC,kBAAmBhD,KAAKgD,kBACxBC,mBAAoBjD,KAAKiD,mBACzBC,gBAAiBlD,KAAKkD,gBACtBvG,QAAS,CACLoG,SAAQyB,EAAWkB,IAAgD,WAAjClB,EAAWkB,GAAaxF,KAC1DmD,gBAAc4B,EAActF,SAAUsF,EAAc0E,SAASjE,IAC7DzC,mBAAoBuB,EAAWkB,IAAgBlB,EAAWkB,GAAa3L,SAAS4F,OAAS,GAE7FwD,aAAcxC,IAElB,cAAC,IAAD,CACIe,WAAS,EACTvK,MAAOsS,EAAWtS,MAClBC,OAAQqS,EAAWrS,OACnBwS,QAAS,SAAC7Q,GAAD,OAAO,EAAK0M,SAAS,CAAE/B,MAAOD,EAAY1K,MACnD8K,OAAQH,EAAMS,WACd0F,OAAQnG,EAAMS,WACd9D,EAAGqD,EAAMU,OACT9D,EAAGoD,EAAMW,OACTyF,cAAe,SAAC/Q,GAAD,OAAOA,EAAE+I,IAAI9I,kBAThC,SAWI,eAAC,IAAD,WACKyN,OAAOC,KAAKJ,GAAc3G,OAAS,GAChC8G,OAAOC,KAAKJ,GAAc1G,KAAI,SAAUgD,GACpC,OAAO0D,EAAa1D,MAE3B6D,OAAOC,KAAKxB,GAAcvF,OAAS,GAChC8G,OAAOC,KAAKxB,GAActF,KACtB,SAAC/E,GAAD,OAAgCqK,EAAa3F,SAAS1E,IAAQkP,wB,GA1mB1DrH,a,SC5CvBsH,EAAb,kDAII,WAAY/J,GAAa,IAAD,8BACpB,cAAMA,IA6BFgK,gBAAkB,SAACC,EAAeC,EAAqBpR,IAE3DqR,EADwB,EAAKnK,MAArBmK,aAEJ,EAAKvT,MAAM0J,WAAa2J,EAASvP,GAC3B,CACIuF,KAAMgK,EAAShK,KAAOgK,EAAShK,KAAO,GACtCE,KAAM8J,EAAS9J,KAAO8J,EAAS9J,KAAO,GACtCD,WAAY+J,EAAS/J,WAAa+J,EAAS/J,WAAa,GACxDK,OAAQ,EACRC,aAAcyJ,EAASpE,YACvBpF,mBAAezF,GAEnB,EAAKpE,MAAMwT,kBAErB,IAAMC,EAAqBJ,EAASK,WAC/BxR,EAAEiJ,UACH,EAAKwI,YAAY,EAAK3T,MAAM2B,OAAO,SAACiS,GAAD,OAAQA,EAAEF,YAAa,KAE9DL,EAASK,WAAmC,MAAtBD,IAAqCA,EAC3D,EAAK7E,SAAL,2BAAmB,EAAK5O,OAAxB,IAA+B0J,SAAU,EAAK1J,MAAM0J,WAAa2J,EAASvP,GAAK8M,IAAMyC,EAASvP,OAjD1E,EAoDhB+P,mBAAqB,SAACR,GAC1BA,EAASS,YAAa,EACtB,EAAKlF,SAAS,EAAK5O,QAtDC,EAyDhB+T,iBAAmB,SAACV,GACxBA,EAASS,YAAa,EACtB,EAAKlF,SAAS,EAAK5O,QAxDnB,EAAKA,MAAQ,CACT2B,MAAOyH,EAAMzF,QACb+F,SAAUkH,IACV4C,iBAAkBpK,EAAMoK,kBANR,EAJ5B,sDAcI,SAAmBQ,GACX7K,KAAKC,MAAMzF,UAAYqQ,EAAUrQ,SACjCwF,KAAKyF,SAAS,CAAEjN,MAAOwH,KAAKC,MAAMzF,YAhB9C,oBAoBI,WACI,OACI,qBAAKrC,MAAO,CAAE2S,gBAAiB9K,KAAKC,MAAMlJ,UAAY,UAAY,SAAlE,SACI,cAAC,IAAD,CACIgU,SAAU/K,KAAKnJ,MAAM2B,MACrBwS,YAAahL,KAAKiK,gBAClBgB,eAAgBjL,KAAK0K,mBACrBQ,aAAclL,KAAK4K,iBACnBnQ,UAAWwE,IAAQkM,kBA5BvC,yBAkEI,SAAoB3S,EAAuB4S,GACvC,GAAa,MAAT5S,EAAJ,CAD+E,oBAK5DA,GAL4D,IAK/E,2BAA0B,CAAC,IAAhBgJ,EAAe,QACtB4J,EAAS5J,GACTxB,KAAKwK,YAAYhJ,EAAKsG,WAAatG,EAAKsG,WAAa,GAAIsD,IAPkB,oCAlEvF,GAAoC3I,aCmMrB4I,G,OAxLiD,SAAC,GAKrC,IAJxBC,EAIuB,EAJvBA,UACAC,EAGuB,EAHvBA,WACAC,EAEuB,EAFvBA,OACAC,EACuB,EADvBA,UAEM1U,EAAYH,aAAqC,SAACC,GAAD,OAA2BA,EAAMG,iBAAiBD,aACzG,EAA4CG,oBAAS,GAArD,mBAAOwU,EAAP,KAAuBC,EAAvB,KACA,EAAoDzU,oBAAS,GAA7D,mBAAO0U,EAAP,KAA2BC,EAA3B,KACA,EAAgE3U,oBAAS,GAAzE,mBAAO4U,EAAP,KAAiCC,EAAjC,KACA,EAAgC7U,mBAO7B,CACCgJ,KAAM,GACNE,KAAM,GACND,WAAY,GACZK,OAAQ,EACRC,aAAc,EACdC,mBAAezF,IAbnB,mBAAO+Q,EAAP,KAAiB5B,EAAjB,KAgBA,OACI,sBACIjS,MAAO,CACH2S,gBAAiB/T,EAAY,kBAAoB,QACjDK,OACII,OAAOE,YAAekC,SAASE,uBAAuB,cAAc,GAAmBmS,cAJnG,UAOI,qBACI9T,MAAO,CACHhB,MAAO,MACPC,OAAQ,OACR8U,MAAO,OACPC,MAAO,OACPC,YAAa,kBACbC,SAAU,QAPlB,SAUI,cAAC,EAAD,CACItV,UAAWA,EACXyD,QAAS8Q,EACTlB,YAAaA,EACbC,iBAAkB,CACdnK,KAAM,GACNE,KAAM,GACND,WAAY,GACZK,OAAQ,EACRC,aAAc,EACdC,mBAAezF,OAI3B,qBACI9C,MAAO,CACHhB,MAAO,MACPC,OAAQ,OACR8U,MAAO,OACPC,MAAO,QALf,SAQI,wBACIxR,GAAG,kBACHF,UAAU,yFACVtC,MAAO,CAAEhB,MAAO,QAHpB,UAKI,gCACI,+BACI,0CACA,4CAGR,kCACI,+BACI,+BACI,2CAAuB,IACvB,cAAC,IAAD,CACIwD,GAAG,YACH/B,KAAK,OACLE,QAAS,WACL+S,GAAsB,GACtBE,GAA4B,GAC5BJ,GAAmBD,SAI/B,qBAAIjR,UAAU,QAAd,UACKuR,EAAS9L,KACV,cAAC,IAAD,CAAUpB,OAAQ4M,EAAlB,SACI,cAAC,IAAD,CAAK/Q,GAAG,WAAR,SAAoB4Q,EAAWS,EAAS9L,gBAInD8L,EAAS5L,KACN,+BACI,+BACI,0CAAsB,KACa,IAAlC4L,EAAS5L,KAAKwE,QAAQ,OACnB,cAAC,IAAD,CACIjK,GAAG,YACH/B,KAAK,YACLE,QAAS,WACL6S,GAAkB,GAClBI,GAA4B,GAC5BF,GAAuBD,MAG/B,QAER,qBAAInR,UAAU,QAAd,UACKuR,EAAS5L,MACyB,IAAlC4L,EAAS5L,KAAKwE,QAAQ,OACnB,cAAC,IAAD,CAAU9F,OAAQ8M,EAAlB,SACI,cAAC,IAAD,CAAKjR,GAAG,WAAR,SAAoB6Q,EAAOC,EAAUO,EAAS5L,WAElD,WAGZ,KACJ,+BACI,+BACI,gDAA4B,KACa,IAAxC4L,EAAS7L,WAAWyE,QAAQ,OACzB,cAAC,IAAD,CACIjK,GAAG,YACH/B,KAAK,YACLE,QAAS,WACL6S,GAAkB,GAClBE,GAAsB,GACtBE,GAA6BD,MAGrC,QAER,qBAAIrR,UAAU,QAAd,UACKuR,EAAS7L,YAC+B,IAAxC6L,EAAS7L,WAAWyE,QAAQ,OACzB,cAAC,IAAD,CAAU9F,OAAQgN,EAAlB,SACI,cAAC,IAAD,CAAKnR,GAAG,WAAR,SAAoB6Q,EAAOC,EAAUO,EAAS7L,iBAElD,WAGV6L,EAAStL,cAQP,+BACI,6BACI,oDAEJ,mCAAMsL,EAAStL,cAAcd,KAAI,SAAC4B,GAAD,OAAUA,EAAK,MAAI1B,KAAK,MAAzD,UAXJ,+BACI,6BACI,oDAEJ,6BAAKkM,EAASvL,kBAUrBuL,EAASxL,OACN,+BACI,6BACI,+CAEJ,mCAEKwL,EAAStL,cACJsL,EAAStL,cAAcd,KAAI,SAAC4B,GAAD,OAAUA,EAAK,MAAI1B,KAAK,MACnD,GAJV,UAQJ,kB,OCrL5B,SAASwM,EAAwBC,GAE7B,IADA,IAAIC,EAAO,GACFxE,EAAI,EAAGA,EAAIuE,EAAE5M,OAAQqI,GAAK,GAGd,OAATuE,EAAEvE,IACY,MAAbuE,EAAEvE,EAAI,IACU,MAAbuE,EAAEvE,EAAI,IACO,MAAbuE,EAAEvE,EAAI,IACO,MAAbuE,EAAEvE,EAAI,IACO,MAAbuE,EAAEvE,EAAI,IACO,MAAbuE,EAAEvE,EAAI,MAGdwE,GAAQD,EAAEvE,IAIlB,OAAOwE,EAqHX,SAASjB,EAAWrL,GAChB,OAAQA,EAAK5B,MAAM,KAAK,IACpB,IAAK,SACD,MAAO,8DACX,IAAK,SACD,OACI4B,EACA,uYAER,IAAK,QACD,OACIA,EACA,gnBAER,IAAK,OACD,OACIA,EACA,sZAER,IAAK,UACD,OACIA,EACA,0PAER,IAAK,WACD,OACIA,EACA,6MAER,IAAK,oBACD,OACIA,EACA,moBAER,IAAK,sBACD,OACIA,EACA,6iCAER,IAAK,qBACD,OACIA,EACA,gcAER,IAAK,0BACD,OACIA,EACA,qsBAER,IAAK,4BACD,OACIA,EACA,4LAER,IAAK,eACD,OACIA,EACA,wVAER,IAAK,iBACD,OACIA,EACA,6mBAER,IAAK,aACD,OACIA,EACA,qRAER,IAAK,mBACD,OACIA,EACA,uKAER,IAAK,oBACD,OACIA,EACA,oNAER,IAAK,0BACD,OACIA,EACA,oKAER,IAAK,oBACD,OACIA,EACA,+MAER,IAAK,gBACD,OACIA,EACA,oNAER,IAAK,gBACD,OACIA,EACA,gOAER,IAAK,aACD,OACIA,EACA,mOAER,IAAK,iBACD,OACIA,EACA,0VAER,IAAK,gBACD,OACIA,EACA,uNAER,IAAK,iBACD,OACIA,EACA,kOAER,IAAK,aACD,OACIA,EACA,kpCAER,IAAK,mBACD,OACIA,EACA,ueAER,IAAK,YACD,OACIA,EACA,iNAER,IAAK,aACD,OACIA,EACA,oNAER,IAAK,mBACD,OACIA,EACA,4oBAER,IAAK,yBACD,OACIA,EACA,itBAER,QACI,OAAOA,GAInB,IAqBMsL,EAAS,SAACe,GAIZ,IAHA,IAAIC,EAAOD,EAAE7S,WAAW,IAAK,MACzBsO,EAAI,EACJyE,EAAW,EACRzE,EAAIwE,EAAK7M,QACI,MAAZ6M,EAAKxE,IAA0B,MAAZwE,EAAKxE,GAAYyE,IACnB,MAAZD,EAAKxE,IAA0B,MAAZwE,EAAKxE,GAAYyE,IACxB,OAAZD,EAAKxE,KACU,MAAhBwE,EAAKxE,EAAI,IAA8B,MAAhBwE,EAAKxE,EAAI,IAChCwE,EAAO,CAACA,EAAKjO,MAAM,EAAGyJ,EAAI,GAAI,KAAK0E,OAAOD,EAAW,GAAID,EAAKjO,MAAMyJ,EAAI,IAAIlI,KAAK,IACjFkI,GAAKyE,EAAW,IAEhBD,EAAO,CAACA,EAAKjO,MAAM,EAAGyJ,EAAI,GAAI,KAAK0E,OAAOD,GAAWD,EAAKjO,MAAMyJ,EAAI,IAAIlI,KAAK,IAC7EkI,GAAKyE,IAGbzE,IAEJ,OAAOwE,GA+QIG,EA5Q2D,SAAC,GAIpE,IAHHjW,EAGE,EAHFA,UAIMgC,EAAM9B,aAAgD,SAACC,GAAD,OAAWA,EAAMC,aAAaH,MAAM+B,OAC1FQ,EAAOtC,aAAgD,SAACC,GAAD,OAAWA,EAAMC,aAAaH,MAAMuC,QAC3Ff,EAAQvB,aAAgD,SAACC,GAAD,OAAWA,EAAM+V,aAAazU,SACtFpB,EAAYH,aAAqC,SAACC,GAAD,OAA2BA,EAAMG,iBAAiBD,aACnG2S,EAAe9S,aACjB,SAACC,GAAD,OAA2BA,EAAMgW,oBAAoBnD,gBAEzD,EAlUJ,SAAoBhR,GAChB,IAAMF,EAA8B,CAChC,CACImC,GAAI,EACJwF,WAAY,GACZD,KAAM,GACNE,KAAM,GACNuE,MAAO,GACP5K,SAAU,GACVsM,OAAQoB,IACRpH,EAAGoH,IACHnH,EAAGmH,IACHL,gBAAiBK,IACjB3C,OAAO,EACPa,WAAY,GACZwB,QAASM,IACTE,eAAe,EACf7B,YAAa,EACb8B,KAAM,EACNjH,MAAO,YAGXmM,EAAepU,EAAI6F,MAAM7F,EAAIkM,QAAQ,aAyFzC,OAxFAkI,EAAUA,EACJR,EACIA,EAAwBQ,EAAQvO,MAAMuO,EAAQlI,QAAQ,KAAO,EAAGkI,EAAQlI,QAAQ,KAAO,KAE3F,OAEe3M,aACjBD,CAAS,CACLI,KAAM,cACNC,QAASuG,KAAKC,MAAMiO,GAAX,SAIHpU,EACT6F,MAAM7F,EAAIkM,QAAQ,KAAO,EAAGlM,EAAIqU,YAAY,KAAO,GACnDrF,QAAQ,YAAa,IACrBpJ,MAAM,KACLuG,SAAQ,SAACmI,GACX,IAA8B,IAA1BA,EAAKC,OAAO,SAAiB,CAC7B,IAKK9M,EAAkBC,EALjBzF,EAAK4E,SAASyN,EAAKzO,MAAM,EAAGyO,EAAKpI,QAAQ,MAAMpC,QACjD0K,EAAaF,EAAKzO,MAAMyO,EAAKpI,QAAQ,KAAO,EAAGoI,EAAKD,YAAY,MAAMvK,OAEtElJ,EAAQ4T,EAAW3O,MAAM2O,EAAWD,OAAO,YAAc,GAE5C/M,EAAmB,GANP,GAK7B5G,EAAQA,EAAMiF,MAAM,EAAGjF,EAAM2T,OAAO,YAAc,IAEvB3O,MAAM,aAPJ,mBAO5B6B,EAP4B,YAQY,IAD5BD,EAPgB,MAQT0E,QAAQ,SAAiB1E,EAAK5B,MAAM,SAAW,CAAC4B,EAAM,IAR7C,mBAQ5BA,EAR4B,KAQtBE,EARsB,KAY7B,IAAMuE,GADNuI,GADAA,EAAaA,EAAW3O,MAAM2O,EAAWtI,QAAQ,cAAgB,aAAajF,SACtDpB,MAAM2O,EAAWtI,QAAQ,KAAO,EAAGsI,EAAW3O,MAAM,GAAGqG,QAAQ,KAAO,IACrEpC,OAAOlE,MAAM,KAChCwO,EAAkBR,EAAwBU,EAAKzO,MAAMyO,EAAKpI,QAAQ,WAAYoI,EAAKD,YAAY,OAC/FI,EAAcvO,KAAKC,MAAMiO,EAAQvO,MAAMuO,EAAQlI,QAAQ,KAAO,GAAG8C,QAAQ,KAAM,MAEhFlP,EAAMmC,KACPnC,EAAMmC,GAAM,CACRA,GAAIA,EACJwF,WAAY,GACZD,KAAM,GACNE,KAAM,GACNuE,MAAO,GACP5K,SAAU,GACVsM,OAAQoB,IACRpH,EAAGoH,IACHnH,EAAGmH,IACHL,gBAAiBK,IACjB3C,OAAO,EACPa,WAAY,GACZwB,QAASM,IACTE,eAAe,EACf7B,YAAa,EACb8B,KAAM,EACNjH,MAAO,YAGfnI,EAAMmC,GAAIwF,WAAamM,EAAwBnM,GAC/C3H,EAAMmC,GAAIuF,KAAOoM,EAAwBpM,GACzC1H,EAAMmC,GAAIyF,KAAOkM,EAAwBlM,GACzC5H,EAAMmC,GAAIgK,MAAQA,EAClBnM,EAAMmC,GAAImL,YAAcqH,EAAYC,YAAc,OAC/C,IAA2B,IAAvBJ,EAAKC,OAAO,MAAc,CACjC,MAAwBD,EAAK1O,MAAM,MAAMsB,KAAI,SAACS,GAAD,OAAOd,SAASc,EAAEmC,WAA/D,mBAAO2D,EAAP,KAAcE,EAAd,KACA7N,EAAM6N,GAAQtM,SAASgM,KAAKI,GACvB3N,EAAM2N,KACP3N,EAAM2N,GAAS,CACXxL,GAAIwL,EACJhG,WAAY,GACZD,KAAM,GACNE,KAAM,GACNuE,MAAO,GACP5K,SAAU,GACVsM,OAAQA,EACRhG,EAAGoH,IACHnH,EAAGmH,IACHL,gBAAiBK,IACjB3C,OAAO,EACPa,WAAY,GACZwB,QAASM,IACTE,eAAe,EACf7B,YAAa,EACb8B,KAAMpP,EAAM6N,GAAQuB,KAAO,EAC3BjH,MAAO,YAGfnI,EAAM2N,GAAOE,OAASA,EACtB7N,EAAM2N,GAAOyB,KAAOpP,EAAM6N,GAAQuB,KAAO,MAG1CkF,EAAU,CAACtU,EAAOoG,KAAKC,MAAMiO,GAAX,QAAiC,CAACtU,EAAO,IAmN1C6U,CAAW3U,GAAY,IAA/C,mBAAO/B,EAAP,KAAc2W,EAAd,KACMhC,EAvDS,SAACvD,GAChB,IAEIvG,EAAMwG,EAFJpI,EAAW,GACbqI,EAAa,GAGjB,IAAKD,EAAI,EAAGA,EAAID,EAAKpI,OAAQqI,GAAK,EAC9BpI,EAAImI,EAAKC,GAAGrN,IAAMqN,EAClBD,EAAKC,GAAGF,WAAa,GAGzB,IAAKE,EAAI,EAAGA,EAAID,EAAKpI,OAAQqI,GAAK,EAERP,OADtBjG,EAAOuG,EAAKC,IACHd,UAAoBa,EAAKnI,EAAI4B,EAAK0F,WACvCa,EAAKnI,EAAI4B,EAAK0F,WAAWY,WAAW/B,KAAKvE,GAEzCyG,EAAMlC,KAAKvE,GAGnB,OAAOyG,EAqCWsF,CACdC,MAAMvH,KAAKuH,MAAM7W,EAAMgJ,QAAQ+G,QAAQ9G,KAAI,SAAC0F,GACxC,MAAO,CACH3K,GAAI2K,EACJ1M,KAAM,QACNsO,SAAUvQ,EAAM2O,GAAQe,OACxB/M,MAAO3C,EAAM2O,GAAQpF,KAAO,OAASvJ,EAAM2O,GAAQnF,WACnD2F,YAAanP,EAAM2O,GAAQQ,YAC3BgC,WAAY,GACZ5H,KAAMvJ,EAAM2O,GAAQpF,KACpBC,WAAYxJ,EAAM2O,GAAQnF,WAC1BC,KAAMzJ,EAAM2O,GAAQlF,UAIhC,EAAwClJ,oBAAS,GAAjD,mBAAOuW,EAAP,KAAqBlX,EAArB,KACA,EAA4CW,oBAAS,GAArD,mBAAOwU,EAAP,KAAuBC,EAAvB,KACA,EAAoDzU,oBAAS,GAA7D,mBAAO0U,EAAP,KAA2BC,EAA3B,KACA,EAAgE3U,oBAAS,GAAzE,mBAAO4U,EAAP,KAAiCC,EAAjC,KACA,EAAgC7U,mBAO7B,CACCgJ,KAAM,GACNE,KAAM,GACND,WAAY,GACZK,OAAQ,EACRC,aAAc,EACdC,mBAAezF,IAbnB,mBAAO+Q,EAAP,KAAiB5B,EAAjB,KAeA,EAAwClT,mBAOrC,CACCgJ,KAAM,GACNE,KAAM,GACND,WAAY,GACZK,OAAQ,EACRC,aAAc,EACdC,mBAAezF,IAbnB,mBAAOyS,EAAP,KAAqBC,EAArB,KAeA,EAAwBzW,mBAAyB,IAAjD,mBAAO8J,EAAP,KAAa4M,EAAb,KACMnC,EAAY,SAACc,GAGf,IAFA,IAAIC,EAAOD,EACPvE,EAAIwE,EAAK5H,QAAQ,QACP,IAAPoD,GAAU,CACb,IAAM6F,EAAIrB,EAAKjO,MAAMyJ,GAAG1J,MAAM,WAAW,GAEzC0J,GADAwE,EAAOA,EAAK9E,QAAQmG,EAAGP,EAAOO,KACrBjJ,QAAQ,OAErB,OAAO4H,GA+IX,OACI,gCACK7V,EAAMgJ,OAAS,EACF,SAAVxH,EACI,cAAC,EAAD,CACI2V,IAAKpX,EAELwC,KAAMA,EACNsL,WAAY7N,EACZoK,WArJD,SACfiL,EAQAhL,GAEA2K,GAAkB,GAClBvB,EAAY4B,GACZ4B,EAAQ5M,GAAc,IACtB2M,EAAgB3B,GAChBzV,GAAgB,IAuIAmT,aAAcA,GAJThR,GAOT,cAAC,EAAD,CACI4S,UAAWA,EACXC,WAAYA,EACZC,OAAQA,EACRC,UAAWA,IAGnB,KACJ,cAAC,IAAD,CACIhR,UAAW1D,EAAY,WAAa,GACpCgX,WAAW,EACXC,mBAAmB,EACnBC,sBAAsB,EACtBC,cAAc,EACdC,aAAa,EACbrP,OAAQ2O,EACRW,SAAUC,IAASC,OACnBtP,WAAW,EACXD,QAAS,SAAChG,GACNA,EAAEC,iBACFzC,GAAgB,GAChBsV,GAAsB,GACtBE,GAA4B,IAEhCnT,KAAK,YACL2D,MAAM,YAjBV,SAmBI,sBAAK9B,UAAWwE,IAAQsP,YAAxB,UACI,cAAC,EAAD,CACIxX,UAAWA,EACXyD,QAASwG,EACToJ,YAAaA,EACbC,iBAAkBqD,IAEtB,qBAAKjT,UAAWwE,IAAQC,YAAxB,SAvKR,wBACIvE,GAAG,kBACHF,UAAU,yFACVtC,MAAO,CAAEhB,MAAO,QAHpB,UAKI,gCACI,+BACI,0CACA,4CAGR,kCACI,+BACI,+BACI,2CAAuB,IACvB,cAAC,IAAD,CACIwD,GAAG,YACH/B,KAAK,OACLE,QAAS,WACL+S,GAAsB,GACtBE,GAA4B,GAC5BJ,GAAmBD,SAI/B,+BACKM,EAAS9L,KACV,cAAC,IAAD,CAAUpB,OAAQ4M,EAAlB,SACI,cAAC,IAAD,CAAKvT,MAAO,CAAEqW,UAAW,QAASnC,SAAU,QAAU1R,GAAG,WAAzD,SACK4Q,EAAWS,EAAS9L,gBAKpC8L,EAAS5L,KACN,+BACI,+BACI,0CAAsB,KACa,IAAlC4L,EAAS5L,KAAKwE,QAAQ,OACnB,cAAC,IAAD,CACIjK,GAAG,YACH/B,KAAK,YACLE,QAAS,WACLiT,GAA4B,GAC5BJ,GAAkB,GAClBE,GAAuBD,MAG/B,QAER,qBAAIzT,MAAO,CAAEqW,UAAW,QAASnC,SAAU,QAA3C,UACKL,EAAS5L,MACyB,IAAlC4L,EAAS5L,KAAKwE,QAAQ,OACnB,cAAC,IAAD,CAAU9F,OAAQ8M,EAAlB,SACI,cAAC,IAAD,CAAKzT,MAAO,CAAEqW,UAAW,QAASnC,SAAU,QAAU1R,GAAG,WAAzD,SACK6Q,EAAOC,EAAUO,EAAS5L,WAGnC,WAGZ,KACJ,+BACI,qBAAIjI,MAAO,CAAEqW,UAAW,QAASnC,SAAU,QAA3C,UACI,gDAA4B,KACa,IAAxCL,EAAS7L,WAAWyE,QAAQ,OACzB,cAAC,IAAD,CACIjK,GAAG,YACH/B,KAAK,YACLE,QAAS,WACL+S,GAAsB,GACtBF,GAAkB,GAClBI,GAA6BD,MAGrC,QAER,qBAAI3T,MAAO,CAAEqW,UAAW,QAASnC,SAAU,QAA3C,UACKL,EAAS7L,YAC+B,IAAxC6L,EAAS7L,WAAWyE,QAAQ,OACzB,cAAC,IAAD,CAAU9F,OAAQgN,EAAlB,SACI,cAAC,IAAD,CAAK3T,MAAO,CAAEqW,UAAW,QAASnC,SAAU,QAAU1R,GAAG,WAAzD,SACK6Q,EAAOC,EAAUO,EAAS7L,iBAGnC,WAGV6L,EAAStL,cAQP,+BACI,6BACI,oDAEJ,mCAAMsL,EAAStL,cAAcd,KAAI,SAAC4B,GAAD,OAAUA,EAAK,MAAI1B,KAAK,MAAzD,UAXJ,+BACI,6BACI,oDAEJ,6BAAKkM,EAASvL,kBAUrBuL,EAASxL,OACN,+BACI,6BACI,+CAEJ,mCAEKwL,EAAStL,cAAgBsL,EAAStL,cAAcd,KAAI,SAAC4B,GAAD,OAAUA,EAAK,MAAI1B,KAAK,MAAQ,GAFzF,UAMJ,sBC3hBlB0L,EAAS,SAACe,GAGZ,IAFA,IAAIC,EAAOD,EACPvE,EAAI,EACDA,EAAIwE,EAAK7M,QAAQ,CACpB,GAAgB,MAAZ6M,EAAKxE,GAAY,CAGjB,IAFA,IAAIyG,EAAU,EACVC,EAAI1G,EAAI,EACO,MAAZwE,EAAKkC,IAAyB,KAAXlC,EAAKkC,IACX,MAAZlC,EAAKkC,KACLlC,EAAO,CAACA,EAAKjO,MAAM,EAAGmQ,GAAI,KAAMlC,EAAKjO,MAAMmQ,EAAI,IAAI5O,KAAK,IACxD2O,GAAW,GAEfC,GAAK,EAELD,EAAU,IACVjC,EAAO,CAACA,EAAKjO,MAAM,EAAGyJ,GAAI,KAAMwE,EAAKjO,MAAMyJ,EAAI,IAAIlI,KAAK,IACxDkI,EAAI0G,EAAI,GAGhB1G,GAAK,EAETA,EAAI,EAEJ,IADA,IAAIyE,EAAW,EACRzE,EAAIwE,EAAK7M,QACI,MAAZ6M,EAAKxE,GAAYyE,IACA,MAAZD,EAAKxE,GAAYyE,IACL,OAAZD,EAAKxE,KACU,MAAhBwE,EAAKxE,EAAI,IACTwE,EAAO,CAACA,EAAKjO,MAAM,EAAGyJ,EAAI,GAAI,OAAO0E,OAAOD,EAAW,GAAID,EAAKjO,MAAMyJ,EAAI,IAAIlI,KAAK,IACnFkI,GAAKyE,EAAW,IAEhBD,EAAO,CAACA,EAAKjO,MAAM,EAAGyJ,EAAI,GAAI,OAAO0E,OAAOD,GAAWD,EAAKjO,MAAMyJ,EAAI,IAAIlI,KAAK,IAC/EkI,GAAKyE,IAGbzE,IAEJ,OAAOwE,GAuHImC,EApHuC,SAAC,GAAuD,IAArDlB,EAAoD,EAApDA,aAAclX,EAAsC,EAAtCA,gBAC7DQ,EAAYH,aAAqC,SAACC,GAAD,OAA2BA,EAAMG,iBAAiBD,aACnGuW,EAAS1W,aAKb,SAACC,GAAD,OAA2BA,EAAM+X,cAActB,UACjD,EAA8BpW,mBAASoW,GAAvC,mBAAOuB,EAAP,KAAgBC,EAAhB,KAEA,OACI,cAAC,IAAD,CACIrU,UAAW1D,EAAY,WAAa,GACpCoB,MAAO,CAAEqW,UAAW,MAAOrX,MAAO,OAClC4W,WAAW,EACXC,mBAAmB,EACnBC,sBAAsB,EACtBC,cAAc,EACdC,aAAa,EACbrP,OAAQ2O,EACRW,SAAUC,IAAS3T,MACnBsE,WAAW,EACXD,QAAS,SAAChG,GACNA,EAAEC,iBACFzC,GAAgB,IAEpBqC,KAAK,YACL2D,MAAM,UAhBV,SAkBI,qBAAK9B,UAAWwE,IAAQsP,YAAxB,SACI,qBAAK9T,UAAWwE,IAAQC,YAAxB,SACI,wBACIvE,GAAG,kBACHF,UAAU,yFACVtC,MAAO,CAAEhB,MAAO,QAHpB,UAKI,gCACI,+BACI,oBAAIgB,MAAO,CAAEhB,MAAO,SAApB,sBACA,uCACA,oBAAIgB,MAAO,CAAEhB,MAAO,SAApB,yBAGR,gCACKsP,OAAOC,KAAKmI,GAASjP,KAAI,SAAUgD,GAChC,OACI,+BACI,6BACI,iCAASA,MAEb,oBAAIzK,MAAO,CAAEhB,MAAO,OAAQ4X,WAAY,YAAxC,SACKvD,EAAOqD,EAAQjM,IACXtE,MAAM,MACNsB,KAAI,SAAC7G,GACF,OAA2B,IAAvBA,EAAE6L,QAAQ,QACH,+BAAO7L,EAAI,OAGd,sBACID,QAAS,WACL,IAAMkW,EAAS,eAAQH,GACjB7G,EAAIgH,EAAUpM,GAAKgC,QACrB7L,EAAE2O,QAAQ,aAAc,KAEtBmG,EAAImB,EAAUpM,GAAKrE,MAAMyJ,GAAG1J,MAAM,SAAS,GACjD0Q,EAAUpM,GAAOoM,EAAUpM,GAAK8E,QAC5BmG,EACAP,EAAOO,IAEXiB,EAAWE,IAXnB,SAcKjW,EAAI,YAM7B,qBAAIZ,MAAO,CAAEhB,MAAO,QAASoL,QAAS,OAAQ0M,cAAe,UAA7D,UACI,cAAC,IAAD,CACInW,QAAS,WAGL,IAFA,IAAMkW,EAAS,eAAQH,GACnB7G,EAAIgH,EAAUpM,GAAKgC,QAAQ,QACjB,IAAPoD,GAAU,CACb,IAAM6F,EAAImB,EAAUpM,GAAKrE,MAAMyJ,GAAG1J,MAAM,SAAS,GACjD0Q,EAAUpM,GAAOoM,EAAUpM,GAAK8E,QAAQmG,EAAGP,EAAOO,IAClD7F,EAAIgH,EAAUpM,GAAKgC,QAAQ,OAE/BkK,EAAWE,IAEfvU,UAAU,cACV7B,KAAK,YACLC,KAAK,WAET,cAAC,IAAD,CACIC,QAAS,WACL,IAAMkW,EAAS,eAAQH,GACvBG,EAAUpM,GAAO0K,EAAO1K,GACxBkM,EAAWE,IAEfvU,UAAU,cACV7B,KAAK,OACLC,KAAK,gBAxDR+J,kBC3B9BsM,EA1DO,WAClB,IAYIC,EAZJ,EAAwCjY,oBAAS,GAAjD,mBAAOiF,EAAP,KAAqB9F,EAArB,KACA,EAA0Ca,mBAAS,WAAnD,mBAAOkF,EAAP,KAAsB9F,EAAtB,KAEA,EAAwCY,oBAAS,GAAjD,mBAAOuW,EAAP,KAAqBlX,EAArB,KAEMQ,EAAYH,aAAqC,SAACC,GAAD,OAA2BA,EAAMG,iBAAiBD,aAEnGL,EAAY0Y,iBAAe,MAM3BC,EAAc,CAChBF,QAAS,SAACrB,GAAD,OAAmBqB,EAAUrB,IAO1CxW,qBAAU,WACNsC,SAASE,uBAAuB,eAAe,KACxCF,SAASE,uBAAuB,eAAe,GAAGW,UAAY,MAEtE,CAACgT,IAMJ,OACI,sBAAKhT,UAAW1D,EAAY,YAAc,GAA1C,UACI,cAAC,IAAD,CAASqX,SAAUC,IAASiB,IAAKxB,IAAKuB,EAAYF,UAClD,cAAC,EAAD,CACI9Y,gBAAiBA,EACjBC,iBAAkBA,EAClBC,gBAAiBA,EACjBC,cA9BU,SAACkC,EAAa4Q,GAChC5S,EAAU4B,SAAU5B,EAAU4B,QAAQ9B,cAAckC,EAAK4Q,IA8BjD7S,YAZQ,SAACqB,GACjBpB,EAAU4B,SAAU5B,EAAU4B,QAAQ7B,YAAYqB,IAY1CpB,UAAWA,IAEf,cAAC,EAAD,CACIyF,aAAcA,EACd9F,gBAAiBA,EACjB+F,cAAeA,EACf9F,iBAAkBA,EAClB+F,cA9BU,SAACkT,GACnBJ,EAAQK,KAAK,CAAE5W,KAAM,eAAgB+E,OAAQC,IAAO6R,OAAQhR,QAAS8Q,OA+BjE,cAAC,EAAD,CAAiB7Y,UAAWA,IAC3B+W,EACG,cAAC,EAAD,CAAqBA,aAAcA,EAAclX,gBAAiBA,IAClE,S,QC9DVmZ,EAA2B,CAC7B/Y,MAAO,CACH2C,MAAO,GACPqD,QAAS,GACTC,QAAS,GACTlE,IAAK,GACLQ,KAAM,UAIRyW,EAA+B,CACjC5Y,WAAW,GAGT6Y,EAA2B,CAC7BzX,MAAO,QAGL0X,EAA4B,CAC9BvC,OAAQ,IAGNwC,GAAkC,CACpCpG,aAAc,CACVlR,MAAO,KAwJAuX,eAAgB,CAAEjZ,aA7HZ,WAGiB,IAFlCD,EAEiC,uDAFO6Y,EACxCM,EACiC,uCACjC,OAAQA,EAAO5X,MACX,IAAK,YACD,OAAO,2BACAvB,GADP,IAEIF,MAAO,CACH2C,MAAO0W,EAAO3X,QAAQiB,MACtBqD,QAASqT,EAAO3X,QAAQsE,QACxBC,QAASoT,EAAO3X,QAAQuE,QACxBlE,IAAKsX,EAAO3X,QAAQK,IACpBQ,KAAM,WAGlB,IAAK,UACD,OAAO,2BACArC,GADP,IAEIF,MAAM,2BACCE,EAAMF,OADR,IAED+B,IAAKsX,EAAO3X,YAGxB,IAAK,aACD,OAAO,2BACAxB,GADP,IAEIF,MAAM,2BACCE,EAAMF,OADR,IAEDuC,KAAM,YAGlB,IAAK,qBACD,OAAO,2BACArC,GADP,IAEIF,MAAM,2BACCE,EAAMF,OADR,IAEDuC,KAAM,oBAGlB,IAAK,YACD,OAAO,2BACArC,GADP,IAEIF,MAAM,2BACCE,EAAMF,OADR,IAEDuC,KAAM,WAGlB,IAAK,qBACD,OAAO,2BACArC,GADP,IAEIF,MAAM,2BACCE,EAAMF,OADR,IAEDuC,KAAM,oBAGlB,QACI,OAAOrC,IAoE4BG,iBAhEtB,WAGiB,IAFtCH,EAEqC,uDAFO8Y,EAC5CK,EACqC,uCACrC,OAAQA,EAAO5X,MACX,IAAK,oBACD,OAAO,2BACAvB,GADP,IAEIE,WAAYF,EAAME,YAE1B,QACI,OAAOF,IAqD8C+V,aAjD5C,WAGiB,IAFlC/V,EAEiC,uDAFO+Y,EACxCI,EACiC,uCACjC,OAAQA,EAAO5X,MACX,IAAK,YACD,OAAO,2BACAvB,GADP,IAEIsB,MAAO6X,EAAO3X,UAEtB,QACI,OAAOxB,IAsC4D+X,cAlCzD,WAGiB,IAFnC/X,EAEkC,uDAFOgZ,EACzCG,EACkC,uCAClC,OAAQA,EAAO5X,MACX,IAAK,cACD,OAAO,2BACAvB,GADP,IAEIyW,OAAQ0C,EAAO3X,UAEvB,QACI,OAAOxB,IAuB2EgW,oBAnBlE,WAOiB,IANzChW,EAMwC,uDAFpCiZ,GACJE,EACwC,uCACxC,OAAQA,EAAO5X,MACX,IAAK,oBACD,OAAO,2BACAvB,GADP,IAEI6S,aAAcsG,EAAO3X,UAE7B,QACI,OAAOxB,MC7KNoZ,GAAQC,YAAYC,ICWlBC,I,OAZS,SAACC,GACjBA,GAAeA,aAAuBC,UACtC,8BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QACzDJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,QCEpBQ,IAAS9G,OACL,cAAC,IAAM+G,WAAP,UACI,cAAC,IAAD,CAAUb,MAAOA,GAAjB,SACI,cAAC,EAAD,QAGRrW,SAASsI,eAAe,SAM5BkO,O","file":"static/js/main.c789700f.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { Alignment, Button, Icon, InputGroup, Navbar, Switch, Menu, MenuItem, MenuDivider } from '@blueprintjs/core';\nimport { Popover2 } from '@blueprintjs/popover2';\n\nimport '../scss/VisualizerNavbar.scss';\nimport { VisualizerNavbarProps, stateInterface, proof } from './interfaces';\n\nfunction useWindowSize() {\n    // Initialize state with undefined width/height so server and client renders match\n    // Learn more here: https://joshwcomeau.com/react/the-perils-of-rehydration/\n    const [windowSize, setWindowSize] = useState({\n        width: 0,\n        height: 0,\n    });\n    useEffect(() => {\n        // Handler to call on window resize\n        function handleResize() {\n            // Set window width/height to state\n            setWindowSize({\n                width: window.innerWidth,\n                height: window.innerHeight,\n            });\n        }\n        // Add event listener\n        window.addEventListener('resize', handleResize);\n        // Call handler right away so state gets updated with initial window size\n        handleResize();\n        // Remove event listener on cleanup\n        return () => window.removeEventListener('resize', handleResize);\n    }, []); // Empty array ensures that effect is only run on mount\n    return windowSize;\n}\n\nconst VisualizerNavbar: React.FC<VisualizerNavbarProps> = ({\n    setDialogIsOpen,\n    setDialogContent,\n    setDrawerIsOpen,\n    downloadProof,\n    runCommands,\n    canvasRef,\n}: VisualizerNavbarProps) => {\n    const openDialog = (content: string): void => {\n        setDialogIsOpen(true);\n        setDialogContent(content);\n    };\n    const proof = useSelector<stateInterface, proof>((state: stateInterface) => state.proofReducer.proof);\n    const darkTheme = useSelector<stateInterface, boolean>((state: stateInterface) => state.darkThemeReducer.darkTheme);\n    const windowSize = useWindowSize();\n    const [command, setCommand] = useState('');\n\n    const dispatch = useDispatch();\n\n    const setDarkTheme = () => {\n        dispatch({ type: 'TOGGLE_DARK_THEME', payload: {} });\n    };\n\n    const setStyle = (style: string) => {\n        if (style !== 'tree') {\n            dispatch({\n                type: 'SET_IMPORTED_DATA',\n                payload: canvasRef.current ? canvasRef.current.exportProof() : { nodes: [], hidden: [] },\n            });\n        } else {\n            dispatch({ type: 'IMPORTED_DATA_VIEW', payload: proof.dot });\n        }\n\n        dispatch({ type: 'SET_STYLE', payload: style });\n    };\n\n    const changeView = (view: string) => {\n        switch (view) {\n            case 'basic':\n                dispatch({ type: 'BASIC_VIEW', payload: proof.dot });\n                break;\n            case 'propositional':\n                dispatch({ type: 'PROPOSITIONAL_VIEW', payload: proof.dot });\n                break;\n            case 'full':\n                dispatch({ type: 'FULL_VIEW', payload: proof.dot });\n                break;\n            case 'imported_data':\n                dispatch({ type: 'IMPORTED_DATA_VIEW', payload: proof.dot });\n                break;\n            default:\n        }\n        dispatch({ type: 'SET_DOT', payload: '' });\n        setTimeout(function () {\n            dispatch({ type: 'SET_DOT', payload: proof.dot });\n        }, 10);\n    };\n\n    const styleMenu = (\n        <Menu>\n            <MenuItem\n                icon=\"diagram-tree\"\n                text=\"Tree\"\n                onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                    e.preventDefault();\n                    setStyle('tree');\n                }}\n            />\n            <MenuItem\n                icon=\"folder-open\"\n                text=\"Directory\"\n                onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                    e.preventDefault();\n                    setStyle('directory');\n                }}\n            />\n        </Menu>\n    );\n\n    const viewsMenu = (\n        <Menu>\n            <MenuItem\n                text=\"Basic\"\n                onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                    e.preventDefault();\n                    runCommands('\\\\view basic');\n                }}\n            />\n            <MenuItem\n                text=\"Propositional\"\n                onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                    e.preventDefault();\n                    runCommands('\\\\view propositional');\n                }}\n            />\n            <MenuItem\n                text=\"Full\"\n                onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                    e.preventDefault();\n                    runCommands('\\\\view full');\n                }}\n            />\n            <MenuDivider></MenuDivider>\n            <MenuItem\n                text=\"Imported\"\n                onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                    e.preventDefault();\n                    changeView('imported_data');\n                }}\n            />\n        </Menu>\n    );\n    const exampleMenu = (\n        <Menu>\n            <MenuItem\n                icon=\"layout\"\n                text=\"JSON\"\n                onClick={() => downloadProof(proof.dot ? proof.dot : '', proof.label ? proof.label : '')}\n            />\n            <MenuItem\n                icon=\"graph\"\n                text=\"DOT\"\n                href={`data:attachment/text,${encodeURIComponent(proof.dot ? proof.dot : '')}`}\n                download={proof.label ? `${proof.label.replaceAll(' ', '_')}.dot` : ''}\n            />\n            <MenuItem\n                icon=\"square\"\n                text=\"PNG\"\n                onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                    e.preventDefault();\n                    const link = document.createElement('a');\n                    link.download = proof.label ? `${proof.label.replaceAll(' ', '_')}.png` : '';\n                    link.href = (\n                        document.getElementsByClassName('konvajs-content')[0].children[0] as HTMLCanvasElement\n                    ).toDataURL('image/png');\n                    link.click();\n                }}\n            />\n        </Menu>\n    );\n    return (\n        <Navbar>\n            <Navbar.Group align={Alignment.LEFT}>\n                <Navbar.Heading>\n                    <b>{windowSize.width >= 900 ? 'Proof Visualizer' : 'PV'}</b>\n                </Navbar.Heading>\n                <Navbar.Divider />\n                <Button\n                    onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                        e.preventDefault();\n                        openDialog('upload-proof');\n                    }}\n                    className=\"bp3-minimal\"\n                    icon=\"upload\"\n                    text={windowSize.width >= 900 ? 'Upload Proof' : ''}\n                />\n            </Navbar.Group>\n\n            <Navbar.Group align={Alignment.RIGHT}>\n                {proof.label ? (\n                    <>\n                        <Navbar.Heading>{proof.label}</Navbar.Heading>\n                        <Navbar.Divider />\n                        <InputGroup\n                            id=\"command\"\n                            placeholder=\"\\command\"\n                            value={command}\n                            onChange={(e) => setCommand(e.target.value)}\n                        />\n                        <Button\n                            style={{ marginLeft: '5px' }}\n                            icon=\"play\"\n                            onClick={() => {\n                                runCommands(command);\n                                setCommand('');\n                            }}\n                        />\n                        <Navbar.Divider />\n                        <Popover2\n                            content={proof.label ? styleMenu : undefined}\n                            placement=\"bottom-end\"\n                            disabled={proof.label ? false : true}\n                        >\n                            <Button\n                                icon=\"presentation\"\n                                className=\"bp3-minimal\"\n                                text={windowSize.width >= 900 ? 'Style' : ''}\n                                disabled={proof.label ? false : true}\n                            />\n                        </Popover2>\n                        <Popover2\n                            content={proof.label ? viewsMenu : undefined}\n                            placement=\"bottom-end\"\n                            disabled={proof.label ? false : true}\n                        >\n                            <Button\n                                className=\"bp3-minimal\"\n                                icon=\"diagram-tree\"\n                                text={windowSize.width >= 900 ? 'View' : ''}\n                                disabled={proof.label ? false : true}\n                            />\n                        </Popover2>\n                        <Button\n                            className=\"bp3-minimal\"\n                            icon=\"translate\"\n                            text={windowSize.width >= 900 ? 'Let Map' : ''}\n                            disabled={proof.label ? false : true}\n                            onClick={() => setDrawerIsOpen(true)}\n                        />\n                        <Popover2\n                            content={proof.label ? exampleMenu : undefined}\n                            placement=\"bottom-end\"\n                            disabled={proof.label ? false : true}\n                        >\n                            <Button\n                                className=\"bp3-minimal\"\n                                icon=\"download\"\n                                text={windowSize.width >= 900 ? 'Download' : ''}\n                                disabled={proof.label ? false : true}\n                            />\n                        </Popover2>\n                        <Navbar.Divider />\n                    </>\n                ) : null}\n\n                <span id=\"switch-button-dark-theme\">\n                    <Switch checked={darkTheme} onChange={() => setDarkTheme()} />\n                    <Icon icon={darkTheme ? 'moon' : 'flash'}></Icon>\n                </span>\n            </Navbar.Group>\n        </Navbar>\n    );\n};\n\nexport default VisualizerNavbar;\n","import React, { useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\n\nimport { Button, Classes, Dialog, FileInput, Intent, Spinner } from '@blueprintjs/core';\nimport { Icon } from '@blueprintjs/core/lib/esm/components/icon/icon';\n\nimport '../scss/VisualizerDialog.scss';\nimport { proof, VisualizerDialogProps, DialogProps, stateInterface } from './interfaces';\n\nconst readUploadedFileAsText = (inputFile: File) => {\n    const temporaryFileReader = new FileReader();\n\n    return new Promise((resolve, reject) => {\n        temporaryFileReader.onerror = () => {\n            temporaryFileReader.abort();\n            reject(new DOMException('Problem parsing input file.'));\n        };\n\n        temporaryFileReader.onload = () => {\n            resolve(temporaryFileReader.result);\n        };\n        temporaryFileReader.readAsText(inputFile);\n    });\n};\n\nconst VisualizerDialog: React.FC<VisualizerDialogProps> = ({\n    dialogIsOpen,\n    dialogContent,\n    setDialogContent,\n    setDialogIsOpen,\n    addErrorToast,\n}: VisualizerDialogProps) => {\n    const darkTheme = useSelector<stateInterface, boolean>((state: stateInterface) => state.darkThemeReducer.darkTheme);\n\n    let dialogProps: DialogProps = { icon: 'error', title: 'Error' };\n    let dialogBody = <p>This wasn&apos;t supposed to happen. Please contact the developers.</p>;\n    let succesButton = <></>;\n\n    const [proof, setProof] = useState<proof>({ _id: undefined, label: '', options: '', problem: '' });\n    const [processingProof, setProcessingProof] = useState(false);\n    const [proofProcessed, setProofProcessed] = useState(false);\n    const [fileName, changeFileName] = useState('Choose file...');\n    const [file, changeFile] = useState('');\n    const [ext, changeExt] = useState('');\n    const dispatch = useDispatch();\n\n    switch (dialogContent) {\n        case 'welcome':\n            dialogProps = { icon: 'graph', title: 'Welcome' };\n            dialogBody = (\n                <div className=\"welcome-menu\">\n                    <h2>Welcome to Proof Visualizer</h2>\n                    <p>You can upload the DOT file of your proof.</p>\n                    <Button\n                        style={{ width: '155px' }}\n                        icon=\"upload\"\n                        large\n                        text=\"Upload proof\"\n                        onClick={() => setDialogContent('upload-proof')}\n                    />\n                </div>\n            );\n            break;\n        case 'upload-proof':\n            dialogProps = { icon: 'upload', title: 'Upload Proof' };\n            dialogBody = proofProcessed ? (\n                <div style={{ textAlign: 'center', height: '200px', paddingTop: 50 }}>\n                    <Icon icon=\"tick\" intent={Intent.SUCCESS} iconSize={40}></Icon>\n                    <br></br>\n                    <br></br>\n                    <p>Your proof is ready to be visualized!</p>\n                </div>\n            ) : processingProof ? (\n                <div style={{ textAlign: 'center', height: '200px', paddingTop: 50 }}>\n                    <p>Processing your proof...</p>\n                    <Spinner size={30} />\n                </div>\n            ) : (\n                <FileInput\n                    text={fileName}\n                    hasSelection={fileName !== 'Choose file...'}\n                    onInputChange={async (e) => {\n                        const target = e.target as HTMLInputElement;\n                        const file = target.files ? target.files[0] : new File([''], 'filename');\n                        changeExt(target.files && target.files[0] ? target.files[0].name.split('.').slice(-1)[0] : '');\n                        if (\n                            target.files &&\n                            target.files[0] &&\n                            target.files[0].name.split('.').slice(-1)[0] !== 'dot' &&\n                            target.files[0].name.split('.').slice(-1)[0] !== 'json'\n                        ) {\n                            addErrorToast('Sorry! Our app only support DOT and JSON files.');\n                            return;\n                        }\n                        try {\n                            const fileContents = await readUploadedFileAsText(file);\n                            changeFile(fileContents as string);\n                            setProof({\n                                _id: undefined,\n                                label: file.name.split('.')[0],\n                                options: '',\n                                problem: '',\n                            });\n                            changeFileName(file.name);\n                        } catch (er) {\n                            addErrorToast(er.message);\n                        }\n                    }}\n                    fill={true}\n                />\n            );\n            succesButton = !proofProcessed ? (\n                <Button\n                    onClick={() => {\n                        if (ext === 'dot') {\n                            dispatch({ type: 'SET_PROOF', payload: proof });\n                            setProcessingProof(true);\n                            dispatch({ type: 'SET_DOT', payload: file });\n                            setProofProcessed(true);\n                        } else if (ext === 'json') {\n                            const json = JSON.parse(file);\n                            dispatch({ type: 'SET_PROOF', payload: proof });\n                            setProcessingProof(true);\n                            dispatch({ type: 'SET_DOT', payload: json.dot });\n                            dispatch({ type: 'IMPORTED_DATA_VIEW', payload: json.dot });\n                            dispatch({\n                                type: 'SET_IMPORTED_DATA',\n                                payload: { nodes: json.nodes, hidden: json.hidden },\n                            });\n                            setProofProcessed(true);\n                        }\n                    }}\n                    intent={Intent.SUCCESS}\n                    disabled={fileName === 'Choose file...'}\n                >\n                    Upload Proof\n                </Button>\n            ) : (\n                <></>\n            );\n            break;\n    }\n\n    return (\n        <>\n            <Dialog\n                className={darkTheme ? ' bp3-dark' : ''}\n                isOpen={dialogIsOpen}\n                onClose={(): void => {\n                    setProof({ label: '', options: '', problem: '' });\n                    setProcessingProof(false);\n                    setProofProcessed(false);\n                    setDialogIsOpen(false);\n                    changeFileName('Choose file...');\n                    changeFile('');\n                }}\n                usePortal={true}\n                {...dialogProps}\n            >\n                <div className={Classes.DIALOG_BODY + ' dialog-body'}>{dialogBody}</div>\n                <div className={Classes.DIALOG_FOOTER}>\n                    <div className={Classes.DIALOG_FOOTER_ACTIONS}>\n                        <Button\n                            onClick={(e: React.MouseEvent<HTMLElement, MouseEvent>) => {\n                                e.preventDefault();\n                                setDialogIsOpen(false);\n                                setProof({ label: '', options: '', problem: '' });\n                                setProcessingProof(false);\n                                setProofProcessed(false);\n                                setDialogIsOpen(false);\n                                changeFileName('Choose file...');\n                                changeFile('');\n                            }}\n                        >\n                            Close\n                        </Button>\n                        {succesButton}\n                    </div>\n                </div>\n            </Dialog>\n        </>\n    );\n};\n\nexport default VisualizerDialog;\n","import React from 'react';\nimport { Label, Text, Tag, Group } from 'react-konva';\n\nimport { NodeProps } from '../interfaces';\n\nfunction textColorFromBg(bgColor: string) {\n    const r = parseInt(bgColor.substring(0, 2), 16);\n    const g = parseInt(bgColor.substring(2, 4), 16);\n    const b = parseInt(bgColor.substring(4, 6), 16);\n    return r * 0.299 + g * 0.587 + b * 0.114 > 150 ? '#000000' : '#ffffff';\n}\n\nfunction sixDigitColor(bgColor: string): string {\n    if (bgColor.charAt(0) === '#') {\n        if (bgColor.length == 4) {\n            return bgColor\n                .substring(1, 7)\n                .split('')\n                .map((c) => c + c)\n                .join('');\n        } else if (bgColor.length == 7) {\n            return bgColor.substring(1, 7);\n        }\n    } else {\n        if (bgColor.length == 3) {\n            return bgColor\n                .split('')\n                .map((c) => c + c)\n                .join('');\n        } else if (bgColor.length == 6) {\n            return bgColor;\n        }\n    }\n    return '000000';\n}\n\nexport default class Node extends React.Component<NodeProps> {\n    render(): JSX.Element {\n        const {\n            rule,\n            conclusion,\n            args,\n            id,\n            x,\n            y,\n            selected,\n            nHided,\n            nDescendants,\n            topHidedNodes,\n            color,\n            setNodeOnFocus,\n            updateNodeState,\n            toggleNodeSelection,\n            openDrawer,\n            tree,\n        } = this.props;\n\n        const bgColor = color;\n\n        const tagProps = {\n            fill: bgColor,\n            stroke: selected ? 'red' : 'black',\n            strokeWidth: selected ? 3 : 1,\n        };\n        const textProps = {\n            align: 'center',\n            fill: textColorFromBg(sixDigitColor(bgColor)),\n            fontSize: 15,\n            height: 35,\n            padding: 10,\n            width: 300,\n        };\n        const nHidedStr = nHided\n            ? '#hidden: ' + '[' + (topHidedNodes ? topHidedNodes.map((node) => node[4]).join(', ') : '') + ']'\n            : '';\n        const nDescendantsStr =\n            ' #descendants: ' +\n            (rule !== 'π'\n                ? nDescendants\n                : '[' + (topHidedNodes ? topHidedNodes.map((node) => node[3]).join(', ') : '') + ']');\n        return (\n            <Group\n                draggable\n                id={id.toString()}\n                key={id}\n                onDragMove={(e) => {\n                    updateNodeState(id, e.target.attrs.x, e.target.attrs.y);\n                }}\n                x={x}\n                y={y}\n                onClick={(e) => {\n                    if (e.evt.button === 0) {\n                        if (e.evt.shiftKey) {\n                            toggleNodeSelection(id);\n                        } else {\n                            openDrawer(\n                                {\n                                    rule: rule,\n                                    args: args,\n                                    conclusion: conclusion,\n                                    nHided: nHided,\n                                    nDescendants: nDescendants - (rule === 'π' ? nHided : 0),\n                                    topHidedNodes: topHidedNodes,\n                                },\n                                tree,\n                            );\n                        }\n                    } else if (e.evt.button === 2) {\n                        setNodeOnFocus(id);\n                        const menuNode = document.getElementById('menu');\n                        if (menuNode) {\n                            menuNode.style.top = `${e.evt.clientY}px`;\n                            menuNode.style.left = `${e.evt.clientX}px`;\n                            menuNode.style.display = 'initial';\n                            window.addEventListener('click', () => {\n                                menuNode.style.display = 'none';\n                            });\n                        }\n                    }\n                }}\n            >\n                <Label x={0} y={0}>\n                    <Tag {...tagProps} />\n                    <Text\n                        {...textProps}\n                        text={\n                            conclusion +\n                            (conclusion === '∴' && topHidedNodes\n                                ? '[' + topHidedNodes.map((e) => e[2].trim()).join(',') + ']'\n                                : '')\n                        }\n                    />\n                </Label>\n                <Label x={0} y={35}>\n                    <Tag {...tagProps} />\n                    <Text\n                        {...textProps}\n                        text={\n                            rule +\n                            (rule === 'π' && topHidedNodes\n                                ? '[' + topHidedNodes.map((e) => e[1].trim()).join(',') + ']'\n                                : '')\n                        }\n                    />\n                </Label>\n                <Label x={0} y={70}>\n                    <Tag {...tagProps} />\n                    <Text {...textProps} text={nHidedStr + nDescendantsStr} />\n                </Label>\n            </Group>\n        );\n    }\n}\n","import React from 'react';\nimport { Arrow } from 'react-konva';\n\nimport { LineProps } from '../interfaces';\n\nconst Line = ({ key, points }: LineProps): JSX.Element => {\n    return <Arrow key={key} strokeWidth={1} stroke=\"black\" fill=\"black\" points={[...points]} />;\n};\n\nexport default Line;\n","import React, { useEffect, useState } from 'react';\nimport { ControlGroup, Button, InputGroup } from '@blueprintjs/core';\n\nconst Menu = ({\n    unfold,\n    foldSelectedNodes,\n    foldAllDescendants,\n    changeNodeColor,\n    currentColor,\n    options,\n}: {\n    unfold: () => void;\n    foldSelectedNodes: () => void;\n    foldAllDescendants: () => void;\n    changeNodeColor: (color: string) => void;\n    currentColor: string;\n    options: { unfold: boolean; foldSelected: boolean; foldAllDescendants: boolean };\n}): JSX.Element => {\n    const [color, setColor] = useState(currentColor);\n\n    useEffect(() => {\n        setColor(currentColor);\n    }, [currentColor]);\n\n    return (\n        <div className=\"bp3-popover2-content\">\n            <ul id=\"menu\" className=\"bp3-menu\">\n                {options.unfold ? (\n                    <li className=\"\">\n                        <a className=\"bp3-menu-item\" onClick={() => unfold()}>\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-open\">\n                                <span> Unfold</span>\n                            </div>\n                        </a>\n                    </li>\n                ) : null}\n                {options.foldSelected ? (\n                    <li className=\"\">\n                        <a className=\"bp3-menu-item\" onClick={() => foldSelectedNodes()}>\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-off\">\n                                <span> Fold selected nodes</span>\n                            </div>\n                        </a>\n                    </li>\n                ) : null}\n                {options.foldAllDescendants ? (\n                    <li className=\"\">\n                        <a className=\"bp3-menu-item\" onClick={() => foldAllDescendants()}>\n                            <div className=\"bp3-text-overflow-ellipsis bp3-fill bp3-icon-eye-off\">\n                                <span> Fold all descendants</span>\n                            </div>\n                        </a>\n                    </li>\n                ) : null}\n                <li className=\"\">\n                    <a className=\"bp3-menu-item\">\n                        <div className=\"bp3-text-overflow-ellipsis bp3-fill\">\n                            <span>\n                                <span onClick={() => changeNodeColor('#f72b34')}> 🟥</span>\n                                <span onClick={() => changeNodeColor('#ff8334')}> 🟧</span>\n                                <span onClick={() => changeNodeColor('#ffc149')}> 🟨</span>\n                                <span onClick={() => changeNodeColor('#60aa51')}> 🟩</span>\n                                <span onClick={() => changeNodeColor('#0097e4')}> 🟦</span>\n                                <span onClick={() => changeNodeColor('#a73da5')}> 🟪</span>\n                                <span onClick={() => changeNodeColor('#a95a49')}> 🟫</span>\n                                <span onClick={() => changeNodeColor('#464646')}> ⬛</span>\n                                <span onClick={() => changeNodeColor('#f0f0f0')}> ⬜</span>\n                            </span>\n                        </div>\n                    </a>\n                </li>\n                <li className=\"\">\n                    <a className=\"bp3-menu-item\">\n                        <div className=\"bp3-text-overflow-ellipsis bp3-fill\">\n                            <ControlGroup\n                                onClick={(e) => {\n                                    e.stopPropagation();\n                                }}\n                                fill={true}\n                                vertical={false}\n                            >\n                                <InputGroup\n                                    placeholder={currentColor}\n                                    value={color}\n                                    onChange={(e) => setColor(e.target.value)}\n                                />\n                                <Button\n                                    icon=\"style\"\n                                    onClick={() => {\n                                        changeNodeColor(color);\n                                        setColor('');\n                                    }}\n                                    disabled={color.match(/^(#[a-f0-9]{6})|(#[a-f0-9]{3})$/i) === null}\n                                ></Button>\n                            </ControlGroup>\n                        </div>\n                    </a>\n                </li>\n            </ul>\n        </div>\n    );\n};\n\nexport default Menu;\n","import React, { Component } from 'react';\nimport { Stage, Layer } from 'react-konva';\nimport Konva from 'konva';\nimport dagre from 'dagre';\nimport Node from './VisualizerNode';\nimport Line from './VisualizerLine';\nimport Menu from './VisualizerMenu';\n\nimport { NodeInterface, NodeProps, LineProps, TreeNode } from '../interfaces';\n\nimport '../../scss/VisualizerCanvas.scss';\n\nimport { CanvasProps, CanvasState } from '../interfaces';\n\nfunction handleWheel(e: Konva.KonvaEventObject<WheelEvent>): { stageScale: number; stageX: number; stageY: number } {\n    e.evt.preventDefault();\n\n    const scaleBy = 1.08;\n    const stage = e.target.getStage();\n    if (stage) {\n        const oldScale = stage.scaleX();\n        const pointerPosition = stage.getPointerPosition();\n        let x, y;\n\n        if (pointerPosition) {\n            [x, y] = [pointerPosition.x, pointerPosition.y];\n        } else {\n            [x, y] = [0, 0];\n        }\n\n        const mousePointTo = {\n            x: x / oldScale - stage.x() / oldScale,\n            y: y / oldScale - stage.y() / oldScale,\n        };\n\n        const newScale = e.evt.deltaY > 0 ? oldScale * scaleBy : oldScale / scaleBy;\n\n        return {\n            stageScale: newScale,\n            stageX: -(mousePointTo.x - x / newScale) * newScale,\n            stageY: -(mousePointTo.y - y / newScale) * newScale,\n        };\n    }\n    return {\n        stageScale: 1,\n        stageX: 0,\n        stageY: 0,\n    };\n}\n\nexport default class Canvas extends Component<CanvasProps, CanvasState> {\n    constructor(props: CanvasProps) {\n        super(props);\n\n        const { proofNodes } = this.props;\n        this.state = {\n            canvasSize: {\n                width: 520,\n                height: 300,\n            },\n            stage: {\n                stageScale: 1,\n                stageX: 0,\n                stageY: 0,\n            },\n            proofNodes,\n            showingNodes: {},\n            showingEdges: {},\n            nodeOnFocus: NaN,\n            nodesSelected: [],\n        };\n    }\n\n    componentDidMount(): void {\n        const { showingNodes, proofNodes } = this.state;\n        const { view, importedData } = this.props;\n\n        if (view !== 'imported_data') {\n            this.applyView(view);\n\n            this.updatePosition(0);\n            showingNodes[0] = new Node(this.nodeProps(proofNodes[0]));\n            this.addNodes(0);\n\n            const [width, height] = [window.innerWidth, window.innerHeight - 50];\n\n            this.setState({\n                showingNodes,\n                canvasSize: {\n                    width,\n                    height,\n                },\n                stage: {\n                    stageScale: 1,\n                    stageX: width / 2 - (showingNodes[0].props.x + 300 / 2),\n                    stageY: height / 10 - (showingNodes[0].props.y + 30 / 2),\n                },\n            });\n        } else {\n            importedData.nodes.forEach((node) => {\n                if (node.hidden.length) {\n                    node.hidden.forEach((nodeId) => {\n                        this.hideNode(nodeId);\n                    });\n                }\n            });\n\n            this.updatePosition(0);\n            showingNodes[0] = new Node(this.nodeProps(proofNodes[0]));\n            this.addNodes(0);\n\n            const [width, height] = [window.innerWidth, window.innerHeight - 50];\n\n            importedData.nodes.forEach((node) => {\n                if (showingNodes[node.id]) {\n                    showingNodes[node.id] = new Node({\n                        ...showingNodes[node.id].props,\n                        color: node.color,\n                    });\n                }\n            });\n\n            this.setState({\n                showingNodes,\n                canvasSize: {\n                    width,\n                    height,\n                },\n                stage: {\n                    stageScale: 1,\n                    stageX: width / 2 - (showingNodes[0].props.x + 300 / 2),\n                    stageY: height / 10 - (showingNodes[0].props.y + 30 / 2),\n                },\n            });\n\n            importedData.nodes.forEach((node) => {\n                if (showingNodes[node.id]) {\n                    this.updateNodeState(node.id, node.x, node.y);\n                }\n            });\n        }\n    }\n\n    applyView = (view: string | undefined): void => {\n        const { proofNodes } = this.state;\n        const nodesToHide = proofNodes.filter((node) => {\n            switch (view) {\n                case 'basic':\n                    return node.views.indexOf('basic') === -1;\n                case 'propositional':\n                    return node.views.indexOf('basic') === -1 && node.views.indexOf('propositional') === -1;\n                default:\n                    return false;\n            }\n        });\n        proofNodes.forEach((node) => {\n            if (proofNodes[node.id] && !(proofNodes[node.id].rule === 'π' || node.id === 0) && node.hided) {\n                this.unhideNode(node.id);\n            }\n        });\n        nodesToHide.forEach((node) => {\n            if (proofNodes[node.id] && !(proofNodes[node.id].rule === 'π' || node.id === 0)) {\n                this.hideNode(node.id);\n            }\n        });\n    };\n\n    foldSelectedNodes = (): void => {\n        const { proofNodes, nodesSelected, showingNodes } = this.state;\n        this.removeNodes(0);\n        nodesSelected\n            .sort((a, b) => a - b)\n            .forEach((nodeId) => {\n                if (!(proofNodes[nodeId].rule === 'π' || nodeId === 0)) {\n                    this.hideNode(nodeId);\n                }\n            });\n        this.updatePosition(0);\n        showingNodes[0] = new Node({ ...showingNodes[0].props, selected: false });\n        this.addNodes(0);\n        this.setState({ nodesSelected: [] });\n    };\n\n    unfold = (): void => {\n        const { proofNodes, nodeOnFocus } = this.state;\n        this.removeNodes(0);\n        const nodesToUnhide = [...proofNodes[nodeOnFocus].hidedNodes];\n        nodesToUnhide.forEach((nodeId) => this.unhideNode(nodeId));\n        this.updatePosition(0);\n        this.addNodes(0);\n        this.setNodeOnFocus(0);\n        this.setState({ nodesSelected: [] });\n    };\n\n    unfoldOnClick = (id: number): void => {\n        this.setNodeOnFocus(id);\n        setTimeout(() => this.unfold(), 10);\n    };\n\n    nodeProps = (node: NodeInterface): NodeProps => {\n        const { openDrawer } = this.props;\n        return {\n            id: node.id,\n            rule: node.rule,\n            conclusion: node.conclusion,\n            args: node.args,\n            updateNodeState: this.updateNodeState,\n            setNodeOnFocus: this.setNodeOnFocus,\n            toggleNodeSelection: this.toggleNodeSelection,\n            unfoldOnClick: this.unfoldOnClick,\n            openDrawer: openDrawer,\n            color: node.color,\n            x: node.x,\n            y: node.y,\n            selected: false,\n            nHided: node.hidedNodes.length,\n            nDescendants: node.descendants,\n            topHidedNodes: node.topHidedNodes ? node.topHidedNodes : undefined,\n            tree: node.tree ? node.tree : undefined,\n        };\n    };\n\n    toggleNodeSelection = (id: number): void => {\n        const { showingNodes } = this.state;\n        let { nodesSelected } = this.state;\n        if (showingNodes[id].props.selected) {\n            showingNodes[id] = new Node({ ...showingNodes[id].props, selected: false });\n            nodesSelected = nodesSelected.filter((nodeId) => nodeId !== id);\n        } else {\n            showingNodes[id] = new Node({ ...showingNodes[id].props, selected: true });\n            nodesSelected.push(id);\n        }\n        this.setState({ showingNodes, nodesSelected });\n    };\n\n    setNodeOnFocus = (id: number): void => {\n        this.setState({ nodeOnFocus: id });\n    };\n\n    LineProps = (key: string, from: NodeProps, to: NodeProps): LineProps => ({\n        key,\n        points: [from.x + 150, from.y, to.x + 150, to.y + 105],\n    });\n\n    addNodes = (id: number): void => {\n        const { proofNodes, showingNodes } = this.state;\n        proofNodes[id].children.forEach((child) => {\n            this.addNode(proofNodes[child], proofNodes[id]);\n            this.addNodes(child);\n        });\n        this.setState({ proofNodes, showingNodes });\n    };\n\n    addNode = (node: NodeInterface, parent: NodeInterface): void => {\n        const { showingNodes, showingEdges } = this.state;\n\n        showingNodes[node.id] = new Node(this.nodeProps(node));\n        showingEdges[`${node.id}->${parent.id}`] = Line(\n            this.LineProps(`${node.id}->${parent.id}`, showingNodes[node.id].props, showingNodes[parent.id].props),\n        );\n    };\n\n    removeNodes = (id: number): void => {\n        const { proofNodes, showingNodes } = this.state;\n        this.recursivelyGetChildren(id).forEach((node) => {\n            this.removeNode(node);\n        });\n        this.setState({ showingNodes, proofNodes });\n    };\n\n    removeNode = (id: number): void => {\n        const { showingNodes, showingEdges } = this.state;\n        Object.keys(showingEdges)\n            .filter((edgeKey) => {\n                const edges = edgeKey.split('->');\n                return id === parseInt(edges[0]) || id === parseInt(edges[1]);\n            })\n            .forEach((edge) => {\n                delete showingEdges[edge];\n            });\n\n        delete showingNodes[id];\n        this.setState({ showingNodes, showingEdges });\n    };\n\n    ancestors = (id: number): Array<number> => {\n        const { proofNodes } = this.state;\n        const ancestorsId: Array<number> = [];\n        let currentId = id;\n        while (currentId) {\n            currentId = proofNodes[currentId].parent;\n            ancestorsId.push(currentId);\n        }\n        return ancestorsId;\n    };\n\n    hideNode = (id: number): void => {\n        const { proofNodes, nodeOnFocus } = this.state;\n        const parentId = proofNodes[id].parent;\n        let piId: number;\n        if (parentId && proofNodes[parentId].hided) {\n            // if the parent node is hided in some node\n            piId = proofNodes[parentId].hidedIn;\n            proofNodes[piId].children.push(...proofNodes[id].children);\n            proofNodes[piId].children = proofNodes[piId].children.filter((nodeId) => nodeId !== id);\n            if (proofNodes[piId].topHidedNodes) {\n                proofNodes[piId].topHidedNodes = proofNodes[piId].topHidedNodes?.map((node) => {\n                    if (this.ancestors(id).indexOf(node[0]) !== -1)\n                        return [node[0], node[1], node[2], node[3], node[4] + 1];\n                    return node;\n                });\n            }\n        } else if (parentId && proofNodes[parentId].hideMyChildNode) {\n            // if the parent node has some node as child that hides node\n            piId = proofNodes[parentId].hideMyChildNode;\n            let nH: number | undefined = 1,\n                nD: number | undefined = 0;\n            if (proofNodes[id].children.length === 1 && proofNodes[proofNodes[id].children[0]].rule === 'π') {\n                proofNodes[proofNodes[id].children[0]].hidedNodes.forEach(\n                    (child) => (proofNodes[child].hidedIn = piId),\n                );\n                proofNodes[piId].hidedNodes.push(...proofNodes[proofNodes[id].children[0]].hidedNodes);\n                nD = proofNodes[proofNodes[id].children[0]].topHidedNodes?.reduce(\n                    (accumulator, node) => accumulator + node[3],\n                    0,\n                );\n                nH = proofNodes[proofNodes[id].children[0]].topHidedNodes?.reduce(\n                    (accumulator, node) => accumulator + node[4],\n                    0,\n                );\n                delete proofNodes[proofNodes[id].children[0]];\n                proofNodes[id].children = [];\n                proofNodes[id].hideMyChildNode = NaN;\n            }\n            proofNodes[piId].children.push(...proofNodes[id].children);\n            proofNodes[piId].topHidedNodes?.push([\n                id,\n                proofNodes[id].rule,\n                proofNodes[id].conclusion,\n                nD ? nD : 0,\n                nH ? nH : 0,\n            ]);\n            proofNodes[piId].descendants = nD ? nD : 0;\n            proofNodes[piId].hidedIn = nH ? nH : 0;\n        } else if (proofNodes[id].children.length === 1 && proofNodes[proofNodes[id].children[0]].rule === 'π') {\n            piId = proofNodes[id].children[0];\n            proofNodes[id].children = [];\n            proofNodes[parentId].children.push(piId);\n            proofNodes[parentId].hideMyChildNode = piId;\n            proofNodes[piId].parent = parentId;\n            proofNodes[piId].replace = id;\n            proofNodes[piId].descendants = proofNodes[id].descendants;\n            const nD = proofNodes[piId].topHidedNodes?.reduce((accumulator, node) => accumulator + node[3], 0);\n            const nH = proofNodes[piId].topHidedNodes?.reduce((accumulator, node) => accumulator + node[4], 0);\n            proofNodes[piId].topHidedNodes = [\n                [id, proofNodes[id].rule, proofNodes[id].conclusion, nD ? nD : 0, nH ? nH + 1 : 0],\n            ];\n        } else {\n            piId = proofNodes.length;\n            proofNodes[piId] = {\n                id: piId,\n                conclusion: '∴',\n                rule: 'π',\n                args: '',\n                children: [...proofNodes[id].children],\n                x: NaN,\n                y: NaN,\n                parent: parentId,\n                hided: false,\n                hidedNodes: [],\n                views: [],\n                hideMyChildNode: NaN,\n                hidedIn: NaN,\n                positionCache: false,\n                replace: id,\n                descendants: 0,\n                topHidedNodes: [[id, proofNodes[id].rule, proofNodes[id].conclusion, proofNodes[id].descendants, 1]],\n                rank: proofNodes[parentId].rank + 1,\n                color: proofNodes[nodeOnFocus] ? proofNodes[nodeOnFocus].color : '#8d99ae',\n            };\n            proofNodes[parentId].hideMyChildNode = piId;\n            proofNodes[parentId].children.push(piId);\n            proofNodes[piId].descendants = proofNodes[id].descendants;\n        }\n        proofNodes[piId].hidedNodes.push(id);\n        proofNodes[id].hided = true;\n        proofNodes[id].hidedIn = piId;\n        proofNodes[parentId].children = proofNodes[parentId].children.filter((nodeId) => nodeId !== id);\n        proofNodes[id].hideMyChildNode = NaN;\n        const tree = this.hiddenNodesTree(\n            proofNodes[piId].hidedNodes\n                .sort((a, b) => a - b)\n                .map((nodeId) => {\n                    return {\n                        id: nodeId,\n                        icon: 'graph',\n                        parentId: proofNodes[nodeId].parent,\n                        label: proofNodes[nodeId].rule + ' => ' + proofNodes[nodeId].conclusion,\n                        descendants: proofNodes[nodeId].descendants,\n                        childNodes: [],\n                        rule: proofNodes[nodeId].rule,\n                        conclusion: proofNodes[nodeId].conclusion,\n                        args: proofNodes[nodeId].args,\n                    };\n                }),\n        );\n        proofNodes[piId].tree = tree;\n        this.setState({ proofNodes });\n    };\n\n    hiddenNodesTree = (list: Array<TreeNode>): Array<TreeNode> => {\n        const map: { [n: number]: number } = {},\n            roots: Array<TreeNode> = [];\n        let node, i;\n\n        for (i = 0; i < list.length; i += 1) {\n            map[list[i].id] = i;\n            list[i].childNodes = [];\n        }\n\n        for (i = 0; i < list.length; i += 1) {\n            node = list[i];\n            if (node.parentId !== NaN && list[map[node.parentId]]) {\n                list[map[node.parentId]].childNodes.push(node);\n            } else {\n                roots.push(node);\n            }\n        }\n        return roots;\n    };\n\n    unhideNode = (id: number): void => {\n        const { proofNodes } = this.state;\n        const parentId = proofNodes[id].parent;\n        const piId = proofNodes[id].hidedIn;\n        proofNodes[id].hided = false;\n        proofNodes[parentId].children.push(id);\n        proofNodes[piId].hidedNodes = proofNodes[piId].hidedNodes.filter((nodeId) => nodeId !== id);\n        proofNodes[piId].children = proofNodes[piId].children.filter(\n            (nodeId) => !proofNodes[id].children.some((child) => child === nodeId),\n        );\n        if (proofNodes[piId].hidedNodes.length === 0) {\n            proofNodes[proofNodes[piId].parent].children = proofNodes[proofNodes[piId].parent].children.filter(\n                (nodeId) => nodeId !== piId,\n            );\n            proofNodes[proofNodes[piId].parent].hideMyChildNode = NaN;\n            delete proofNodes[piId];\n        }\n    };\n\n    updatePosition = (id: number): void => {\n        const { proofNodes } = this.state;\n        const g = new dagre.graphlib.Graph();\n        g.setGraph({ rankdir: 'BT', ranker: 'tight-tree' });\n        g.setDefaultEdgeLabel(function () {\n            return {};\n        });\n        proofNodes.forEach((node) => {\n            if (!node.hided) {\n                if (node.rule !== 'π') {\n                    g.setNode(node.id.toString(), { width: 300, height: 130 });\n                    proofNodes[node.id].children.sort().forEach((child) => {\n                        if (proofNodes[child].rule !== 'π') g.setEdge(child.toString(), node.id.toString());\n                        else {\n                            const childNode = proofNodes[child];\n                            g.setEdge(\n                                (childNode.replace ? childNode.replace : childNode.id).toString(),\n                                node.id.toString(),\n                            );\n                        }\n                    });\n                } else {\n                    g.setNode((node.replace ? node.replace : node.id).toString(), { width: 300, height: 130 });\n                    proofNodes[node.id].children.forEach((child) => {\n                        g.setEdge(child.toString(), (node.replace ? node.replace : node.id).toString());\n                    });\n                }\n            }\n        });\n        dagre.layout(g);\n        const xOffset = g.node(id.toString()).x - (proofNodes[id].x ? proofNodes[id].x : 0);\n        const yOffset = g.node(id.toString()).y - (proofNodes[id].y ? proofNodes[id].y : 0);\n        g.nodes().forEach(function (v) {\n            try {\n                const { x, y } = g.node(v);\n                if (!proofNodes[parseInt(v)].hided) {\n                    proofNodes[parseInt(v)].x = x - xOffset;\n                    proofNodes[parseInt(v)].y = y - yOffset;\n                } else {\n                    proofNodes[proofNodes[parseInt(v)].hidedIn].x = x - xOffset;\n                    proofNodes[proofNodes[parseInt(v)].hidedIn].y = y - yOffset;\n                }\n            } catch (e) {\n                console.log(e);\n            }\n        });\n        this.setState({ proofNodes });\n    };\n\n    updateNodeState = (key: number, x: number, y: number): void => {\n        const { showingNodes, showingEdges, proofNodes } = this.state;\n        showingNodes[key] = new Node({ ...showingNodes[key].props, x, y });\n\n        proofNodes[key].positionCache = true;\n        proofNodes[key] = { ...proofNodes[key], x, y };\n\n        Object.keys(showingEdges)\n            .filter((edgeKey) => edgeKey.indexOf(key.toString()) !== -1)\n            .forEach((edge) => {\n                const [from, to] = edge.split('->').map((x) => parseInt(x));\n                showingEdges[edge] = Line(this.LineProps(edge, showingNodes[from].props, showingNodes[to].props));\n            });\n        this.setState({ showingNodes, showingEdges });\n    };\n\n    recursivelyGetChildren = (nodeId: number): Array<number> => {\n        const { proofNodes } = this.state;\n        let nodes: Array<number> = [];\n        proofNodes[nodeId].children.forEach((node) => {\n            nodes = nodes.concat([node]);\n            nodes = nodes.concat(this.recursivelyGetChildren(node));\n        });\n        return nodes;\n    };\n\n    foldAllDescendants = (): void => {\n        const { nodeOnFocus, nodesSelected } = this.state;\n        const nodes = (\n            nodesSelected\n                ? nodesSelected.reduce<number[]>(\n                      (accumulator, currentValue) => accumulator.concat(this.recursivelyGetChildren(currentValue)),\n                      [],\n                  )\n                : []\n        ).concat(...[nodeOnFocus, ...this.recursivelyGetChildren(nodeOnFocus)]);\n        this.setState({ nodesSelected: nodes }, () => this.foldSelectedNodes());\n    };\n\n    changeNodeColor = (color: string): void => {\n        const { proofNodes, showingNodes, nodesSelected, nodeOnFocus } = this.state;\n        nodesSelected.forEach((nodeId) => {\n            showingNodes[nodeId] = new Node({ ...showingNodes[nodeId].props, selected: false, color: color });\n            proofNodes[nodeId].color = color;\n        });\n        if (showingNodes[nodeOnFocus]) {\n            showingNodes[nodeOnFocus] = new Node({ ...showingNodes[nodeOnFocus].props, color: color });\n            proofNodes[nodeOnFocus].color = color;\n        }\n        this.setState({ showingNodes, nodesSelected: [] });\n    };\n\n    downloadProof = (dot: string, proofName: string): void => {\n        const link = document.createElement('a');\n        link.download = proofName + '.json';\n        link.href = `data:attachment/text,${encodeURIComponent(JSON.stringify(this.exportProof(dot)))}`;\n        link.click();\n    };\n\n    exportProof = (\n        dot = '',\n    ): { dot: string; nodes: { id: number; color: string; x: number; y: number; hidden: Array<number> }[] } => {\n        const { showingNodes, proofNodes } = this.state;\n        return {\n            dot: dot,\n            nodes: Object.keys(showingNodes).map((node) => {\n                return {\n                    id: parseInt(node),\n                    color: showingNodes[parseInt(node)].props.color,\n                    x: showingNodes[parseInt(node)].props.x,\n                    y: showingNodes[parseInt(node)].props.y,\n                    hidden: proofNodes[parseInt(node)].hidedNodes.filter((nodeId) => proofNodes[nodeId].hided),\n                };\n            }),\n        };\n    };\n\n    runCommands = (command: string): void => {\n        const { showingNodes, proofNodes } = this.state;\n        let nodes: Array<number> = [];\n        if (command.split(' ')[0] == '\\\\search' || command.split(' ')[0] == '\\\\color') {\n            if (command.split(' ')[1] == '*') {\n                nodes = Object.keys(showingNodes).map((nodeId) => parseInt(nodeId));\n            } else {\n                nodes = Object.keys(showingNodes)\n                    .map((nodeId) => parseInt(nodeId))\n                    .filter((nodeId) => {\n                        return (\n                            (showingNodes[nodeId].props.rule.indexOf(command.split(' ')[1]) !== -1 ||\n                                showingNodes[nodeId].props.conclusion.indexOf(command.split(' ')[1]) !== -1 ||\n                                proofNodes[nodeId].hidedNodes.some((hiddenNodeId) => {\n                                    return (\n                                        proofNodes[hiddenNodeId].rule.indexOf(command.split(' ')[1]) !== -1 ||\n                                        proofNodes[hiddenNodeId].conclusion.indexOf(command.split(' ')[1]) !== -1\n                                    );\n                                })) &&\n                            showingNodes[nodeId]\n                        );\n                    });\n            }\n        }\n        switch (command.split(' ')[0]) {\n            case '\\\\search':\n                nodes.forEach((nodeId) => {\n                    showingNodes[nodeId] = new Node({ ...showingNodes[nodeId].props, selected: true });\n                });\n                this.setState({ showingNodes, nodesSelected: nodes });\n                break;\n            case '\\\\color':\n                const color = command.split(' ')[2];\n                nodes.forEach((nodeId) => {\n                    showingNodes[nodeId] = new Node({ ...showingNodes[nodeId].props, color: color });\n                    proofNodes[nodeId].color = color;\n                });\n                this.setState({ showingNodes });\n                break;\n            case '\\\\view':\n                this.removeNodes(0);\n                this.applyView(command.split(' ')[1]);\n\n                this.exportProof().nodes.forEach((node) => {\n                    if (showingNodes[node.id]) {\n                        showingNodes[node.id] = new Node({\n                            ...showingNodes[node.id].props,\n                            color: node.color,\n                        });\n                    }\n                });\n                this.updatePosition(0);\n                this.addNodes(0);\n        }\n    };\n\n    render(): JSX.Element {\n        const { canvasSize, stage, showingNodes, showingEdges, nodesSelected, nodeOnFocus, proofNodes } = this.state;\n        const color = showingNodes[nodeOnFocus] ? showingNodes[nodeOnFocus].props.color : '';\n\n        return (\n            <>\n                <Menu\n                    unfold={this.unfold}\n                    foldSelectedNodes={this.foldSelectedNodes}\n                    foldAllDescendants={this.foldAllDescendants}\n                    changeNodeColor={this.changeNodeColor}\n                    options={{\n                        unfold: proofNodes[nodeOnFocus] ? proofNodes[nodeOnFocus].rule === 'π' : false,\n                        foldSelected: nodesSelected.length && nodesSelected.includes(nodeOnFocus) ? true : false,\n                        foldAllDescendants: proofNodes[nodeOnFocus] && proofNodes[nodeOnFocus].children.length > 0,\n                    }}\n                    currentColor={color}\n                ></Menu>\n                <Stage\n                    draggable\n                    width={canvasSize.width}\n                    height={canvasSize.height}\n                    onWheel={(e) => this.setState({ stage: handleWheel(e) })}\n                    scaleX={stage.stageScale}\n                    scaleY={stage.stageScale}\n                    x={stage.stageX}\n                    y={stage.stageY}\n                    onContextMenu={(e) => e.evt.preventDefault()}\n                >\n                    <Layer>\n                        {Object.keys(showingEdges).length > 0 &&\n                            Object.keys(showingEdges).map(function (key) {\n                                return showingEdges[key];\n                            })}\n                        {Object.keys(showingNodes).length > 0 &&\n                            Object.keys(showingNodes).map(\n                                (value: string): JSX.Element => showingNodes[parseInt(value)].render(),\n                            )}\n                    </Layer>\n                </Stage>\n            </>\n        );\n    }\n}\n","/* eslint-disable @typescript-eslint/explicit-module-boundary-types */\n/* eslint-disable @typescript-eslint/no-explicit-any */\nimport * as React from 'react';\n\nimport { Classes, TreeNodeInfo, Tree } from '@blueprintjs/core';\n\nexport class VisualizerTree extends React.Component<\n    any,\n    { nodes: TreeNodeInfo[]; selected: number; originalNodeInfo: any }\n> {\n    constructor(props: any) {\n        super(props);\n\n        this.state = {\n            nodes: props.content,\n            selected: NaN,\n            originalNodeInfo: props.originalNodeInfo,\n        };\n    }\n\n    componentDidUpdate(prevProps: any) {\n        if (this.props.content !== prevProps.content) {\n            this.setState({ nodes: this.props.content });\n        }\n    }\n\n    public render(): JSX.Element {\n        return (\n            <div style={{ backgroundColor: this.props.darkTheme ? '#394b59' : 'white' }}>\n                <Tree\n                    contents={this.state.nodes}\n                    onNodeClick={this.handleNodeClick}\n                    onNodeCollapse={this.handleNodeCollapse}\n                    onNodeExpand={this.handleNodeExpand}\n                    className={Classes.ELEVATION_0}\n                />\n            </div>\n        );\n    }\n\n    private handleNodeClick = (nodeData: any, _nodePath: number[], e: React.MouseEvent<HTMLElement>) => {\n        const { setNodeInfo } = this.props;\n        setNodeInfo(\n            this.state.selected !== nodeData.id\n                ? {\n                      rule: nodeData.rule ? nodeData.rule : '',\n                      args: nodeData.args ? nodeData.args : '',\n                      conclusion: nodeData.conclusion ? nodeData.conclusion : '',\n                      nHided: 0,\n                      nDescendants: nodeData.descendants,\n                      topHidedNodes: undefined,\n                  }\n                : this.state.originalNodeInfo,\n        );\n        const originallySelected = nodeData.isSelected;\n        if (!e.shiftKey) {\n            this.forEachNode(this.state.nodes, (n) => (n.isSelected = false));\n        }\n        nodeData.isSelected = originallySelected == null ? true : !originallySelected;\n        this.setState({ ...this.state, selected: this.state.selected === nodeData.id ? NaN : nodeData.id });\n    };\n\n    private handleNodeCollapse = (nodeData: TreeNodeInfo) => {\n        nodeData.isExpanded = false;\n        this.setState(this.state);\n    };\n\n    private handleNodeExpand = (nodeData: TreeNodeInfo) => {\n        nodeData.isExpanded = true;\n        this.setState(this.state);\n    };\n\n    private forEachNode(nodes: TreeNodeInfo[], callback: (node: TreeNodeInfo) => void) {\n        if (nodes == null) {\n            return;\n        }\n\n        for (const node of nodes) {\n            callback(node);\n            this.forEachNode(node.childNodes ? node.childNodes : [], callback);\n        }\n    }\n}\n","import React, { useState } from 'react';\nimport { useSelector } from 'react-redux';\n\nimport { Icon, Collapse, Pre, TreeNodeInfo } from '@blueprintjs/core';\nimport { VisualizerTree } from './VisualizerTree';\n\nimport { stateInterface } from './interfaces';\n\nimport '../scss/VisualizerDirectoryStyle.scss';\n\ninterface directoryStyleProps {\n    proofTree: TreeNodeInfo[];\n    ruleHelper: (s: string) => string;\n    indent: (s: string) => string;\n    translate: (s: string) => string;\n}\n\nconst VisualizerDirectoryStyle: React.FC<directoryStyleProps> = ({\n    proofTree,\n    ruleHelper,\n    indent,\n    translate,\n}: directoryStyleProps) => {\n    const darkTheme = useSelector<stateInterface, boolean>((state: stateInterface) => state.darkThemeReducer.darkTheme);\n    const [ruleHelperOpen, setRuleHelperOpen] = useState(false);\n    const [argsTranslatorOpen, setArgsTranslatorOpen] = useState(false);\n    const [conclusionTranslatorOpen, setConclusionTranslatorOpen] = useState(false);\n    const [nodeInfo, setNodeInfo] = useState<{\n        rule: string;\n        args: string;\n        conclusion: string;\n        nHided: number;\n        nDescendants: number;\n        topHidedNodes?: Array<[number, string, string, number, number]>;\n    }>({\n        rule: '',\n        args: '',\n        conclusion: '',\n        nHided: 0,\n        nDescendants: 0,\n        topHidedNodes: undefined,\n    });\n\n    return (\n        <div\n            style={{\n                backgroundColor: darkTheme ? 'rgb(57, 75, 89)' : 'white',\n                height:\n                    window.innerHeight - (document.getElementsByClassName('bp3-navbar')[0] as HTMLElement).offsetHeight,\n            }}\n        >\n            <div\n                style={{\n                    width: '50%',\n                    height: '100%',\n                    float: 'left',\n                    clear: 'none',\n                    borderRight: '1px solid black',\n                    overflow: 'auto',\n                }}\n            >\n                <VisualizerTree\n                    darkTheme={darkTheme}\n                    content={proofTree}\n                    setNodeInfo={setNodeInfo}\n                    originalNodeInfo={{\n                        rule: '',\n                        args: '',\n                        conclusion: '',\n                        nHided: 0,\n                        nDescendants: 0,\n                        topHidedNodes: undefined,\n                    }}\n                ></VisualizerTree>\n            </div>\n            <div\n                style={{\n                    width: '50%',\n                    height: '100%',\n                    float: 'left',\n                    clear: 'none',\n                }}\n            >\n                <table\n                    id=\"table-node-info\"\n                    className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\n                    style={{ width: '100%' }}\n                >\n                    <thead>\n                        <tr>\n                            <th>Property</th>\n                            <th>Value</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr>\n                            <td>\n                                <strong>RULE </strong>{' '}\n                                <Icon\n                                    id=\"rule-icon\"\n                                    icon=\"help\"\n                                    onClick={() => {\n                                        setArgsTranslatorOpen(false);\n                                        setConclusionTranslatorOpen(false);\n                                        setRuleHelperOpen(!ruleHelperOpen);\n                                    }}\n                                ></Icon>\n                            </td>\n                            <td className=\"value\">\n                                {nodeInfo.rule}\n                                <Collapse isOpen={ruleHelperOpen}>\n                                    <Pre id=\"pre-rule\">{ruleHelper(nodeInfo.rule)}</Pre>\n                                </Collapse>\n                            </td>\n                        </tr>\n                        {nodeInfo.args ? (\n                            <tr>\n                                <td>\n                                    <strong>ARGS</strong>{' '}\n                                    {nodeInfo.args.indexOf('let') !== -1 ? (\n                                        <Icon\n                                            id=\"rule-icon\"\n                                            icon=\"translate\"\n                                            onClick={() => {\n                                                setRuleHelperOpen(false);\n                                                setConclusionTranslatorOpen(false);\n                                                setArgsTranslatorOpen(!argsTranslatorOpen);\n                                            }}\n                                        ></Icon>\n                                    ) : null}\n                                </td>\n                                <td className=\"value\">\n                                    {nodeInfo.args}\n                                    {nodeInfo.args.indexOf('let') !== -1 ? (\n                                        <Collapse isOpen={argsTranslatorOpen}>\n                                            <Pre id=\"pre-rule\">{indent(translate(nodeInfo.args))}</Pre>\n                                        </Collapse>\n                                    ) : null}\n                                </td>\n                            </tr>\n                        ) : null}\n                        <tr>\n                            <td>\n                                <strong>CONCLUSION</strong>{' '}\n                                {nodeInfo.conclusion.indexOf('let') !== -1 ? (\n                                    <Icon\n                                        id=\"rule-icon\"\n                                        icon=\"translate\"\n                                        onClick={() => {\n                                            setRuleHelperOpen(false);\n                                            setArgsTranslatorOpen(false);\n                                            setConclusionTranslatorOpen(!conclusionTranslatorOpen);\n                                        }}\n                                    ></Icon>\n                                ) : null}\n                            </td>\n                            <td className=\"value\">\n                                {nodeInfo.conclusion}\n                                {nodeInfo.conclusion.indexOf('let') !== -1 ? (\n                                    <Collapse isOpen={conclusionTranslatorOpen}>\n                                        <Pre id=\"pre-rule\">{indent(translate(nodeInfo.conclusion))}</Pre>\n                                    </Collapse>\n                                ) : null}\n                            </td>\n                        </tr>\n                        {!nodeInfo.topHidedNodes ? (\n                            <tr>\n                                <td>\n                                    <strong>#DESCENDANTS</strong>\n                                </td>\n                                <td>{nodeInfo.nDescendants}</td>\n                            </tr>\n                        ) : (\n                            <tr>\n                                <td>\n                                    <strong>#DESCENDANTS</strong>\n                                </td>\n                                <td>[{nodeInfo.topHidedNodes.map((node) => node[3]).join(', ')}]</td>\n                            </tr>\n                        )}\n                        {nodeInfo.nHided ? (\n                            <tr>\n                                <td>\n                                    <strong>#HIDDEN</strong>\n                                </td>\n                                <td>\n                                    [\n                                    {nodeInfo.topHidedNodes\n                                        ? nodeInfo.topHidedNodes.map((node) => node[4]).join(', ')\n                                        : ''}\n                                    ]\n                                </td>\n                            </tr>\n                        ) : null}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    );\n};\n\nexport default VisualizerDirectoryStyle;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport React, { useState } from 'react';\nimport { useSelector, useDispatch } from 'react-redux';\n\nimport { Drawer, Position, Classes, Icon, Collapse, Pre, TreeNodeInfo } from '@blueprintjs/core';\nimport Canvas from './canvas/VisualizerCanvas';\nimport { VisualizerTree } from './VisualizerTree';\nimport VisualizerDirectoryStyle from './VisualizerDirectoryStyle';\nimport { NodeInterface, stateInterface } from './interfaces';\n\nimport '../scss/VisualizerStage.scss';\n\nfunction removeEscapedCharacters(s: string): string {\n    let newS = '';\n    for (let i = 0; i < s.length; i += 1) {\n        if (\n            !(\n                s[i] === '\\\\' &&\n                (s[i + 1] === '\"' ||\n                    s[i + 1] === '>' ||\n                    s[i + 1] === '<' ||\n                    s[i + 1] === '{' ||\n                    s[i + 1] === '}' ||\n                    s[i + 1] === '|')\n            )\n        ) {\n            newS += s[i];\n        }\n    }\n\n    return newS;\n}\n\nfunction processDot(dot: string) {\n    const nodes: Array<NodeInterface> = [\n        {\n            id: 0,\n            conclusion: '',\n            rule: '',\n            args: '',\n            views: [],\n            children: [],\n            parent: NaN,\n            x: NaN,\n            y: NaN,\n            hideMyChildNode: NaN,\n            hided: false,\n            hidedNodes: [],\n            hidedIn: NaN,\n            positionCache: false,\n            descendants: 0,\n            rank: 0,\n            color: '#8d99ae',\n        },\n    ];\n    let comment: any = dot.slice(dot.indexOf('comment='));\n    comment = comment\n        ? removeEscapedCharacters(\n              removeEscapedCharacters(comment.slice(comment.indexOf('=') + 2, comment.indexOf(';') - 1)),\n          )\n        : null;\n    if (comment) {\n        const dispatch = useDispatch();\n        dispatch({\n            type: 'SET_LET_MAP',\n            payload: JSON.parse(comment)['letMap'],\n        });\n    }\n\n    const lines = dot\n        .slice(dot.indexOf('{') + 1, dot.lastIndexOf('}') - 2)\n        .replace(/(\\n|\\t)/gm, '')\n        .split(';');\n    lines.forEach((line) => {\n        if (line.search('label') !== -1) {\n            const id = parseInt(line.slice(0, line.indexOf('[')).trim());\n            let attributes = line.slice(line.indexOf('[') + 1, line.lastIndexOf(']')).trim();\n\n            let label = attributes.slice(attributes.search(/(?<!\\\\)\"/) + 2);\n            label = label.slice(0, label.search(/(?<!\\\\)\"/) - 1);\n            let [conclusion, rule, args] = ['', '', ''];\n            [conclusion, rule] = label.split(/(?<!\\\\)\\|/);\n            [rule, args] = rule.indexOf(':args') != -1 ? rule.split(':args') : [rule, ''];\n\n            attributes = attributes.slice(attributes.indexOf(', class = ') + ', class = '.length);\n            attributes = attributes.slice(attributes.indexOf('\"') + 1, attributes.slice(1).indexOf('\"') + 1);\n            const views = attributes.trim().split(' ');\n            const comment: string = removeEscapedCharacters(line.slice(line.indexOf('comment'), line.lastIndexOf('\"')));\n            const commentJSON = JSON.parse(comment.slice(comment.indexOf('\"') + 1).replace(/'/g, '\"'));\n\n            if (!nodes[id]) {\n                nodes[id] = {\n                    id: id,\n                    conclusion: '',\n                    rule: '',\n                    args: '',\n                    views: [],\n                    children: [],\n                    parent: NaN,\n                    x: NaN,\n                    y: NaN,\n                    hideMyChildNode: NaN,\n                    hided: false,\n                    hidedNodes: [],\n                    hidedIn: NaN,\n                    positionCache: false,\n                    descendants: 0,\n                    rank: 0,\n                    color: '#8d99ae',\n                };\n            }\n            nodes[id].conclusion = removeEscapedCharacters(conclusion);\n            nodes[id].rule = removeEscapedCharacters(rule);\n            nodes[id].args = removeEscapedCharacters(args);\n            nodes[id].views = views;\n            nodes[id].descendants = commentJSON.subProofQty - 1;\n        } else if (line.search('->') !== -1) {\n            const [child, parent] = line.split('->').map((x) => parseInt(x.trim()));\n            nodes[parent].children.push(child);\n            if (!nodes[child]) {\n                nodes[child] = {\n                    id: child,\n                    conclusion: '',\n                    rule: '',\n                    args: '',\n                    views: [],\n                    children: [],\n                    parent: parent,\n                    x: NaN,\n                    y: NaN,\n                    hideMyChildNode: NaN,\n                    hided: false,\n                    hidedNodes: [],\n                    hidedIn: NaN,\n                    positionCache: false,\n                    descendants: 0,\n                    rank: nodes[parent].rank + 1,\n                    color: '#8d99ae',\n                };\n            }\n            nodes[child].parent = parent;\n            nodes[child].rank = nodes[parent].rank + 1;\n        }\n    });\n    return comment ? [nodes, JSON.parse(comment)['letMap']] : [nodes, {}];\n}\n\nfunction ruleHelper(rule: string) {\n    switch (rule.split(' ')[0]) {\n        case 'π':\n            return 'This node hides some parts of the proof, you can unfold it.';\n        case 'ASSUME':\n            return (\n                rule +\n                '\\n\\n======== Assumption (a leaf)\\nChildren: none\\nArguments: (F)\\n--------------\\nConclusion: F\\n\\nThis rule has special status, in that an application of assume is an open leaf in a proof that is not (yet) justified. An assume leaf is analogous to a free variable in a term, where we say \"F is a free assumption in proof P\" if it contains an application of F that is not  bound by SCOPE.'\n            );\n        case 'SCOPE':\n            return (\n                rule +\n                '\\n\\n======== Scope (a binder for assumptions)\\nChildren: (P:F)\\nArguments: (F1, ..., Fn)\\n--------------\\nConclusion: (=> (and F1 ... Fn) F) or (not (and F1 ... Fn)) if F is false\\n\\nThis rule has a dual purpose with ASSUME. It is a way to close assumptions in a proof. We require that F1 ... Fn are free assumptions in P and say that F1, ..., Fn are not free in (SCOPE P). In other words, they are bound by this application. For example, the proof node: (SCOPE (ASSUME F) :args F) has the conclusion (=> F F) and has no free assumptions. More generally, a proof with no free assumptions always concludes a valid formula.'\n            );\n        case 'SUBS':\n            return (\n                rule +\n                '\\n\\n======== Substitution\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (t, (ids)?)\\n---------------------------------------------------------------\\nConclusion: (= t t*sigma{ids}(Fn)*...*sigma{ids}(F1))\\nwhere sigma{ids}(Fi) are substitutions, which notice are applied in reverse order. Notice that ids is a MethodId identifier, which determines how to convert the formulas F1, ..., Fn into substitutions.'\n            );\n        case 'REWRITE':\n            return (\n                rule +\n                '\\n\\n======== Rewrite\\nChildren: none\\nArguments: (t, (idr)?)\\n----------------------------------------\\nConclusion: (= t Rewriter{idr}(t))\\nwhere idr is a MethodId identifier, which determines the kind of rewriter to apply, e.g. Rewriter::rewrite.'\n            );\n        case 'EVALUATE':\n            return (\n                rule +\n                '\\n\\n======== Evaluate\\nChildren: none\\n\\nArguments: (t)\\n----------------------------------------\\nConclusion: (= t Evaluator::evaluate(t))\\nNote this is equivalent to: (REWRITE t MethodId::RW_EVALUATE)'\n            );\n        case 'MACRO_SR_EQ_INTRO':\n            return (\n                rule +\n                \"\\n\\nIn this rule, we provide a term t and conclude that it is equal to its rewritten form under a (proven) substitution.\\n\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (t, (ids (ida (idr)?)?)?)\\n---------------------------------------------------------------\\nConclusion: (= t t')\\nwhere t' is Rewriter{idr}(t*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1))\\n\\nIn other words, from the point of view of Skolem forms, this rule transforms t to t' by standard substitution + rewriting.\\n\\nThe arguments ids, ida and idr are optional and specify the identifier of the substitution, the substitution application and rewriter respectively to be used.\"\n            );\n        case 'MACRO_SR_PRED_INTRO':\n            return (\n                rule +\n                \"\\n\\nIn this rule, we provide a formula F and conclude it, under the condition that it rewrites to true under a proven substitution.\\n\\nChildren: (P1:F1, ..., Pn:Fn)\\nArguments: (F, (ids (ida (idr)?)?)?)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)) == true where ids and idr are method identifiers.\\n\\nMore generally, this rule also holds when: Rewriter::rewrite(toOriginal(F')) == true where F' is the result of the left hand side of the equality above. Here, notice that we apply rewriting on the original form of F', meaning that this rule may conclude an F whose Skolem form is justified by the definition of its (fresh) Skolem variables. For example, this rule may justify the conclusion (= k t) where k is the purification Skolem for t, e.g. where the original form of k is t.\\n\\nFurthermore, notice that the rewriting and substitution is applied only within the side condition, meaning the rewritten form of the original form of F does not escape this rule.\"\n            );\n        case 'MACRO_SR_PRED_ELIM':\n            return (\n                rule +\n                \"\\n\\nIn this rule, if we have proven a formula F, then we may conclude its rewritten form under a proven substitution.\\n\\nChildren: (P1:F, P2:F1, ..., P_{n+1}:Fn)\\nArguments: ((ids (ida (idr)?)?)?)\\n----------------------------------------\\nConclusion: F'\\nwhere F' is Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)). where ids and idr are method identifiers.\\n\\nWe rewrite only on the Skolem form of F, similar to MACRO_SR_EQ_INTRO.\"\n            );\n        case 'MACRO_SR_PRED_TRANSFORM':\n            return (\n                rule +\n                \"\\n\\nIn this rule, if we have proven a formula F, then we may provide a formula G and conclude it if F and G are equivalent after rewriting under a proven substitution.\\n\\nChildren: (P1:F, P2:F1, ..., P_{n+1}:Fn)\\nArguments: (G, (ids (ida (idr)?)?)?)\\n----------------------------------------\\nConclusion: G\\nwhere Rewriter{idr}(F*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1)) == Rewriter{idr}(G*sigma{ids, ida}(Fn)*...*sigma{ids, ida}(F1))\\n\\nMore generally, this rule also holds when:\\n  Rewriter::rewrite(toOriginal(F')) == Rewriter::rewrite(toOriginal(G'))\\nwhere F' and G' are the result of each side of the equation above. Here, original forms are used in a similar manner to MACRO_SR_PRED_INTRO above.\"\n            );\n        case 'REMOVE_TERM_FORMULA_AXIOM':\n            return (\n                rule +\n                '\\n\\n======== Remove Term Formulas Axiom\\nChildren: none\\nArguments: (t)\\n---------------------------------------------------------------\\nConclusion: RemoveTermFormulas::getAxiomFor(t).'\n            );\n        case 'THEORY_LEMMA':\n            return (\n                rule +\n                '\\n\\n======== Theory lemma\\nChildren: none\\nArguments: (F, tid)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is a (T-valid) theory lemma generated by theory with TheoryId tid. This is a \"coarse-grained\" rule that is used as a placeholder if a theory did not provide a proof for a lemma or conflict.'\n            );\n        case 'THEORY_REWRITE':\n            return (\n                rule +\n                \"\\n\\n======== Theory Rewrite\\nChildren: none\\nArguments: (F, tid, rid)\\n----------------------------------------\\nConclusion: F\\nwhere F is an equality of the form (= t t') where t' is obtained by applying the kind of rewriting given by the method identifier rid, which is one of: { RW_REWRITE_THEORY_PRE, RW_REWRITE_THEORY_POST, RW_REWRITE_EQ_EXT } Notice that the checker for this rule does not replay the rewrite to ensure correctness, since theory rewriter methods are not static. For example, the quantifiers rewriter involves constructing new bound variables that are not guaranteed to be consistent on each call.\"\n            );\n        case 'PREPROCESS':\n            return (\n                rule +\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = t' where t was replaced by t' based on some preprocessing pass, or otherwise F was added as a new assertion by some preprocessing pass.\"\n            );\n        case 'PREPROCESS_LEMMA':\n            return (\n                rule +\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F was added as a new assertion by some preprocessing pass.'\n            );\n        case 'THEORY_PREPROCESS':\n            return (\n                rule +\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = Theory::ppRewrite(t) for some theory. Notice this is a \"trusted\" rule.'\n            );\n        case 'THEORY_PREPROCESS_LEMMA':\n            return (\n                rule +\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F was added as a new assertion by theory preprocessing.'\n            );\n        case 'THEORY_EXPAND_DEF':\n            return (\n                rule +\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality of the form t = t' where t was replaced by t' based on theory expand definitions.\"\n            );\n        case 'WITNESS_AXIOM':\n            return (\n                rule +\n                '\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an existential (exists ((x T)) (P x)) used for introducing a witness term (witness ((x T)) (P x)).'\n            );\n        case 'TRUST_REWRITE':\n            return (\n                rule +\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of rewriting that could not be replayed during proof postprocessing.\"\n            );\n        case 'TRUST_SUBS':\n            return (\n                rule +\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of substitution that could not be replayed during proof postprocessing.\"\n            );\n        case 'TRUST_SUBS_MAP':\n            return (\n                rule +\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is an equality (= t t') that holds by a form of substitution that could not be determined by the TrustSubstitutionMap. This inference may contain possibly multiple children corresponding to the formulas used to derive the substitution.\"\n            );\n        case 'TRUST_SUBS_EQ':\n            return (\n                rule +\n                \"\\n\\nArguments: (F)\\n---------------------------------------------------------------\\nConclusion: F\\nwhere F is a solved equality of the form (= x t) derived as the solved form of F', where F' is given as a child.\"\n            );\n        case 'SAT_REFUTATION':\n            return (\n                rule +\n                '\\n\\n========= SAT Refutation for assumption-based unsat cores\\nChildren: (P1, ..., Pn)\\nArguments: none\\n---------------------\\nConclusion: false\\nNote: P1, ..., Pn correspond to the unsat core determined by the SAT solver.'\n            );\n        case 'RESOLUTION':\n            return (\n                rule +\n                \"\\n\\n======== Resolution\\nChildren:\\n(P1:C1, P2:C2)\\nArguments: (pol, L)\\n---------------------\\nConclusion: C\\nwhere\\n- C1 and C2 are nodes viewed as clauses, i.e., either an OR node with each children viewed as a literal or a node viewed as a literal. Note that an OR node could also be a literal.\\n- pol is either true or false, representing the polarity of the pivot on the first clause\\n- L is the pivot of the resolution, which occurs as is (resp. under a NOT) in C1 and negatively (as is) in C2 if pol = true (pol = false).\\nC is a clause resulting from collecting all the literals in C1, minus the first occurrence of the pivot or its negation, and C2, minus the first occurrence of the pivot or its negation, according to the policy above. If the resulting clause has a single literal, that literal itself is the result; if it has no literals, then the result is false; otherwise it's an OR node of the resulting literals.\\n\\nNote that it may be the case that the pivot does not occur in the clauses. In this case the rule is not unsound, but it does not correspond to resolution but rather to a weakening of the clause that did not have a literal eliminated.\"\n            );\n        case 'CHAIN_RESOLUTION':\n            return (\n                rule +\n                \"\\n\\n======== N-ary Resolution\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined above\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined above\\n- let C_1' = C_1 (from P1),\\n- for each i > 1, let C_i' = C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C = C_n'\"\n            );\n        case 'FACTORING':\n            return (\n                rule +\n                '\\n\\n======== Factoring\\nChildren: (P:C1)\\nArguments: ()\\n---------------------\\nConclusion: C2\\nwhere Set representations of C1 and C2 is the same and the number of literals in C2 is smaller than that of C1'\n            );\n        case 'REORDERING':\n            return (\n                rule +\n                '\\n\\n======== Reordering\\nChildren: (P:C1)\\nArguments: (C2)\\n---------------------\\nConclusion: C2\\nwhere Set representations of C1 and C2 are the same and the number of literals in C2 is the same of that of C1'\n            );\n        case 'MACRO_RESOLUTION':\n            return (\n                rule +\n                \"\\n\\n======== N-ary Resolution + Factoring + Reordering\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (C, pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined in RESOLUTION\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined in RESOLUTION\\n- let C_1' be equal, in its set representation, to C_1 (from P1),\\n- for each i > 1, let C_i' be equal, it its set representation, to C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C, which is equal, in its set representation, to C_n'\"\n            );\n        case 'MACRO_RESOLUTION_TRUST':\n            return (\n                rule +\n                \"\\n\\nAs MACRO_RESOLUTION but not checked\\n\\nMACRO_RESOLUTION definition:\\n======== N-ary Resolution + Factoring + Reordering\\nChildren: (P1:C_1, ..., Pm:C_n)\\nArguments: (C, pol_1, L_1, ..., pol_{n-1}, L_{n-1})\\n---------------------\\nConclusion: C\\nwhere\\n- let C_1 ... C_n be nodes viewed as clauses, as defined in RESOLUTION\\n- let \\\"C_1 <>_{L,pol} C_2\\\" represent the resolution of C_1 with C_2 with pivot L and polarity pol, as defined in RESOLUTION\\n- let C_1' be equal, in its set representation, to C_1 (from P1),\\n- for each i > 1, let C_i' be equal, it its set representation, to C_{i-1} <>_{L_{i-1}, pol_{i-1}} C_i'\\nThe result of the chain resolution is C, which is equal, in its set representation, to C_n'\"\n            );\n        default:\n            return rule;\n    }\n}\n\nconst createTree = (list: any): any => {\n    const map: any = {},\n        roots: any = [];\n    let node, i;\n\n    for (i = 0; i < list.length; i += 1) {\n        map[list[i].id] = i;\n        list[i].childNodes = [];\n    }\n\n    for (i = 0; i < list.length; i += 1) {\n        node = list[i];\n        if (node.parentId !== NaN && list[map[node.parentId]]) {\n            list[map[node.parentId]].childNodes.push(node);\n        } else {\n            roots.push(node);\n        }\n    }\n    return roots;\n};\n\nconst indent = (s: string) => {\n    let newS = s.replaceAll(' ', '\\n');\n    let i = 0;\n    let pCounter = 0;\n    while (i < newS.length) {\n        if (newS[i] === '(' || newS[i] === '[') pCounter++;\n        else if (newS[i] === ')' || newS[i] === ']') pCounter--;\n        else if (newS[i] === '\\n') {\n            if (newS[i + 1] === ')' || newS[i + 1] === ']') {\n                newS = [newS.slice(0, i + 1), '  '.repeat(pCounter - 1), newS.slice(i + 1)].join('');\n                i += pCounter - 1;\n            } else {\n                newS = [newS.slice(0, i + 1), '  '.repeat(pCounter), newS.slice(i + 1)].join('');\n                i += pCounter;\n            }\n        }\n        i++;\n    }\n    return newS;\n};\n\nconst VisualizerStage: React.FC<{ canvasRef: React.RefObject<Canvas> }> = ({\n    canvasRef,\n}: {\n    canvasRef: React.RefObject<Canvas>;\n}) => {\n    const dot = useSelector<stateInterface, string | undefined>((state) => state.proofReducer.proof.dot);\n    const view = useSelector<stateInterface, string | undefined>((state) => state.proofReducer.proof.view);\n    const style = useSelector<stateInterface, string | undefined>((state) => state.styleReducer.style);\n    const darkTheme = useSelector<stateInterface, boolean>((state: stateInterface) => state.darkThemeReducer.darkTheme);\n    const importedData = useSelector<stateInterface, stateInterface['importedDataReducer']['importedData']>(\n        (state: stateInterface) => state.importedDataReducer.importedData,\n    );\n    const [proof, letMap] = processDot(dot ? dot : '');\n    const proofTree = createTree(\n        Array.from(Array(proof.length).keys()).map((nodeId) => {\n            return {\n                id: nodeId,\n                icon: 'graph',\n                parentId: proof[nodeId].parent,\n                label: proof[nodeId].rule + ' => ' + proof[nodeId].conclusion,\n                descendants: proof[nodeId].descendants,\n                childNodes: [],\n                rule: proof[nodeId].rule,\n                conclusion: proof[nodeId].conclusion,\n                args: proof[nodeId].args,\n            };\n        }),\n    );\n    const [drawerIsOpen, setDrawerIsOpen] = useState(false);\n    const [ruleHelperOpen, setRuleHelperOpen] = useState(false);\n    const [argsTranslatorOpen, setArgsTranslatorOpen] = useState(false);\n    const [conclusionTranslatorOpen, setConclusionTranslatorOpen] = useState(false);\n    const [nodeInfo, setNodeInfo] = useState<{\n        rule: string;\n        args: string;\n        conclusion: string;\n        nHided: number;\n        nDescendants: number;\n        topHidedNodes?: Array<[number, string, string, number, number]>;\n    }>({\n        rule: '',\n        args: '',\n        conclusion: '',\n        nHided: 0,\n        nDescendants: 0,\n        topHidedNodes: undefined,\n    });\n    const [nodeInfoCopy, setNodeInfoCopy] = useState<{\n        rule: string;\n        args: string;\n        conclusion: string;\n        nHided: number;\n        nDescendants: number;\n        topHidedNodes?: Array<[number, string, string, number, number]>;\n    }>({\n        rule: '',\n        args: '',\n        conclusion: '',\n        nHided: 0,\n        nDescendants: 0,\n        topHidedNodes: undefined,\n    });\n    const [tree, setTree] = useState<TreeNodeInfo[]>([]);\n    const translate = (s: string) => {\n        let newS = s;\n        let i = newS.indexOf('let');\n        while (i !== -1) {\n            const l = newS.slice(i).split(/[ |)|,]/)[0];\n            newS = newS.replace(l, letMap[l]);\n            i = newS.indexOf('let');\n        }\n        return newS;\n    };\n\n    const openDrawer = (\n        nodeInfo: {\n            rule: string;\n            args: string;\n            conclusion: string;\n            nHided: number;\n            nDescendants: number;\n            topHidedNodes?: Array<[number, string, string, number, number]>;\n        },\n        tree?: TreeNodeInfo[],\n    ) => {\n        setRuleHelperOpen(false);\n        setNodeInfo(nodeInfo);\n        setTree(tree ? tree : []);\n        setNodeInfoCopy(nodeInfo);\n        setDrawerIsOpen(true);\n    };\n\n    const nodeInfoTable = () => {\n        return (\n            <table\n                id=\"table-node-info\"\n                className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\n                style={{ width: '100%' }}\n            >\n                <thead>\n                    <tr>\n                        <th>Property</th>\n                        <th>Value</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr>\n                        <td>\n                            <strong>RULE </strong>{' '}\n                            <Icon\n                                id=\"rule-icon\"\n                                icon=\"help\"\n                                onClick={() => {\n                                    setArgsTranslatorOpen(false);\n                                    setConclusionTranslatorOpen(false);\n                                    setRuleHelperOpen(!ruleHelperOpen);\n                                }}\n                            ></Icon>\n                        </td>\n                        <td>\n                            {nodeInfo.rule}\n                            <Collapse isOpen={ruleHelperOpen}>\n                                <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\n                                    {ruleHelper(nodeInfo.rule)}\n                                </Pre>\n                            </Collapse>\n                        </td>\n                    </tr>\n                    {nodeInfo.args ? (\n                        <tr>\n                            <td>\n                                <strong>ARGS</strong>{' '}\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\n                                    <Icon\n                                        id=\"rule-icon\"\n                                        icon=\"translate\"\n                                        onClick={() => {\n                                            setConclusionTranslatorOpen(false);\n                                            setRuleHelperOpen(false);\n                                            setArgsTranslatorOpen(!argsTranslatorOpen);\n                                        }}\n                                    ></Icon>\n                                ) : null}\n                            </td>\n                            <td style={{ maxHeight: '300px', overflow: 'auto' }}>\n                                {nodeInfo.args}\n                                {nodeInfo.args.indexOf('let') !== -1 ? (\n                                    <Collapse isOpen={argsTranslatorOpen}>\n                                        <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\n                                            {indent(translate(nodeInfo.args))}\n                                        </Pre>\n                                    </Collapse>\n                                ) : null}\n                            </td>\n                        </tr>\n                    ) : null}\n                    <tr>\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\n                            <strong>CONCLUSION</strong>{' '}\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\n                                <Icon\n                                    id=\"rule-icon\"\n                                    icon=\"translate\"\n                                    onClick={() => {\n                                        setArgsTranslatorOpen(false);\n                                        setRuleHelperOpen(false);\n                                        setConclusionTranslatorOpen(!conclusionTranslatorOpen);\n                                    }}\n                                ></Icon>\n                            ) : null}\n                        </td>\n                        <td style={{ maxHeight: '300px', overflow: 'auto' }}>\n                            {nodeInfo.conclusion}\n                            {nodeInfo.conclusion.indexOf('let') !== -1 ? (\n                                <Collapse isOpen={conclusionTranslatorOpen}>\n                                    <Pre style={{ maxHeight: '300px', overflow: 'auto' }} id=\"pre-rule\">\n                                        {indent(translate(nodeInfo.conclusion))}\n                                    </Pre>\n                                </Collapse>\n                            ) : null}\n                        </td>\n                    </tr>\n                    {!nodeInfo.topHidedNodes ? (\n                        <tr>\n                            <td>\n                                <strong>#DESCENDANTS</strong>\n                            </td>\n                            <td>{nodeInfo.nDescendants}</td>\n                        </tr>\n                    ) : (\n                        <tr>\n                            <td>\n                                <strong>#DESCENDANTS</strong>\n                            </td>\n                            <td>[{nodeInfo.topHidedNodes.map((node) => node[3]).join(', ')}]</td>\n                        </tr>\n                    )}\n                    {nodeInfo.nHided ? (\n                        <tr>\n                            <td>\n                                <strong>#HIDDEN</strong>\n                            </td>\n                            <td>\n                                [\n                                {nodeInfo.topHidedNodes ? nodeInfo.topHidedNodes.map((node) => node[4]).join(', ') : ''}\n                                ]\n                            </td>\n                        </tr>\n                    ) : null}\n                </tbody>\n            </table>\n        );\n    };\n\n    return (\n        <div>\n            {proof.length > 1 ? (\n                style === 'tree' ? (\n                    <Canvas\n                        ref={canvasRef}\n                        key={dot}\n                        view={view}\n                        proofNodes={proof}\n                        openDrawer={openDrawer}\n                        importedData={importedData}\n                    ></Canvas>\n                ) : (\n                    <VisualizerDirectoryStyle\n                        proofTree={proofTree}\n                        ruleHelper={ruleHelper}\n                        indent={indent}\n                        translate={translate}\n                    />\n                )\n            ) : null}\n            <Drawer\n                className={darkTheme ? 'bp3-dark' : ''}\n                autoFocus={true}\n                canEscapeKeyClose={true}\n                canOutsideClickClose={true}\n                enforceFocus={true}\n                hasBackdrop={false}\n                isOpen={drawerIsOpen}\n                position={Position.BOTTOM}\n                usePortal={true}\n                onClose={(e) => {\n                    e.preventDefault();\n                    setDrawerIsOpen(false);\n                    setArgsTranslatorOpen(false);\n                    setConclusionTranslatorOpen(false);\n                }}\n                icon=\"info-sign\"\n                title=\"Node info\"\n            >\n                <div className={Classes.DRAWER_BODY}>\n                    <VisualizerTree\n                        darkTheme={darkTheme}\n                        content={tree}\n                        setNodeInfo={setNodeInfo}\n                        originalNodeInfo={nodeInfoCopy}\n                    ></VisualizerTree>\n                    <div className={Classes.DIALOG_BODY}>{nodeInfoTable()}</div>\n                </div>\n            </Drawer>\n        </div>\n    );\n};\n\nexport default VisualizerStage;\n","import React, { useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { Dispatch, SetStateAction } from 'react';\nimport { Button, Drawer, Classes, Position } from '@blueprintjs/core';\n\nimport { stateInterface } from './interfaces';\n\ninterface letDrawerProps {\n    drawerIsOpen: boolean;\n    setDrawerIsOpen: Dispatch<SetStateAction<boolean>>;\n}\n\nconst indent = (s: string) => {\n    let newS = s;\n    let i = 0;\n    while (i < newS.length) {\n        if (newS[i] === ' ') {\n            let nSpaces = 1;\n            let j = i + 1;\n            while (newS[j] !== ')' && newS[j] != '(') {\n                if (newS[j] === ' ') {\n                    newS = [newS.slice(0, j), '\\n', newS.slice(j + 1)].join('');\n                    nSpaces += 1;\n                }\n                j += 1;\n            }\n            if (nSpaces > 1) {\n                newS = [newS.slice(0, i), '\\n', newS.slice(i + 1)].join('');\n                i = j + 1;\n            }\n        }\n        i += 1;\n    }\n    i = 0;\n    let pCounter = 0;\n    while (i < newS.length) {\n        if (newS[i] === '(') pCounter++;\n        else if (newS[i] === ')') pCounter--;\n        else if (newS[i] === '\\n') {\n            if (newS[i + 1] === ')') {\n                newS = [newS.slice(0, i + 1), '    '.repeat(pCounter - 1), newS.slice(i + 1)].join('');\n                i += pCounter - 1;\n            } else {\n                newS = [newS.slice(0, i + 1), '    '.repeat(pCounter), newS.slice(i + 1)].join('');\n                i += pCounter;\n            }\n        }\n        i++;\n    }\n    return newS;\n};\n\nconst VisualizerLetDrawer: React.FC<letDrawerProps> = ({ drawerIsOpen, setDrawerIsOpen }: letDrawerProps) => {\n    const darkTheme = useSelector<stateInterface, boolean>((state: stateInterface) => state.darkThemeReducer.darkTheme);\n    const letMap = useSelector<\n        stateInterface,\n        {\n            [Key: string]: string;\n        }\n    >((state: stateInterface) => state.letMapReducer.letMap);\n    const [letMapS, setLetMapS] = useState(letMap);\n\n    return (\n        <Drawer\n            className={darkTheme ? 'bp3-dark' : ''}\n            style={{ maxHeight: '65%', width: '35%' }}\n            autoFocus={true}\n            canEscapeKeyClose={true}\n            canOutsideClickClose={false}\n            enforceFocus={true}\n            hasBackdrop={false}\n            isOpen={drawerIsOpen}\n            position={Position.RIGHT}\n            usePortal={false}\n            onClose={(e) => {\n                e.preventDefault();\n                setDrawerIsOpen(false);\n            }}\n            icon=\"translate\"\n            title=\"Let Map\"\n        >\n            <div className={Classes.DRAWER_BODY}>\n                <div className={Classes.DIALOG_BODY}>\n                    <table\n                        id=\"table-node-info\"\n                        className=\"bp3-html-table bp3-html-table-bordered bp3-html-table-condensed bp3-html-table-striped\"\n                        style={{ width: '100%' }}\n                    >\n                        <thead>\n                            <tr>\n                                <th style={{ width: '100px' }}>Property</th>\n                                <th>Value</th>\n                                <th style={{ width: '250px' }}>Action</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            {Object.keys(letMapS).map(function (key) {\n                                return (\n                                    <tr key={key}>\n                                        <td>\n                                            <strong>{key}</strong>\n                                        </td>\n                                        <td style={{ width: '100%', whiteSpace: 'pre-wrap' }}>\n                                            {indent(letMapS[key])\n                                                .split('\\n')\n                                                .map((e) => {\n                                                    if (e.indexOf(' let') === -1) {\n                                                        return <span>{e + '\\n'}</span>;\n                                                    } else {\n                                                        return (\n                                                            <span\n                                                                onClick={() => {\n                                                                    const newLetMap = { ...letMapS };\n                                                                    const i = newLetMap[key].indexOf(\n                                                                        e.replace(/^\\s+|\\s+$/g, ''),\n                                                                    );\n                                                                    const l = newLetMap[key].slice(i).split(/[ |)]/)[0];\n                                                                    newLetMap[key] = newLetMap[key].replace(\n                                                                        l,\n                                                                        letMap[l],\n                                                                    );\n                                                                    setLetMapS(newLetMap);\n                                                                }}\n                                                            >\n                                                                {e + '\\n'}\n                                                            </span>\n                                                        );\n                                                    }\n                                                })}\n                                        </td>\n                                        <td style={{ width: '150px', display: 'flex', flexDirection: 'column' }}>\n                                            <Button\n                                                onClick={() => {\n                                                    const newLetMap = { ...letMapS };\n                                                    let i = newLetMap[key].indexOf('let');\n                                                    while (i !== -1) {\n                                                        const l = newLetMap[key].slice(i).split(/[ |)]/)[0];\n                                                        newLetMap[key] = newLetMap[key].replace(l, letMap[l]);\n                                                        i = newLetMap[key].indexOf('let');\n                                                    }\n                                                    setLetMapS(newLetMap);\n                                                }}\n                                                className=\"bp3-minimal\"\n                                                icon=\"translate\"\n                                                text=\"Expand\"\n                                            />\n                                            <Button\n                                                onClick={() => {\n                                                    const newLetMap = { ...letMapS };\n                                                    newLetMap[key] = letMap[key];\n                                                    setLetMapS(newLetMap);\n                                                }}\n                                                className=\"bp3-minimal\"\n                                                icon=\"undo\"\n                                                text=\"Revert\"\n                                            />\n                                        </td>\n                                    </tr>\n                                );\n                            })}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </Drawer>\n    );\n};\n\nexport default VisualizerLetDrawer;\n","import React, { useEffect, useState, useRef } from 'react';\nimport Canvas from './components/canvas/VisualizerCanvas';\nimport { useSelector } from 'react-redux';\n\nimport { Intent, Position, Toaster } from '@blueprintjs/core';\n\nimport VisualizerNavbar from './components/VisualizerNavbar';\nimport VisualizerDialog from './components/VisualizerDialog';\nimport VisualizerStage from './components/VisualizerStage';\nimport VisualizerLetDrawer from './components/VisualizerLetDrawer';\n\nimport { stateInterface } from './components/interfaces';\n\nconst App: React.FC = () => {\n    const [dialogIsOpen, setDialogIsOpen] = useState(true);\n    const [dialogContent, setDialogContent] = useState('welcome');\n\n    const [drawerIsOpen, setDrawerIsOpen] = useState(false);\n\n    const darkTheme = useSelector<stateInterface, boolean>((state: stateInterface) => state.darkThemeReducer.darkTheme);\n\n    const canvasRef = useRef<Canvas>(null);\n    const downloadProof = (dot: string, proofName: string) => {\n        canvasRef.current ? canvasRef.current.downloadProof(dot, proofName) : null;\n    };\n    // Toaster\n    let toaster: Toaster;\n    const refHandlers = {\n        toaster: (ref: Toaster) => (toaster = ref),\n    };\n\n    const addErrorToast = (err: string) => {\n        toaster.show({ icon: 'warning-sign', intent: Intent.DANGER, message: err });\n    };\n\n    useEffect(() => {\n        document.getElementsByClassName('bp3-overlay')[0]\n            ? (document.getElementsByClassName('bp3-overlay')[0].className = '')\n            : null;\n    }, [drawerIsOpen]);\n\n    const runCommands = (command: string) => {\n        canvasRef.current ? canvasRef.current.runCommands(command) : null;\n    };\n\n    return (\n        <div className={darkTheme ? ' bp3-dark' : ''}>\n            <Toaster position={Position.TOP} ref={refHandlers.toaster} />\n            <VisualizerNavbar\n                setDialogIsOpen={setDialogIsOpen}\n                setDialogContent={setDialogContent}\n                setDrawerIsOpen={setDrawerIsOpen}\n                downloadProof={downloadProof}\n                runCommands={runCommands}\n                canvasRef={canvasRef}\n            ></VisualizerNavbar>\n            <VisualizerDialog\n                dialogIsOpen={dialogIsOpen}\n                setDialogIsOpen={setDialogIsOpen}\n                dialogContent={dialogContent}\n                setDialogContent={setDialogContent}\n                addErrorToast={addErrorToast}\n            ></VisualizerDialog>\n            <VisualizerStage canvasRef={canvasRef}></VisualizerStage>\n            {drawerIsOpen ? (\n                <VisualizerLetDrawer drawerIsOpen={drawerIsOpen} setDrawerIsOpen={setDrawerIsOpen} />\n            ) : null}\n        </div>\n    );\n};\n\nexport default App;\n","import { combineReducers } from 'redux';\n\nimport { proof, stateInterface } from '../components/interfaces';\n\nconst initialStateProofReducer = {\n    proof: {\n        label: '',\n        options: '',\n        problem: '',\n        dot: '',\n        view: 'basic',\n    },\n};\n\nconst initialStateDarkThemeReducer = {\n    darkTheme: true,\n};\n\nconst initialStateStyleReducer = {\n    style: 'tree',\n};\n\nconst initialStateLetMapReducer = {\n    letMap: {},\n};\n\nconst initialStateImportedDataReducer = {\n    importedData: {\n        nodes: [],\n    },\n};\n\ntype Action =\n    | { type: 'SET_PROOF'; payload: proof }\n    | { type: 'TOGGLE_DARK_THEME' }\n    | { type: 'SET_DOT'; payload: proof['dot'] }\n    | { type: 'BASIC_VIEW' }\n    | { type: 'PROPOSITIONAL_VIEW' }\n    | { type: 'FULL_VIEW' }\n    | { type: 'IMPORTED_DATA_VIEW' }\n    | { type: 'SET_STYLE'; payload: string }\n    | {\n          type: 'SET_LET_MAP';\n          payload: {\n              [Key: string]: string;\n          };\n      }\n    | {\n          type: 'SET_IMPORTED_DATA';\n          payload: {\n              nodes: Array<{ id: number; color: string; x: number; y: number; hidden: Array<number> }>;\n              hidden: Array<Array<number>>;\n          };\n      };\n\nconst proofReducer = (\n    state: stateInterface['proofReducer'] = initialStateProofReducer,\n    action: Action,\n): stateInterface['proofReducer'] => {\n    switch (action.type) {\n        case 'SET_PROOF':\n            return {\n                ...state,\n                proof: {\n                    label: action.payload.label,\n                    options: action.payload.options,\n                    problem: action.payload.problem,\n                    dot: action.payload.dot,\n                    view: 'basic',\n                },\n            };\n        case 'SET_DOT':\n            return {\n                ...state,\n                proof: {\n                    ...state.proof,\n                    dot: action.payload,\n                },\n            };\n        case 'BASIC_VIEW':\n            return {\n                ...state,\n                proof: {\n                    ...state.proof,\n                    view: 'basic',\n                },\n            };\n        case 'PROPOSITIONAL_VIEW':\n            return {\n                ...state,\n                proof: {\n                    ...state.proof,\n                    view: 'propositional',\n                },\n            };\n        case 'FULL_VIEW':\n            return {\n                ...state,\n                proof: {\n                    ...state.proof,\n                    view: 'full',\n                },\n            };\n        case 'IMPORTED_DATA_VIEW':\n            return {\n                ...state,\n                proof: {\n                    ...state.proof,\n                    view: 'imported_data',\n                },\n            };\n        default:\n            return state;\n    }\n};\n\nconst darkThemeReducer = (\n    state: stateInterface['darkThemeReducer'] = initialStateDarkThemeReducer,\n    action: Action,\n): stateInterface['darkThemeReducer'] => {\n    switch (action.type) {\n        case 'TOGGLE_DARK_THEME':\n            return {\n                ...state,\n                darkTheme: !state.darkTheme,\n            };\n        default:\n            return state;\n    }\n};\n\nconst styleReducer = (\n    state: stateInterface['styleReducer'] = initialStateStyleReducer,\n    action: Action,\n): stateInterface['styleReducer'] => {\n    switch (action.type) {\n        case 'SET_STYLE':\n            return {\n                ...state,\n                style: action.payload,\n            };\n        default:\n            return state;\n    }\n};\n\nconst letMapReducer = (\n    state: stateInterface['letMapReducer'] = initialStateLetMapReducer,\n    action: Action,\n): stateInterface['letMapReducer'] => {\n    switch (action.type) {\n        case 'SET_LET_MAP':\n            return {\n                ...state,\n                letMap: action.payload,\n            };\n        default:\n            return state;\n    }\n};\n\nconst importedDataReducer = (\n    state: {\n        importedData: {\n            nodes: Array<{ id: number; color: string; x: number; y: number; hidden: Array<number> }>;\n        };\n    } = initialStateImportedDataReducer,\n    action: Action,\n): stateInterface['importedDataReducer'] => {\n    switch (action.type) {\n        case 'SET_IMPORTED_DATA':\n            return {\n                ...state,\n                importedData: action.payload,\n            };\n        default:\n            return state;\n    }\n};\n\nexport default combineReducers({ proofReducer, darkThemeReducer, styleReducer, letMapReducer, importedDataReducer });\n","import { createStore } from 'redux';\nimport reducer from './reducer';\n\nexport const store = createStore(reducer);\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler): void => {\n    if (onPerfEntry && onPerfEntry instanceof Function) {\n        import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n            getCLS(onPerfEntry);\n            getFID(onPerfEntry);\n            getFCP(onPerfEntry);\n            getLCP(onPerfEntry);\n            getTTFB(onPerfEntry);\n        });\n    }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport App from './App';\nimport { store } from './redux/store';\n\nimport './scss/index.scss';\n\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n    <React.StrictMode>\n        <Provider store={store}>\n            <App />\n        </Provider>\n    </React.StrictMode>,\n    document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}